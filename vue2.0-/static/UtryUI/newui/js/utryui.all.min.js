!function(t){t&&console&&console.warn("The namespace of variable 'utry' is occupied.\n\n"),t=window.utry=function(){var e,i,s=this;return s instanceof t||(s={}),"function"==typeof t.init&&(i=t.init.apply(s,arguments)),s instanceof t&&/\b(string|number|boolean)\b/.test(typeof i)&&(e=window[(e=RegExp.$1).charAt(0).toUpperCase()+e.substring(1)],i=new e(i)),i}}(window.utry);var utry;!function(t){function e(){}function i(t,e,i){"COMPONENT"==i?j[t]=e:i?(B[i]||(B[i]={}),B[i][t]=e):B[H][t]=e}function s(t,e){return"COMPONENT"==e?j[t]:e?(B[e]||(B[e]={}),B[e][t]):j[t]||B[H][t]}function n(t){return j[t]||null}function o(t,e){var i,n=s(t,e);return"COMPONENT"==e?(i=j)[t]=null:e?(B[e]||(B[e]={}),(i=B[e])[t]=null):(i=B[H])[t]=null,delete i[t],n}function r(t,e){var i=K.argsToArray(arguments,2);return function(){return t.apply(e||this,i.concat(K.argsToArray(arguments)))}}function a(t,e){if(v(t)&&v(e)){var i,s,n,o=function(){this.constructor=t,this._super=this["super"]=e.prototype,this.superClass=e};for(o.prototype=e.prototype,i=new o,s=K.keys(t.prototype);n=s.pop();)i[n]=t.prototype[n];t.prototype=i}return t}function l(e,i){t.DEBUG&&"object"==typeof console&&v(console[i=i||"log"])&&console[i](e)}function d(t){return t===!0||t===!1||"[object Boolean]"===z.call(t)}function h(t){return!isNaN(t)&&"[object Number]"===z.call(t)}function u(t){return h(t)&&isFinite(t)}function c(t){return h(t)&&/^[\+\-]?\d+$/.test(t)}function p(t){return void 0===t}function f(t){return"string"==typeof t||"[object String]"===z.call(t)}function m(t){return Array.isArray?Array.isArray(t):"[object Array]"===z.call(t)}function g(t){return t&&"[object Object]"===z.call(t)}function v(t){return"[object Function]"===z.call(t)||"function"==typeof t}function y(t){return"[object Date]"===z.call(t)}function b(t){return"[object RegExp]"===z.call(t)}function x(t){return null===t||/\bstring|number|boolean|undefined\b/.test(typeof t)}function w(t){return t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName}function C(t){try{return!!t&&t.window==t}catch(e){return!!t&&t.self==t&&("function"==(t=typeof t.postMessage)||"object"===t)}}function _(t){return t&&"object"==typeof t&&9===t.nodeType}function k(t){return t&&"object"==typeof t&&3===t.nodeType&&"#text"===t.nodeName}function S(t){return void 0==t||""===t}function T(t,e){return O(t,e)}function E(t){return K.keyboard.is("enter",t)}function L(t){return K.keyboard.is("up",t)}function I(t){return K.keyboard.is("down",t)}function M(t){return K.keyboard.is("delete",t)}function N(t){return K.keyboard.isNumber(t)}function R(t){return K.keyboard.isLetter(t)}function D(t,e){function i(i){i.apply(null,(n===e.message?[]:[function(){o&&(F(t,n,Array.prototype.slice.call(arguments),null,o===!0||o-1),o!==!0&&o--)}]).concat(e.args))}try{e=JSON.parse(e)}catch(s){return}if(g(e)&&e.flag==V+e.token){var n=e.token,o=e.preserveToken,r=U[e.message]||U[n];(m(r)||v(r))&&(/\d+/.test(e.message)&&(n=e.message,o||delete U[n]),m(r)?K.each(r,i):i(r),r=null)}}function F(t,e,i,s,n){if(t&&e)if(v(i)&&(s=i,n=s,i=[]),m(i)||(i=[i]),n!==!0&&(n=isNaN(n=parseInt(n,10))?1:Math.max(0,n)),C(t)){var o=Math.floor(1e11*Math.random()),r=JSON.stringify({preserveToken:n,flag:V+o,message:e,token:o,args:i});s&&(U[o]=s,s=null),t==window?D(t,r):t.postMessage(r,"*")}else f(t=K.trim(t))&&($(t).length?F(window,e,i,s,n):F(window.top,"getMessagePath",[t],function(t){t&&t.length?1===t.length&&"top"===t[0]?F(window.top,e,i,s,n):F(window.top,"delegatePostMessage",[t,{message:e,args:i,preserveToken:n}],s,n):s&&s(),s=i=null}))}function P(t,e){if(f(t=K.trim(t))&&!/^\s*\d*\s*$/.test(t)&&v(e)){var i=U[t]||[];K.some(i,function(t){return t===e})||i.push(e),U[t]=i}}var z=Object.prototype.toString,A=Array.prototype.slice,H=+new Date,B={};B[H]={},B.EVENTS={};var j={},O=function(t,e,i,s,n){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;var o=z.call(t);if(o!==z.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var r="[object Array]"===o;if(!r){if("object"!=typeof t||"object"!=typeof e)return!1;var a=t.constructor,l=e.constructor;if(a!==l&&!("function"==typeof a&&a instanceof a&&"function"==typeof l&&l instanceof l)&&"constructor"in t&&"constructor"in e)return!1}i=i||[],s=s||[],n=n||{};for(var d=i.length;d--;)if(i[d]===t)return s[d]===e;if(i.push(t),s.push(e),r){if(!(d=t.length)&&!e.length)return!0;if(d!==e.length)return!1;for(;d--;)if(!O(t[d],e[d],i,s))return!1}else{var h,u=K.keys(t);if(d=u.length,K.keys(e).length!==d)return!1;for(;d--;)if(h=u[d],!e.hasOwnProperty(h)||!O(t[h],e[h],i,s))return!1}return i.pop(),s.pop(),!0};t.voidFunc=e,t.DEBUG=!0,t.put=i,t.get=s,t.getComponent=n,t.remove=o,t.bind=r,t.inherits=a,t.print=l,t.isBoolean=d,t.isNumber=h,t.isNumeric=u,t.isInt=c,t.isUndefined=p,t.isString=f,t.isArray=m,t.isObject=g,t.isFunction=v,t.isDate=y,t.isRegExp=b,t.isBasicType=x,t.isElement=w,t.isWindow=C,t.isDocument=_,t.isTextNode=k,t.isEmpty=S,t.isEqual=T,t.isEnterKey=E,t.isUpKey=L,t.isDownKey=I,t.isDeleteKey=M,t.isNumberKey=N,t.isLetterCharacter=R;var W={};!function(t){for(var e,i,s,n=[["chrome",/Chrom(?:e|ium)\/([0-9.]+)(:?\s|$)/i],["firefox",/Firefox\/([0-9.]+)(?:\s|$)/i],["opera",/Opera\/([0-9.]+)(?:\s|$)/i],["msie",/Trident\/7\.0.*rv:([0-9.]+)\).*Gecko$/i],["msie",/MSIE\s([0-9.]+);.*Trident\/[4-7].0/i],["msie",/MSIE\s(7\.0)/i],["msie",/MSIE\s(6\.0)/i],["safari",/Safari\/([0-9._]+)/i],["edge",/Edge\/([0-9._]+)/i]],o=[],r=0;r<n.length;r++)e=n[r],e=e.concat(e[1].exec(navigator.userAgent)),e[2]&&o.push(e);for((i=o[0])&&(s=i[3].split(/[._]/).slice(0,3));s&&s.length<3;)s.push("0");t.name=i&&i[0],t.version=s&&s.join("."),"msie"==t.name&&(t.version=parseInt(t.version.substring(0,t.version.indexOf("."))))}(W),t.browserVersion=W.version,t.browserName=W.name,t.isIE="msie"==t.browserName,t.isIE8=t.isIE&&8==t.browserVersion,t.isIE9=t.isIE&&9==t.browserVersion,t.isIE10=t.isIE&&10==t.browserVersion,t.isIE11=t.isIE&&11==t.browserVersion,t.isChrome="chrome"==t.browserName,t.isFirefox="firefox"==t.browserName,t.isMozilla=t.isFirefox,t.isOpera="opera"==t.browserName,t.isSafari="safari"==t.browserName;var V="nothingseeknothingfind",U={delegatePostMessage:function(t,e,i){if(m(e)){var s;f(s=K.trim(e.shift()))&&s?(s=$("iframe["+s+"]")).length?F(s[0].contentWindow,"delegatePostMessage",[e,i],t,i.preserveToken):t&&t():i&&F(window,i.message,i.args,t,i.preserveToken)}},getElementById:function(t,e){var i=document.getElementById(e);i&&document.body.removeChild(i),t(!!i)},getGlobalMessagePath:function(t,e,i){var s,n=V,o=window,r=o.parent||o;e=e||[],i?$("iframe:not('.isshadow"+n+"')").each(function(){var s=this;F(s.contentWindow,"getElementById",[i],function(o){var r;o&&i&&(i="",$(s).attr(r=n+Math.floor(1e6*Math.random()),""),e.unshift(r),F(window,"getGlobalMessagePath",[e],t))})}):r!=o&&C(r)?(s=K.uuid(12),$("<i id='"+s+"'/>").appendTo(document.body),F(r,"getGlobalMessagePath",[e,s],t)):t(e)},getMessagePath:function(t,e,i,s,n){if(i=i||[],n=(n||400)-20,$(e).length)i.length||i.push("top"),t(i,!0);else{var o,r,a;s=s||$("iframe:not('.isshadow"+V+"')").get(),s.length?($(o=s.shift()).attr(r=V+Math.floor(1e6*Math.random()),""),i.push(r),F(o.contentWindow,"getMessagePath",[e,i,null,n],a=function(l,d){a=null,d&&"timeout"!==l?($(o).removeClass("h"+V),$(s).addClass("h"+V),t(l,!0)):($(o).removeAttr(r).addClass("h"+V),i.pop(),U.getMessagePath(t,e,i,s,n))}),setTimeout(function(){a&&(a("timeout"),a=null)},n)):t(i,!1)}}};$(window).bind("message",function(t){t=t.originalEvent||t,D(t.source,t.data)}),t.postMessage=F,t.registerMessageListener=P,t.addMessageListener=P;var K;!function(e){function i(t,i){return t=g(t)?t:{},i?e.copy(t):t}function s(t,e,i){return i||m(t)&&m(e)?t.slice(0,e.length).join("")===e.join(""):0===String(t).indexOf(e)}function n(t,e,i){var s=t.length-e.length;return i||m(t)&&m(e)?t.slice(s,t.length).join("")===e.join(""):s>=0&&t.lastIndexOf(e)==s}function o(t,e){if(m(t)){var i,s=!0,n=t.slice();e=v(e)?e:function(t,e){return t>e?1:t<e?-1:0},i=function(t,i){var n=e(t,i);return 0!==n&&(s=!1),n},n.sort(i),s||(t=n)}return t}function r(t,e,i){var s,n,o,r,a,l=[];if(void 0==t||void 0==e)return l;if(m(t)&&m(e)){if(t.length&&e.length)for(e=e.slice(),s=0,o=t.length;s<o;s++)if(a=t[s],i||!F(l,function(t){return t===a||T(t,a)}))for(n=0,r=e.length;n<r;n++)if(a===e[n]||T(a,e[n])){if(i)return!0;l.push(a),e.splice(n,1);break}}else g(t)&&g(e)&&(l={},P(t,function(t,s){if(t===e[s]||T(t,e[s])){if(i)return!0;l[s]=t}}));return!i&&l}function a(t,e,i){if(void 0===i&&(i=0),m(t)){if(t.indexOf)return t.indexOf(e,i);for(var s=t.length;s--;)if(t[s]===e)return s}else if(f(t))return t.indexOf(e+"",i);return-1}function d(t){return f(t)&&(t=t.replace(/^\s*|\s*$/g,"")),t}function h(t){var e=g(t)?t:{};return f(t=d(t))&&t.replace(/(?:^|&|\?)([^\s&=?]+)=([^&]*|)/g,function(t,i,s){e[decodeURIComponent(i)]=decodeURIComponent(s)}),e}function u(t,e){if(g(e)||(e={}),g(t)){var i,s,n=function(){};n.prototype=e,i=new n,n.prototype=null;for(s in t)t.hasOwnProperty(s)||(i[s]=t[s]);for(s in t)t.hasOwnProperty(s)&&(i[s]=t[s]);t=i}return t}function p(t,e){return A.call(t,e)}function y(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return function(){var e,i,s,n,o=t.length;for(t[o-1]===!0&&(e=[],i=!0),n=0;n<o;n++)v(t[n])&&(s=t[n].apply(this,arguments),i?e[n]=s:e=s);return e}}function x(t,e){return b(t)?t:new RegExp(String(t).replace(/[*.?+$^\[\](){}|\\]/g,"\\$&"),e)}function C(e){if(void 0==e)return[];if(!t.isIE9&&!t.isIE10&&v(Object.keys))return Object.keys(e);var i,s={}.hasOwnProperty,n={toString:1},o=[];for(var r in e)s.call(e,r)&&o.push(r);var a=[];for(i in n)a=null;if(a){a="propertyIsEnumerable,isPrototypeOf,hasOwnProperty,toLocaleString,toString,valueOf,constructor".split(",");for(var l=0;r=a[l++];)s.call(e,r)&&o.push(r)}return o}function _(t){var e=[];return void 0==t?e:(m(t)?H(t,function(t){e.push(t)}):H(C(t),function(i){e.push(t[i])}),e)}function k(t,e){var i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=[];if(e=e||s.length,t)for(i=0;i<t;i++)n[i]=s[0|Math.random()*e];else{var o;for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",i=0;i<36;i++)n[i]||(o=0|16*Math.random(),n[i]=s[19==i?3&o|8:o])}return n[0]="youaremydarling".charAt(E(0,14)),n.join("")}function E(t,e){return t=parseInt(t,10)||0,e=parseInt(e,10)||0,Math.round(Math.random()*(t>e?t-e:e-t)+(t>e?e:t))}function L(t,e){if(t=new Date(t),"Invalid Date"==t.toString())return"";f(e)&&e||(e="yyyy-MM-dd");var i={M:t.getMonth()+1,d:t.getDate(),H:t.getHours(),h:t.getHours(),m:t.getMinutes(),s:t.getSeconds(),q:Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};return e=e.replace(/([yMdHhmsqS])+/g,function(e,s){var n=i[s];return void 0!==n?(e.length>1&&(n="0"+n,n=n.substr(n.length-2)),n):"y"===s?(t.getFullYear()+"").substr(4-e.length):e})}function I(t){var e,i=null;return f(t)&&(i=(e=/(\d+)(?:[^\d]+(\d+)(?:[^\d]+(\d+)(?:(?:\s(\d+)[^\d]+(\d+)(?:[^\d]+(\d+)|))(?:\.(\d+)|)|)|)|)/.exec(t))?new Date(e[1],(+e[2]||1)-1,e[3]||1,e[4]||0,e[5]||0,e[6]||0,e[7]||0):new Date(t)),i&&isNaN(i.getTime())?null:i}function M(t){var e=[];return f(t)&&/\s*(?:([0-1][0-9]|[2][0-3]|[0-9])\s*(?::|H|\u65f6))?\s*(?:([0-5][0-9]|[0-9])\s*(?::|M|\u5206))?\s*(?:([0-5][0-9]|[0-9])\s*(?:s|\u79d2|))?\s*/i.test(t)&&RegExp.$1&&(e.push(RegExp.$1),RegExp.$2&&(e.push(RegExp.$2),RegExp.$3&&e.push(RegExp.$3))),L(new Date(2e3,1,1,e[0]||0,e[1]||0,e[2]||0),"HH:mm:ss")}function N(t){return t=t||window.event,t.target||(t.target=t.srcElement),t.preventDefault||(t.preventDefault=function(){t.returnValue=!1}),t.stopPropagation||(t.stopPropagation=function(){t.cancelBubble=!0},t.stopImmediatePropagation=function(){t.cancelBubble=!0}),t}function R(t,e,i,s,n,o,r,a,l){if(s=s||"childNodes",l=l||{},m(t)){t=t.concat();for(var d=0,h=t.length;d<h;d++)if(0===R(t[d],e,i,s,n,o||null,d,t,l))return 0}else if(t){var u=t.___id___||Math.floor(1e10*Math.random());if(l[u])return 1;if(l[u]=1,t.___id___=u,e.call(n,t,o,r,a)===!1)return i?0:1;var c=t[s];if(c&&c.length){c=c.concat();for(var p,h=c.length,d=0;d<h;d++)if((p=c[d])&&0===R(p,e,i,s,n,t,d,c,l))return 0}}}function D(t,e,i){var s=[],n=g;if(n(e)||(e={}),m(t)&&e){for(var o,r,a,d={},h=n(i)?i:{},u=0,c=t.length,p=e.idField||"id",f=e.pidField||"pid",v=e.childField||"childNodes",y=e.parentField||"parentNode",b=void 0!==e.rootPidVal,x=e.rootPidVal;u<c;)if(n(o=t[u++])){if((r=o[p])in h){t[u-1]=h[r];continue}a=o[f],(b?a===x:void 0==a||""===a)?o[y]=null:h[a]?(d[a]=h[a][v]||[]).push(o):(d[a]=d[a]||[]).push(o),o[v]=d[r]=d[r]||[],h[r]=o}else t[u-1]=null;for(u=c;u--;)(o=t[u])?(o[y]=h[o[f]]||null,null===o[y]&&s.unshift(o)):t.splice(u,1);h=null}else l("Arguments error.","error");return s}function F(t,i,s){if(void 0==t)return!1;var n,o,r=m(t)?t:0,a=!r&&g(t)?t:0,l=(r||a)&&v(i)?i:0,d=a&&!l?i:void 0,h=l?void 0:r?i:a?s:void 0;if(r){if(l&&r.some)return r.some(l,s||r);for(r=l?r.slice():r,d=0,o=r.length;d<o;d++)if(l?l.call(s||r,r[d],d,r)===!0:r[d]===h)return!0}else if(a){if(void 0!=d)return a[d]===h;if(l)for(n=e.keys(a);d=n.pop();)if(l.call(s||a,a[d],d,a)===!0)return!0}return!1}function P(t,i,s){if(void 0!=t){if(m(t))return H(t,i,s);if(c(t)){for(var n=0;n<t;)if(i.call(s,void 0,n++)===!1)return}else for(var o,r=e.keys(t);o=r.pop();)if(i.call(s||t,t[o],o,t)===!1)return}}function H(t,e,i){if(m(t)){t=t.slice();for(var s=t.length,n=0;n<s&&e.call(i,t[n],n,t)!==!1;n++);}}function B(t,i,s){var n=[];if(void 0==t)return n;if(m(t))if(t.filter)n=t.filter(i,s||t);else{t=t.slice();for(var o=0,r=t.length;o<r;o++)i.call(s||t,t[o],o,t)&&n.push(t[o])}else for(var a,l=e.keys(t);a=l.shift();)i.call(s||t,t[a],a,t)&&n.push(t[a]);return n}function j(t,i,s){var n=[];if(void 0==t)return n;if(m(t)||t.length)if(t.map)n=t.map(i,s||t);else{t=t.slice?t.slice():t;for(var o=0,r=t.length;o<r;o++)n.push(i.call(s||t,t[o],o,t))}else for(var a,l=e.keys(t);a=l.shift();)n.push(i.call(s||t,t[a],a,t));return n}function O(t,i,s){var n,o,r=v(i);if(g(t))for(n=e.keys(t);o=n.pop();)r?i.call(s||t,t[o],o,t)&&delete t[o]:t[o]===i&&delete t[o];else if(m(t))for(o=0,n=t.length;o<Math.min(t.length,n);o++)r?i.call(s||t,t[o],o,t)&&t.splice(o--,1):t[o]===i&&t.splice(o--,1);return t}function W(t,e){var i,s,n,o,r=1;for("object"==typeof t||v(t)||(t={});i=arguments[r];r++)if(null!=i)for(s in i)n=t[s],o=i[s],t!==o&&(null===o?t[s]=null:g(o)?t[s]=W(g(n)?n:{},o):m(o)?t[s]=(m(n)?n:[]).concat(W([],o)):void 0!==o&&(t[s]=o));return t}function V(t,i){var s,n,o;for(g(t)||(t={}),i=p(arguments,1);i.length;)if(g(s=i.shift()))for(n=e.keys(s);o=n.pop();)void 0===s[o]||(t[o]=s[o]);return t}function U(i,s){if(null===i)return null;switch(typeof i){case"string":case"number":case"boolean":case"undefined":return i}var n=z.call(i);switch(n){case"[object String]":case"[object Number]":case"[object Boolean]":return i.valueOf();case"[object Date]":return new Date((+i));case"[object Function]":return i;case"[object RegExp]":n=i.toString();var o=n.lastIndexOf("/");return new RegExp(n.substring(1,o),n.substring(o+1))}var r,a,l,d;if("[object Array]"===n){if(r=[],(d=(s=s||{}).cMark)||(d=s.cMark=e.uuid(12),s.cLevel=0),s[i[d]])return s["c"+i[d]];for(s[i[d]=Math.floor(1e9*Math.random())]=i,s["c"+i[d]]=r,l=i.length;l--;)a=i[l],s.cLevel++,r[l]=a===i?i:U(a,s),s.cLevel--;if(!s.cLevel){for(l in s)"c"===l.charAt(0)||delete s[l][d];s=null}return r}var h=window.jQuery||window.$;if(h&&i instanceof h||i instanceof t.Component||i instanceof t.Template)return i;if(i===i.window||"object"!=typeof i&&i.nodeType)return i;if(r={},(d=(s=s||{}).cMark)||(d=s.cMark=e.uuid(12),s.cLevel=0),s[i[d]])return s["c"+i[d]];s[i[d]=Math.floor(1e9*Math.random())]=i,s["c"+i[d]]=r;var u,c=e.keys(i);for(l=c.length;l--;)(u=c[l])!==d&&(a=i[u],s.cLevel++,r[u]=a===i?i:U(a,s),s.cLevel--);if(!s.cLevel){for(l in s)"c"===l.charAt(0)||delete s[l][d];s=null}return r}function K(t){if(void 0==t)return"";var e={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"};return String(t).replace(/&(?![\w#]+;)|[<>"']/g,function(t){return e[t]})}function q(t){return f(t)&&(t=t.replace(/^(\S)/,function(){return arguments[1].toUpperCase()})),t}function Y(t){return f(t)&&(t=t.replace(/^(\S)/,function(){return arguments[1].toLowerCase()})),t}function X(t,e){var i,s,n,o,r,a=function(){var l=+new Date-o;l<e&&l>=0?i=setTimeout(a,e-l):(r=t.apply(n,s),i=n=s=null)};return function(){return n=this,s=arguments,o=+new Date,i||(i=setTimeout(a,e)),r}}function G(t,e,i){var s;return function(){var n=arguments,o=i||this;clearTimeout(s),s=setTimeout(function(){t.apply(o,n)},e)}}function Z(t){var e="";return f(t)&&(e=t.replace(/-([a-z])/gi,function(t,e){return e.toUpperCase()})),e}function J(t){var e=[];return g(t)&&P(t,function(t,i){/^(?:width|height|size)$/i.test(i)&&(t=Q(t)),void 0!=t&&""!==t&&e.push(i.replace(/[A-Z]/g,"-$&").toLowerCase()+":"+t)}),e.join(";")}function Q(t,e){var i=/^(-?\d+\.?\d+|-?\d)(px|%|em)?$/i.exec(t);return t=i?"%"===i[2]?void 0==e?i[1]+"%":Math.floor(parseFloat(i[1])*e/100)+"px":"em"===i[2]?i[1]+"em":Math.floor(parseFloat(i[1]))+"px":""}function tt(t,e){var i=/^(-?\d+\.?\d+|-?\d)(px|%|em)?$/i.exec(t);return t=i?"%"===i[2]?void 0==e?i[1]:Math.floor(parseFloat(i[1])*e/100):"em"===i[2]?i[1]:Math.floor(parseFloat(i[1])):""}function et(t){var e=st(t),i=$(window),s=$(document),n=i.height(),o=i.width(),r=s.scrollLeft(),a=s.scrollTop(),l=Math.floor;return{left:l(e.left-r),top:l(e.top-a),right:l(r+o-e.left-e.outerWidth),bottom:l(a+n-e.top-e.outerHeight)}}function it(t,e,i,s,n){if(!(t=$(t)).length||!(e=$(e)).length)return t;t[0].parentNode||t.appendTo(document.body),s=parseInt(s,10)||0,i=i?/^top$/i.test(i)?1:/^bottom$/i.test(i)?2:/^left$/i.test(i)?3:/^left\s+center|center\s+left$/i.test(i)?4:/^right$/i.test(i)?5:/^right\s+center|center\s+right$/i.test(i)?6:0:0,n=!!n&&0===i;var o,r=st(e),a=r.top+r.outerHeight+s,l=t.outerWidth(!0),d=t.outerHeight(!0),h=$(window),u=$(document),c=h.height(),p=h.width(),f=u.scrollLeft(),m=u.scrollTop(),g=r.top-m-s,v=m+c-a,y=g<d&&v<d,b=r.top-d-s,x={left:3==i||4==i?r.left-l-s:5==i||6==i?r.left+r.outerWidth+s:Math.max(f,Math.min(r.left,p-l+f)),top:i>2?3==i||5==i?r.top:.5*(r.outerHeight-d)+r.top:1==i?b:2==i?a:v>d||y&&!n?a:g>v?b:a};return y&&n&&(o=t.height(),x.height=Math.max(Math.max(o-d+(g>v?g:v)-2,Math.min(20,o)),0),x.top+=g>v?o-x.height:0),x.left=Math.ceil(x.left),x.top=Math.ceil(x.top),t.css(x)}function st(t){var e,t=$(t);return t.length?(e=t.offset(),{left:e.left,top:e.top,width:t.width()||0,height:t.height()||0,outerWidth:t.outerWidth()||0,outerHeight:t.outerHeight()||0}):{left:0,top:0,width:0,height:0,outerWidth:0,outerHeight:0}}function nt(t){var i,s;return t instanceof $&&(t=t[0]),t&&t.parentNode&&1==t.nodeType&&11!==t.parentNode.nodeType?t.offsetParent?i=!1:(s=t.id,document.getElementById(t.id=e.uuid(12))||(i=!0),t.id=s):i=!0,!!i}function ot(t,e){var i=!1;return t&&e&&w(e=e instanceof $?e[0]:m(e)?e[0]:e)&&H(t instanceof $?t.get():m(t)?t:[t],function(t){if(w(t))return!(i=$.contains(t,e))}),!!i}function rt(t,e,i,s){if(!t)return 0;if(b(e)||(e=x(e,"i")),i=i||"em",s=s||"ut-highlight",3===t.nodeType){var n,o,r=t.data.match(e);if(r)return(n=document.createElement(i)).className=s,o=t.splitText(r.index),o.splitText(r[0].length),n.appendChild(o.cloneNode(!0)),o.parentNode.replaceChild(n,o),1}else if(1===t.nodeType&&t.childNodes&&!/(?:script|style)/i.test(t.tagName)&&(t.tagName!==i.toUpperCase()||t.className!==s))for(var a=0;a<t.childNodes.length;a++)a+=rt(t.childNodes[a],e,i,s);return 0}function at(t,i){i=i||"end";var s=e.capitalize(i),n={transition:"transition"+i,OTransition:"oTransition"+s,MozTransition:"transition"+i,WebkitTransition:"webkitTransition"+s,MsTransition:"msTransition"+s},o={animation:"animation"+i,OAnimation:"oAnimation"+s,MozAnimation:"animation"+i,WebkitAnimation:"webkitAnimation"+s,MsAnimation:"msAnimation"+s},r=function(t){var e,i=document.createElement("div");for(e in t)if(void 0!==i.style[e])return t[e]};return r("transition"===t?n:o)}function lt(t,e,i){var s=at(i);return!!s&&($(t).bind(s,e),!0)}function dt(t,e,i){var s=at(i,"start");return!!s&&($(t).bind(s,e),!0)}function ht(t,e,i){var s=at(i);return s&&$(t).unbind(s,e),t}function ut(t,e,i){var s=at(i,"start");return s&&$(t).unbind(s,e),t}function ct(){"getSelection"in window?window.getSelection().removeAllRanges():document.selection.empty()}function pt(t){if((t=$(t)).length&&t.attr("contenteditable")){t.on("paste",function(t){t.preventDefault();var e,i,s,n=window.clipboardData,o=(n&&n.setData?n.getData("text"):(t.originalEvent||t).clipboardData.getData("text/plain"))||"",r=document,a=r.body;a.createTextRange?(r.selection?e=r.selection.createRange():window.getSelection&&(i=window.getSelection().getRangeAt(0),i.deleteContents(),(s=r.createElement("span")).innerHTML="&#FEFF;",i.insertNode(s),(e=a.createTextRange()).moveToElementText(s),s.parentNode.removeChild(s)),e.text=o,e.collapse(!1),e.select()):document.execCommand("insertText",!1,o)}).on("keydown",function(t){if(t.ctrlKey||t.metaKey)switch(t.keyCode){case 66:case 98:case 73:case 105:case 85:case 117:t.preventDefault()}});try{document.execCommand("AutoUrlDetect",!1,!1)}catch(e){}}}function ft(t){if(t instanceof $&&(t=t[0]),w(t)){var e,i,s;e=/input|textarea/i.test(t.tagName)?(t.value||"").length:t.innerText.length,t.setSelectionRange?(t.focus(),t.setSelectionRange(e,e)):t.createTextRange?(i=t.createTextRange(),i.collapse(!0),i.moveEnd("character",e),i.moveStart("character",e),i.select()):(t.focus(),(s=document.selection)?(i=s.createRange(),i.moveToElementText(t),i.select(),s.empty()):(i=document.createRange(),i.selectNodeContents(t),i.collapse(!1),s=window.getSelection(),s.removeAllRanges(),s.addRange(i)))}return t}function mt(e,i,s){if(e&&i){e=$(e);var n=t.browserVersion,o=e.val(),r=function(){var t=o;(o=e.val())!==t&&i.call(s,o,t)};return t.isIE&&n<=9&&(n<9?e.bind("propertychange",r):9==n&&e.bind("keyup blur",r)),e.bind("input",r)}}function gt(e,i,s){if(v(e)){var n;n=i,i=e,s=n,e=$(document)}else e=v(i)?$(e):null;e&&e.bind(t.isFirefox?"DOMMouseScroll":"mousewheel",function(e){var n=e.originalEvent||e;return e.delta=n.wheelDelta?t.isOpera&&t.browserVersion<9?-n.wheelDelta:n.wheelDelta:40*-n.detail||((-n.deltaY||0)>0?120:-120),e.offsetX=n.offsetX,e.offsetY=n.offsetY,i.call(s,e)})}function vt(){var t,e,i,s,n;1===arguments.length&&g(e=arguments[0])?(t=U(e),void 0==t.keyCode&&void 0==t.keyName&&(t.keyName="*")):(i=arguments[0],v(e=arguments[1])?(s=e,n=arguments[2],e="*"):(s=arguments[2],n=arguments[3]),t={target:i,listener:s,context:n,keyCode:e,keyName:e}),S(t.keyCode)&&S(t.keyName)||!v(t.listener)||!(i=$(t.target)).length||i.bind(t.eventType||"keydown",function(e){var i,s,n=yt.fromEvent(e),o=n,r=t.keyCode,a=t.keyName;return e.eventKey=e.shiftKey?n.toLowerCase():o,n=e.key=n.replace(/^numpad /i,""),!S(r)&&(m(r)||(t.keyCode=r=[r]),i=yt.getKeyCode(n),F(r,function(t){return t==i}))?t.listener.apply(t.context||this,arguments):!S(a)&&(m(a)||(t.keyName=a=[a]),/^[a-z]$/i.test(n)?(s=!!t.ignoreCase)&&(n=n.toLowerCase()):s=!0,F(a,function(t){var e,i;return t+="",(e=/^\s*(!?)\s*(letter|number)\s*$|^\s*(\*)\s*$/i.exec(t))?!!e[3]||("number"===e[2].toLowerCase()?(i=/^\d$/.test(n),e[1]?!i:i):(i=/^[a-z]$/i.test(n),e[1]?!i:i)):(t=s?t.toLowerCase():t,/^\s*numpad\s.\s*$/i.test(t)&&(n=o),n==t||F(yt.getAlias(n),t))}))?t.listener.apply(t.context||this,arguments):void 0})}e.object=i,e.startsWith=s,e.endsWith=n,e.arraySort=o,e.intersection=r,e.indexOf=a,e.trim=d,e.parseParams=h,e.objectInherits=u,e.argsToArray=p,e.makeRunSequence=y,e.makeRegExp=x,e.keys=C,e.values=_,e.uuid=k,e.randomRange=E,e.dateFormat=L,e.dateParser=I,e.parseTime=M,e.getEventObject=N,e.treeWalker=R,e.listToTree=D,e.some=F,e.forEach=P,e.each=H,e.filter=B,e.map=j,e.remove=O,e.deepExtend=W,e.extend=V,e.copy=U,e.escapeHTML=K,e.capitalize=q,e.uncapitalize=Y,e.debounce=X,e.throttle=G,e.toCamelCase=Z,e.getStyle=J,e.setUnit=Q,e.stripUnits=tt,e.getVisibleWidth=et,e.locate=it,e.getBoundingRect=st,e.isDisconnected=nt,e.contains=ot,e.highlight=rt,e.addAnimationEndListener=lt,e.addAnimationStartListener=dt,e.removeAnimationEndListener=ht,e.removeAnimationStartListener=ut,e.clearSelection=ct,e.preventAppendHTML=pt,e.moveCursorToEnd=ft,e.catchInputChangeEvent=mt,e.catchMouseWheelEvent=gt,e.catchKeyboardEvent=vt;var yt;!function(e){function i(t){var e=[];return t in w&&(e.push(w[t]),P(v,function(i,s){t==i&&e.push(s)})),e}function s(t){var e=g[t];return e?i(e):[]}function n(){var e=["================standard================"],i={};return P(w,function(t,s){e.push(t+"\t=>\t"+s),i[t]=+s}),e.push("================alias================"),P(v,function(t,s){e.push(s+"\t=>\t"+t),i[s]=+t}),e.push("========================================"),t.print(e.join("\r\n")),i}function o(t){var e=0;return S(t=d(t))||(e=g[String(t).toLowerCase()]||0)||P(x,function(i,s){if(t===i)return e=+s,!1}),e}function r(t){var e="";return"keydown"===t.type||"keyup"===t.type?e=l(t.keyCode,t.shiftKey):"keypress"===t.type&&(e=a("number"==typeof t.charCode?t.charCode:t.keyCode)),void 0!=e?e:""}function a(t){return String.fromCharCode(t)}function l(t,e){var i;return t=y[t]||t,e?/^[a-z]$/i.test(i=x[t]||w[t])&&(i=i.toUpperCase()):i=w[t],void 0!=i?i:""}function h(t,e){return/^[a-z]$/i.test(c(t,e))}function u(t,e){return/(?:numpad\s)?\d/.test(c(t,e))}function c(t,e){return t="object"==typeof t?r(t):/\d+/.test(t)?l(t,e)||a(t):"",void 0==t?"":String(t).toLowerCase()}function p(t,e,i){return/^number$/i.test(t)?u(e,i):/^letter$/i.test(t)?h(e,i):(e=c(e,i),b(t)?t.test(e):(t+="",/^[a-z]$/i.test(e)||(t=t.toLowerCase()),e==t||F(s(e),t)))}var f,m,g={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,"play/stop":179,browser:172,mute:173,"volume down":174,"volume up":175,email:180,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},v={cmd:91,command:91,windows:91,computer:182,calculator:183,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,"break":19,caps:20,"return":13,escape:27,spc:32,pgup:33,pgdn:34,ins:45,del:46},y={59:186,61:187,173:189,224:91,44:124},x={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},w={};for(m=97;m<123;m++)g[String.fromCharCode(m)]=m-32;for(m=48;m<58;m++)g[m-48]=m;for(m=1;m<13;m++)g["f"+m]=m+111;for(m=0;m<10;m++)g["numpad "+m]=m+96;for(m in g)w[g[m]]=m;for(f in v)g[f]=v[f];e.getAlias=s,e.printKeyCodeMap=n,e.getKeyCode=o,e.fromEvent=r,e.fromCharCode=a,e.fromKeyCode=l,e.isLetter=h,e.isNumber=u,e.getCharacter=c,e.is=p}(yt=e.keyboard||(e.keyboard={}))}(K=t.utils||(t.utils={}))}(utry||(utry={}));var utry;!function(t){function e(e){e=!!e,t.DEBUG=e,s.DEBUG=e,t.Template&&(t.Template.DEFAULTS.debug=e)}function i(e){return t.isElement((e=$(e))[0])?new s({context:e}).getComponents():[]}var s=function(){function e(e){this.selector="utry-",this.optsName="options",this.options=e=t.utils.extend({},e),this.context=e.context||document.body,this.logger=e.logger,this.init()}return e.prototype.getComponents=function(){return this.components||[]},e.prototype.init=function(){if(this.initLogger(),this.loadComponents(),this.options.isPageApplication){var i=this.getComponents().slice();t.utils.each(e.loadListeners,function(t){t(i)}),e.loadListeners=null}},e.prototype.initLogger=function(){var t=this.logger;t||(this.logger=new n)},e.prototype.loadComponents=function(){var i=this.optsName,s=this.logger,n=this.selector,o=[];$("[class*='"+n+"']",$(this.context)).each(function(r,a){var l=e.getComponentClassName(a,n);l.className?o.push({elem:a,declare:l.declare,className:l.className,options:e.parseOptions(a,i),id:t.utils.uuid(8)}):s.error(new Error('Not found the definition of component by "'+l.declare+'".'))});for(var r,a=o.concat();r=a.pop();)for(var l=a.length-1;l>-1;l--)if($.contains(a[l].elem,r.elem)){r.pid=a[l].id;break}for(var d=t.utils.listToTree(o),h=[];d.length;)h.push(this.renderComponentsTree(d.shift()));this.components=h},e.addLoadListener=function(i,s){var n=e;return t.isFunction(i)&&(null===n.loadListeners?i.call(s):(n.loadListeners=n.loadListeners||[]).push(t.bind(i,s))),n},e.parseOptions=function(i,s){var n,o={},r="",a=$(i);if(a.length)try{s=s||"options",r=t.utils.trim($(i).data(s)||$(i).attr(s)),!/^[a-z$_]\w*/i.test(r)||!t.isObject(n=window[r])||t.isDocument(n)||t.isWindow(n)||t.isElement(n)||n instanceof $||n instanceof t.Component?t.isString(r)&&("{"===r.charAt(0)&&"}"===r.charAt(r.length-1)&&(r=r.substring(1,r.length-1)),r=r?new Function("return {"+r+"}")():{}):r=n,o=t.utils.extend({},r,e.getAttributes(i),{el:i,width:t.utils.setUnit(t.utils.trim(i.style.width||a.attr("width")))||void 0,height:t.utils.setUnit(t.utils.trim(i.style.height||a.attr("height")))||void 0})}catch(l){t.print("Can not parse the options.\n<message>\n"+l.message+"\n\n<source>\n{\n"+r+"\n}\n\n","error")}return o},e.prototype.renderComponentsTree=function(e){var i,s=e.options,n=e.childNodes,o=this.selector+e.declare;if(s.children=n,s["class"]=s["class"].replace(new RegExp("\\s*"+o+"\\s*","g"),""),$(s.el).removeClass(o),i=new t[e.className](s),n.length){n=n.concat();for(var r=n.length,a=0;a<r;a++)n[a]=this.renderComponentsTree(n[a]);i.appendChildComponents(n)}return s.el=null,i},e.getAttributes=function(e){for(var i,s,n,o=e.attributes,r={},a=0;i=o[a];a++)if(i.specified){switch(n=i.value,/^data-(.+)/.test(s=i.name)?r[s=RegExp.$1]=n:r[s]=n,void 0===r[s=t.utils.toCamelCase(s)]&&(r[s]=n),s){case"novalidate":r[s]=!0;break;case"required":r[s]=t.utils.trim(r[s])||s;case"max":case"min":case"maxlength":case"minlength":case"pattern":r["rule"+t.utils.capitalize(s)]=r[s],r[s]=void 0}if(!r.novalidate&&"input"==e.tagName.toLowerCase())switch(s=r.type||e.type){case"button":case"submit":case"reset":r.novalidate=!0;break;case"url":case"email":case"number":case"range":r["rule"+t.utils.capitalize(s)]=!0}}return t.utils.forEach(r,function(n,o){switch(o){case"value":""===n&&(r.value=void 0);break;case"disabled":case"readonly":case"multiple":case"selected":r[o]=o;break;case"checked":case"CHECKED":r.checked=e.checked?"checked":void 0;break;default:/^on(\w+)/.test(o)?t.isFunction(i=e[o])&&(r[o]=r["on"+t.utils.capitalize(RegExp.$1)]=i):/^rule([A-Z]\w*)/.test(o)&&(s=RegExp.$1,i=t.utils.uncapitalize(s),r.novalidate||void 0===r[o]?r[o]=void 0:(r["rule"+s]=t.utils.trim(r[o])||!0,r["rule"+s+"Message"]=r["rule"+s+"Message"]||r["data"+s+"Message"]||r[i+"Message"]),r["dataRule"+s]=r["data"+s+"Message"]=r[i+"Message"]=void 0)}}),r},e.getComponentClassName=function(e,i){var s,n,o,r={};if(n=new RegExp("(?:\\s*|(?:\\s|\\w)+)\\b"+i+"(\\w+)\\s*","i").exec(e.className)){for(r.declare=s=n[1],n=t.utils.keys(t);o=n.shift();)if(o.toLowerCase()===s.toLowerCase()){s=o;break}t.isFunction(t[s])&&t[s].prototype instanceof t.Component&&(r.className=s)}else(n=new RegExp("\\s*([^\\s]+"+i+"\\w+)","i").exec(e.className))&&(r.declare=n[1]);return r},e.UUID=t.utils.uuid(12).toLowerCase(),e.DEBUG=!1,e.loadListeners=[],e.loaded=!1,e}();t.Application=s;var n=function(){function e(){}return e.prototype.print=function(e){t.print(e)},e.prototype.error=function(e){t.print(e,"error")},e.prototype.info=function(e){t.print(e,"info")},e.prototype.log=function(e){t.print(e,"log")},e}();t.setDebugger=e,t.parse=i,$(function(){e(!0),setTimeout(function(){new s({isPageApplication:!0})},0)})}(utry||(utry={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},utry;!function(t){var e=function(){function e(){if(this._events={},!(this instanceof e))throw'Please use the form of "new Class()" to create the object.'}return e.prototype.on=function(e,i){var s=this._events;if(void 0==s[e]&&(s[e]=[]),
!t.isFunction(i))throw"Listener must be a function. \r\n"+e;return s[e].push(i),this},e.prototype.once=function(t,e){var i=function(){var t,e=arguments.callee;if(t=e.utProxyListener)return e.utProxyListener=null,this.off(t.name,e),t.listener.apply(this,arguments)};return i.utProxyListener={name:t,listener:e},this.on(t,i)},e.prototype.off=function(e,i){if(arguments.length){if(void 0==i)this._events[e]=[];else if(t.isFunction(i))for(var s,n=this._events[e]||[],o=n.length;o--;)(s=n[o]).utProxyListener?s.utProxyListener.listener===i&&(s.utProxyListener=null,n.splice(o,1)):s===i&&n.splice(o,1)}else this._events={};return this},e.prototype.emit=function(e){var i,s,n=(this._events[e]||[]).concat(),o=t.utils.argsToArray(arguments,1),r=n.length,a=0;for(t.isFunction(o[0])&&(i=o.shift());a<r;)s=n[a++].apply(this,o),!!i&&i.call(this,s);return this},e.prototype.emitHelper=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var s=[];return this.emit.apply(this,[t,function(t){s.push(t)}].concat(e)),s},e.prototype.hasEventListener=function(e,i){var s,n=this._events[e]||[];if(t.isFunction(i)){for(s=n.length;s--;)if(n[s]===i)return!0}else if(n.length)return!0;return!1},e}();t.EventEmitter=e;var i=function(e){function i(i,s){if(e.call(this),this.state="pending",0===arguments.length);else{if("function"!=typeof i)throw"The first argument must be a function.";try{i.call(this.context=s,t.bind(function(){if("pending"===this.state){var e=this,i=this.waitFor,s=t.utils.argsToArray(arguments);setTimeout(function(){i.apply(e,s)},0)}},this),t.bind(function(){if("pending"===this.state){var e=this,i=this.doReject,s=t.utils.argsToArray(arguments);setTimeout(function(){i.apply(e,s)},0)}},this))}catch(n){"pending"===this.state&&this.doReject(n)}}}return __extends(i,e),i.prototype.then=function(e,s){var n,o,r,a=new i;for(a.context=this.context,o=0;o<2;o++)n=arguments[o],n="function"==typeof arguments[o]?arguments[o]:0==o?function(t){return t}:function(t){throw t},r=0==o?"resolved":"rejected",this.once(r,t.bind(function(t,e,i){try{this.waitFor(e.apply(this.context,t[i]))}catch(s){this.doReject(s)}},a,this,n,r));return a},i.prototype.fail=function(t){if("function"==typeof t)return this.then(null,t);throw"Arguments must be a function."},i.all=function(e){if(e instanceof i&&(e=[e]),t.isArray(e)){for(var s,n,o=0,r=[],a=e.length,l=null,d=null,h=new i(function(t,e){l=t,d=e}),u=function(){o==a&&l(r)},c=0;c<a;c++)if((s=e[c])instanceof i)if("pending"===(n=s.state))s.once("resolved",t.bind(function(t){r[t]=this.resolved,o++,u()},s,c)).once("rejected",function(){d(this.rejected)});else{if("resolved"!==n){d(s.rejected);break}r[c]=s.resolved,o++}else r[c]=s,o++;return u(),h}throw"Arguments must be a array who contains some Promise instance."},i.prototype.waitFor=function(t){if(t===this&&(t=void 0),t instanceof i){var e=this,s=function(t){e.doResolve.apply(e,t)},n=function(t){e.doReject.apply(e,t)};"pending"===t.state?t.once("resolved",function(){s(t.resolved)}).once("rejected",function(){n(t.rejected)}):"resolved"===t.state?s(t.resolved):n(t.rejected)}else this.doResolve.apply(this,arguments)},i.prototype.doResolve=function(e){"pending"===this.state&&(this.state="resolved",this.resolved=t.utils.argsToArray(arguments),this.emit.apply(this,["resolved"].concat(this.resolved)))},i.prototype.doReject=function(e){"pending"===this.state&&(this.state="rejected",this.rejected=t.utils.argsToArray(arguments),this.emit.apply(this,["rejected"].concat(this.rejected)))},i}(e);t.Promise=i}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(i){e.call(this),i=this.options=t.utils.extend({},i),this.init(i),this.preventChangeEvent=i.preventChangeEvent,this.preventDataClone=i.preventDataClone,this.preventDataMerge=i.preventDataMerge,void 0!=i.data&&this.loadData(i.data),this._setFields(i.fields||[],i.dataKey),this._loadStatus=-1}return __extends(i,e),i.prototype.init=function(t){},i.prototype.update=function(e,i){var s;return t.isObject(e)&&(s=i,i=e,e=s),t.isObject(i)?this.batchUpdate([i],e):this},i.prototype.batchUpdate=function(e,i){if(t.isEmpty(i=t.utils.trim(i))&&(i=this._key),!t.isEmpty(i)&&t.isArray(this.data)){t.isArray(e)||(e=[e]);var s=!!this.preventChangeEvent,n=s;return e=this.convertFields(e,!0),t.utils.each(this.data,function(s){if(t.isObject(s))for(var o,r,a=0,l=e.length;a<l;a++)if(t.isObject(o=e[a])&&o[i]==s[i]){o[i]=void 0,n||(r=t.utils.copy(s)),t.utils.extend(s,o),n||t.isEqual(s,r)||(n=!0),e.splice(a,1);break}},this),!n||s&&"localStorage"!==this.options.type||this.changed(),this}},i.prototype.remove=function(e,i){var s=t.utils.copy(this.data);this._filter.apply(this,["delete"].concat(t.utils.argsToArray(arguments))),t.isEqual(this.data,s)||this.changed()},i.prototype.append=function(e){var i=t.utils.copy(this.data);e=this.convertFields(e),t.isArray(this.data)?this.data=this.data.concat(e):t.isObject(this.data)&&t.isObject(e)&&t.utils.extend(this.data,e),t.isEqual(this.data,i)||this.changed()},i.prototype.put=function(t,e){return this._add("push",t,e)},i.prototype.unshift=function(t,e){return this._add("unshift",t,e)},i.prototype._add=function(e,i,s){var n=t.utils.copy(this.data);return t.isObject(n)?this.data[i]=s:(s=this.convertFields(t.utils.copy(i)),t.isArray(n)?this.data[e](s):this.data=[s]),t.isEqual(this.data,n)||this.changed(),this},i.prototype.select=function(e,i){var s=this._filter.apply(this,["select"].concat(t.utils.argsToArray(arguments)));return this.preventDataClone?s:t.utils.copy(s)},i.prototype.slice=function(e,i,s){var n=this.data;return n=t.isArray(n)?n.slice(e,i):[],s||this.preventDataClone?n:t.utils.copy(n)},i.prototype.sort=function(e,s){var n=this.data,o=t.isArray(n)?n.slice():n;return t.isEqual(o,this.data=i.arraySort(n,e,s))||this.changed(),this},i.prototype.size=function(){return t.isArray(this.data)?this.data.length:0},i.prototype.get=function(e){var i=this.data&&this.data[e];return this.preventDataClone?i:t.utils.copy(i)},i.prototype.forEach=function(e){return t.utils.forEach(this.data,e),this},i.prototype.persist=function(){},i.prototype.dataFilter=function(t){return t},i.prototype.changed=function(){var t=this.options;return"localStorage"===t.type&&t.src&&this.data&&this._localStorageLoad(t.src,this.data),this.preventChangeEvent?this:this.emit("change")},i.prototype.getData=function(){return this.preventDataClone?this.data:t.utils.copy(this.data)},i.prototype.setData=function(e,i){var s=this.data,n=this.filterData(e);return this.data=e=this.convertFields(this.preventDataClone?n:t.utils.copy(n),!0),i||t.isEqual(s,e)||this.changed(),this},i.prototype.getOptions=function(){return t.utils.copy(this.options)},i.prototype.clear=function(){return this.setData(null)},i.prototype.fetch=function(e){if(e=this.options=t.utils.extend(this.options,e),this._setFields(e.fields,e.dataKey),this._loadStatus>=0)return void(this._loadStatus>0&&this.emit("fetched",this.data,1===this._loadStatus).changed());if(void 0!=e.data&&(e.preserveData||(this.data=null,this._cleaned=!0),this.loadData(e.data),e.data=null),this._loadStatus=0,e.src){var i=e.type||"url";"url"==i?this._ajaxLoad():"localStorage"==i&&this._localStorageLoad(e.src)}else this._loadComplete();return this},i.prototype.setAjaxOptions=function(e,i){t.isObject(i)||(i=this.options);var s,n;return e=t.utils.object(e,!0),i.params=t.utils.extend(t.utils.parseParams(i.params),t.utils.parseParams(e.params)),delete e.params,s=e.ajaxSetup||{},i.ajaxSetup=t.utils.extend(i.ajaxSetup,s,{data:t.utils.extend(t.utils.parseParams((i.ajaxSetup||{}).data),t.utils.parseParams(s.data))}),delete e.ajaxSetup,void 0!=(n=t.utils.trim(e.url))&&t.isString(n)&&(i.src=n),t.utils.extend(i,e),this},i.prototype.reload=function(t){var e=this.options;return this.setAjaxOptions(t,e),0==this._loadStatus&&this._xhr&&(this._loadStatus=-2,this._xhr.abort()),this._loadStatus=-1,this.fetch(e)},i.prototype.loadData=function(t){var t=this.filterData(t);return t=this.convertFields(t,!0),this.data=this._merge(this.data,t),this.emit("loaded",t)},i.prototype._merge=function(e,i){return this.preventDataMerge?i||e:(t.utils.keys(e).length||(e=void 0),t.utils.keys(e).length||(e=void 0),void 0==e||void 0==i?e=void 0==e?i:e:t.isArray(e)&&t.isArray(i)?e=e.concat(i):t.isObject(e)&&t.isObject(i)?e=t.utils.deepExtend(e,i):t.print("Can not merge data from remote to local.","warn"),e)},i.prototype._ajaxLoad=function(){var e=this.options;this._xhr=this.ajax(t.utils.extend({},e,{context:this,url:e.src,success:function(t){this._destroyed||(this._cleaned||e.preserveData||(this.data=null),this.emit("loadSuccess",t).loadData(t)._loadStatus=1)},complete:this._loadComplete,error:function(t,e,i){this._loadStatus==-2||this._destroyed||this.emit("loadError",e,i)._loadError(i||new Error("Can not load data.\nerror:"+e))}}))},i.prototype.ajax=function(e){e=t.utils.object(e);var i="application/json; charset=utf-8",s="application/x-www-form-urlencoded; charset=utf-8",n="application/xml; charset=utf-8",o="application/object; charset=utf-8",r=t.utils.object(e.ajaxSetup),a=t.utils.trim(e.contentType||r.contentType),l=t.utils.makeRegExp(a,"i");l.test(i)?a="json":l.test(n)?a="xml":l.test(s)?a="form":l.test(o)&&(a="object");var d=/^xml$/i.test(a),h=d?e.params:t.utils.parseParams(e.params),u=e.dataType||r.dataType,c=e.queryNamesMap,p=/^json|object|xml$/i.test(a)?"post":"get",f=t.utils.trim(r.data),m=r.async;return/^list|tree|object|obj|map|set$/i.test(u)&&(u="json"),r.data=void 0,!d&&t.isString(f)&&(f=t.utils.parseParams(f)),f=t.utils.extend({},h,f),t.isObject(c)&&t.utils.forEach(c,function(t,e){e in f&&f.hasOwnProperty(e)&&(f[t]=f[e],t!==e&&delete f[e])}),/^json$/i.test(a)?(f=JSON.stringify(f),a=i):d?a=n:(f=/^object$/i.test(a)?$.param(f,!1):$.param(f,!0),a=s),$.ajax(e.url,t.utils.extend({},r,{data:f,async:void 0==m||!!m,cache:!!r.cache,context:e.context,dataType:u||"json",contentType:a,type:e.method||r.type||p,beforeSend:t.utils.makeRunSequence(r.beforeSend,e.beforeSend),success:t.utils.makeRunSequence(r.success,e.success),error:t.utils.makeRunSequence(r.error,e.error),complete:t.utils.makeRunSequence(r.complete,e.complete)}))},i.prototype._localStorageLoad=function(t,e){if(arguments.length>1)localStorage.setItem(t,JSON.stringify(e));else{var i=localStorage.getItem(t);(void 0==i||/^\bnull|undefined\b$/.test(i))&&(i=null);try{this.loadData(i&&JSON.parse(i)||null)._loadStatus=1}catch(s){this._loadError(s)}finally{this._loadComplete()}}},i.prototype._loadComplete=function(){if(this._xhr=null,this._cleaned=!1,!this._destroyed){var e;if(this._loadStatus==-2)return this._loadStatus=1,this.changed();e=this.data,this.data=e=this.preventDataClone?e:t.utils.copy(e),this.emit("fetched",e,1===this._loadStatus),this.changed()}},i.prototype.convertFields=function(e,i,s){if(void 0==e)return e;var n,o,r,a,l,d,h,u,c=this._fields,p=this._key,f=t.utils.uuid,m=e,g=function(e){return t.isArray(e)?e:null},v=function(e){return t.isObject(e)?e:null};for(s=t.utils.extend({string:function(t){return void 0==t?"":String(t)},number:function(t){return Number(t)||0},array:g,list:g,object:v,obj:v,"boolean":Boolean,date:t.utils.dateParser},s),t.isArray(m)||(m=[m]),o=m.length,a=0;a<o;a++)if(t.isObject(n=m[a])){for(l=0;l<c.length;l++)r=c[l],(d=r.field)&&(h=r.map,i&&!n.hasOwnProperty(d)&&h&&n.hasOwnProperty(h)&&(n[d]=n[h],p!==h?d!==h&&!t.isBasicType(n[h])&&delete n[h]:p!==d&&c.push({field:p,type:r.type||"string"})),n.hasOwnProperty(d)&&(void 0!==n[d]?(u=s[r.type])&&(n[d]=u(n[d])):delete n[d]));i&&p&&(p in n&&void 0!=n[p]&&""!==n[p]||(n[p]=f(8).toLowerCase()))}return e},i.prototype.getFieldMap=function(e){var i,s=this.getField(e);return s&&!t.isEmpty(i=t.utils.trim(s.map))&&(e=i),e},i.prototype.getField=function(e){return t.utils.filter(this._fields,function(t){return e===t.field})[0]},i.prototype._setFields=function(e,i){void 0!==e&&(t.isArray(e)||(e=[e]),this._fields=t.utils.filter(e,function(e){return t.isObject(e)})),!t.isEmpty(i=t.utils.trim(i))&&t.isBasicType(i)&&(this._key=i+"",this.getField(i)||this._fields.push({field:i,type:"string"}))},i.prototype.filterData=function(e){try{var i=this.options;e=void 0==e?{}:e,e=i&&i.dataFilter?i.dataFilter.call(null,e):this.dataFilter(e)}catch(s){t.print(s,"error")}return e},i.prototype._loadError=function(e){this._loadStatus=2,t.print(e||new Error('Can not load data from "'+this.options.type+":"+this.options.src+'".'),"error")},i.prototype._filter=function(e,i,s){var n,o=[];if(arguments.length>2&&!t.isObject(i)?(n={})[i]=s:n=t.isObject(i)?t.utils.extend({},i):{},t.isArray(this.data)){this.convertFields(n);for(var i,r,a,l=this.data,d=t.utils.keys(n),h=0;h<l.length;h++)if(a=!1,t.isObject(r=l[h])){for(var u=0;i=d[u];u++)if(!t.isEqual(r[i],n[i])){a=!0;break}a||("select"==e?o.push(r):"delete"==e&&o.push(l.splice(h--,1)[0]))}}return o},i.arraySort=function(e,s,n){if(s&&t.isString(s)&&t.isArray(e)&&e.length){var o=i.comparator;return t.isString(n)?n="desc"==(n=n.toLowerCase())?-1:"asc"==n?1:0:t.isFunction(n)&&(o=n,n=2),t.utils.arraySort(e,function(t,e){var i=o(t[s],e[s]);return n<2&&(i*=n),i})}return e},i.comparator=function(t,e){var i,s,n=typeof t,o=typeof e;return"number"==n&&"string"==o?-1:"string"==typeof n&&"number"==typeof o?1:"number"==typeof n&&"number"==typeof o?t==e?0:t>e?1:-1:(t+="",e+="",i=t.replace(/[^\x00-\xff]/g,"..").length,s=e.replace(/[^\x00-\xff]/g,"..").length,i===s?t.localeCompare(e):i>s?1:-1)},i}(t.EventEmitter);t.Store=e}(utry||(utry={}));var utry;!function(t){function e(){var e,s,n,o,r;return t.isObject(e=arguments[0])?(r=e.source,o=e.selector||(void 0==e.id?"":"#"+String(e.id).replace(/^\s*#\s*|\s*$/g,"")),s=e.data,n=e.replace):(e={},o=arguments[0],o=t.isArray(o)?o.join(""):o,s=arguments[1],n=arguments[2]),/<\/?[a-z][a-z0-9]*[^<>]*>/i.test(o)&&(r=t.isEmpty(r)?o:r,o=" "),n===!0&&(n=o),n&&!t.isEmpty(r)&&(o=" "),n&&o?(n===o?$(o).each(function(){var n=$(this);n.html(new i(t.utils.extend({},e,{source:t.isEmpty(r)?n.html():r})).render(s)),t.parse(this)}):(r=t.isEmpty(r)?$(o).html():r,$(n).each(function(){$(this).html(new i(t.utils.extend({},e,{source:r})).render(s)),t.parse(this)})),""):(e.source=t.isEmpty(r)?$(o).html():r,new i(e).render(s))}var i=function(){function e(i){this.uuid=t.utils.uuid(8),i=this.options=t.utils.extend({},e.DEFAULTS,i),this.debug=!!i.debug,this.templateContext=i.context,this.context={forEach:t.utils.forEach,escape:t.utils.escapeHTML,getString:this._getString,filters:t.utils.object(i.filters||i.context),filterContext:i.filterContext||i.context,insert:t.isFunction(i.insert)?t.bind(i.insert,i.context):t.bind(this._insert,this),include:t.isFunction(i.include)?t.bind(i.include,i.context):t.bind(this._include,this)},this.source=i.source,this.id=t.utils.trim(i.id),this.name=t.utils.trim(i.name)||this.id,this.variables={},i.cache&&this.id&&t.put(this.id,this,e.UUID)}return e.prototype.render=function(e){if(!this.compiled){var i=this.source,s=this.id;if(!t.isEmpty(i)&&t.isBasicType(i=t.isArray(i)?i.join(""):i))this.compile(i+"");else if(!t.isEmpty(s)&&"object"==typeof document){var n=document.getElementById(s);n?this.compile(t.utils.trim(n.value||n.innerHTML)):(this._echo({message:"Template not found."},"error"),this.generator=this.options.debug?function(){return"{{Template not found}}"}:function(){return""},this.compiled=!0)}}return this.generator?this.generator(t.isEmpty(e)?{}:e):""},e.prototype.execLogic=function(t){this.logicRender&&this.logicRender(t)},e.prototype.compile=function(e){var i=this.options,n=new s({debug:this.debug,compress:i.compress,name:i.name,printer:t.bind(this._echo,this),context:this.context,escape:i.escape,variables:this.variables,openTag:i.openTag,closeTag:i.closeTag}),o=n.compile((void 0==e?"":e+"")||this.source)||function(){throw new Error("Template Syntax Error.")},r=n.logicRender||o;return this.logicRender=function(t){try{r.prototype=this.context,new r(t)}catch(e){this._echo(e,"error")}},this.htmlRender=o,this.htmlText=n.htmlText,this.compiled=!0,t.bind(this.generator=function(t){try{return o.prototype=this.context,new o(t)+""}catch(e){this._echo(e,"error")}},this)},e.prototype.clone=function(i){i=t.utils.extend({},i);var s=new e(t.utils.extend({},this.options,i));return void 0==i.source&&void 0==i.name&&(s.compiled=!0,s.generator=this.generator,s.logicRender=this.logicRender,s.htmlText=this.htmlText,s.variables=this.variables),s},e.prototype.getVariables=function(){return t.utils.copy(this.variables)},e.prototype._include=function(i){var s,n;return s=i instanceof e?i:t.get(i,e.UUID),s||(n=this.options,s=new e({id:i,cache:!!n.cache,debug:this.debug,filters:n.filters,filterContext:n.filterContext,context:this.templateContext,insert:n.insert})),s.render.apply(s,t.utils.argsToArray(arguments,1))},e.prototype._insert=function(e){var i,s=this.templateContext||window,n=t.utils.uuid(8);if(t.isFunction(e))i=e;else if(!t.isFunction(i=s[e]||window[e]))throw"unresolved function or method "+e+"().";var o=t.utils.argsToArray(arguments,1),r="&#x27;";return t.put(n,{method:i,context:s,params:o},"EVENTS"),"utry("+r+n+r+",event,this)"},e.prototype._echo=function(e,i){if(this.debug){i=i||"info";var s="Template "+t.utils.capitalize(i)+"\n\n";s+="<name>\n"+this.name+"\n\n";for(var n in e)e.hasOwnProperty(n)&&(s+="<"+n+">\n"+e[n]+"\n\n");t.print(s,i)}if("error"==i)throw e},e.prototype._getString=function(e){return e=t.isFunction(e)?this.insert(e):void 0===e?"":String(e)},e.DEFAULTS={name:"",source:"",cache:!1,openTag:"{{",closeTag:"}}",escape:!0,debug:!1,compress:!0,filters:null},e.UUID=t.utils.uuid(12),e}();t.Template=i;var s=function(){function e(e){e=t.utils.extend({},e),this.name=e.name,this.debug=!!e.debug,this.compress=!!e.compress,this.escape=!!e.escape,this.context=e.context,this.printer=e.printer,this.openTag=e.openTag,this.closeTag=e.closeTag,this.stack=[],this.uuid=t.utils.uuid(4);var i=this.isNewEngine=!!"".trim;this.variables=e.variables||{},this.htmlText=i?"":[];var s=this.getName("out"),n=this.getName("index");this.replaces=i?[s+"='';",s+"+=",";",s]:[s+"=[];",s+".push(",");",s+".join('')"],this.concat=i?s+"+=text;":s+".push(text);",this.print="function(){var text=''.concat.apply('',arguments);"+this.concat+"}",this.include="function(name,ctx){var text=this.include(name,ctx,"+n+"++);"+this.concat+"}",this.logicInclude="function(name,ctx){this.include(name,ctx,"+n+"++,true);}"}return e.prototype.compile=function(e){var i,s,n=null,o=this.getName("line"),r=this.getName("filters"),a=this.getName("out"),l=this.getName("index"),d=this.stringify("<"+this.name+"/>")+";'use strict';var "+o+"=0,"+l+"=0,"+r+"=this.filters,",h={defined:{},line:1,headCode:d,logicHeadCode:d,mainCode:this.replaces[0],logicCode:this.getName("logic")+"=true;",footCode:"return new String("+this.replaces[3]+");"},u=this.getName("data");h.defined[o]=1,h.defined[r]=1,h.defined[a]=1,h.defined[this.getName("temp")]=1,t.utils.forEach(e.split(this.openTag),function(t){t=t.split(this.closeTag);var e=t[0],i=t[1];1===t.length?h.mainCode+=this.html(e,h):(h.mainCode+=this.logic(e,h),i&&(h.mainCode+=this.html(i,h)))},this),t.isArray(s=this.htmlText)&&(s=s.join("")),this.htmlText=t.utils.trim(s),i=h.headCode+h.mainCode+h.footCode,this.debug&&(i="try{"+i+"}catch(e){(({}).toString.call(e)=='[object Error]')||(e=new Error(e));throw {message:e.message,line:"+o+",source:"+this.stringify(e)+".split(/\\n/)["+o+"-1].replace(/^\\s+/,'')}}");try{this.render=n=new Function(u,i),this.logicRender=new Function(u,h.logicHeadCode+h.logicCode),n.prototype=this.logicRender.prototype=this.context}catch(c){this.printer({message:c.message,code:"function Render("+u+"){\n"+i+"\n}"},"error")}return n},e.prototype.html=function(e,i){return this.debug&&(i.line+=e.split(/\n/).length-1),this.compress&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(t.isArray(this.htmlText)?this.htmlText.push(e):this.htmlText+=e,e=this.replaces[1]+this.stringify(e)+this.replaces[2]+"\n"),e},e.prototype.logic=function(e,i){var s=this.replaces,n=this.getName("data"),o=this.getName("include"),r=this.getName("print");if(e=this.parse(e),"="==e.charAt(0)){var a=this.escape&&!/^=[=#]/.test(e);if(e=e.replace(/^=[=#]?|[\s;]*$/g,""),e.indexOf(this.getName("filters"))==-1&&(e=this.setInsert(e)),a){var l=t.utils.trim(e.split("(")[0]);l!=o&&l!=r&&(e="this.escape("+e+")")}else e="this.getString("+e+")";e=s[1]+e+s[2]}else i.logicCode+=e;return this.debug&&(e=this.getName("line")+"="+i.line+";"+e),t.utils.forEach(this.getVariables(e),function(e){if(e&&!i.defined[e]&&!t.utils.some(this.stack,function(t){return t.hasOwnProperty(e)})){var s,a;e==r?s=this.print:e==o?(s=this.include,a=e+"="+this.logicInclude+","):"$data"===e?s=n:(s=n+"."+e,this.variables[e+"@length"]||(this.variables[e]=1)),i.headCode+=s=e+"="+s+",",i.logicHeadCode+=a||s,i.defined[e]=1}},this),e+"\n"},e.prototype.setInsert=function(t){var e=this.stringify;return t=t.replace(/(\w+)\s*\(([^\)]*)\)/g,function(t,i,s){return s=s.replace(/(this)?(?:\s*\[\s*(')(.*?)\2\s*])+|(\bthis\b)/g,function(t,i,s,n,o){return i&&s&&n?e(t):s&&n?t:o?"'"+o+"'":t}),"this.insert('"+i+(s.replace(/\s/g,"")?"',":"'")+s+")"})},e.prototype.getVariables=function(t){var i=e;return t.replace(i.REMOVE_RE,"").replace(i.SPLIT_RE,",").replace(i.KEYWORDS_RE,"").replace(i.NUMBER_RE,"").replace(i.BOUNDARY_RE,"").split(i.SPLIT2_RE)},e.prototype.getName=function(t){return"$"+this.uuid+"$"+t},e.prototype.getData=function(e){var i,s=[],n=-1;if(e.replace(/(['"]).*?\1|,/g,function(i,o,r){!o&&(i=t.utils.trim(e.substring(n+1,n=r)))&&s.push(i)}),n<e.length&&(e=t.utils.trim(e.substring(n+1)))&&s.push(e),!s.length)return"{}";for(var o,r=this.getName("temp"),a="(function("+r+"){",l=";return "+r+";}({}))",d="",h=0,u=function(s,o,r){o||(n||(i=t.utils.trim(e.substring(0,r))),n=r+2)};h<s.length;h++)n=0,(i=e=s[h]).replace(/(['"]).*?\1|\bas\b/g,u),n&&(o=t.utils.trim(e.substring(n))),h>0&&(d+=","),d+=r+"["+this.stringify(o||i)+"]="+i,o="";return a+d+l},e.prototype.stringify=function(t){return"'"+t.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"},e.prototype.parse=function(e){var i=this.stringify;e=e.replace(/^\s*/g,"").replace(/(?:(['"])[^.\]]*\..*?\1)|\s*?\.\s*([a-zA-Z_$][a-zA-Z_$\d]*)/g,function(t,e,s){return e?t:"["+i(s)+"]"});var s,n;if(s=/include\s+(?:(['"])([^\s]+)\1|([^'"\s]+))(.*)/.exec(e))return n=i(s[2]||s[3])+","+this.getData(s[4]),this.getName("include")+".call(this,"+n+");";if(s=/^exec\s+(\w+)\s*:?(.*)$/.exec(e))return n=s[2],e=this.getName("filters")+"."+s[1]+".call(this.filterContext"+(n?","+n:"")+");";if(/^debugger[\s;]*$/i.test(e))return"\r\ndebugger;";if(s=/^#?\s*([^|\s]+|)\s*(?:\|[^|]\s*)+\w+/.exec(e)){var o=!0,r=this.getName("filters");"#"==e.charAt(0)&&(o=!1);for(var a=s[1],l=/\|\s*(\w+)\s*:?([^|]*)/g,d=function(t,e,i){return i&&(i=","+i),r+"."+e+".call(this.filterContext,"+(t?t:"''")+i+")"};s=l.exec(e);)a=d(a,s[1],s[2]);return e=(o?"=":"=#")+a}var n,h=e.replace(/(?:(['"])[^,\]]*,.*?\1)|\s*?(,\s*[^,]+)/g,function(t,e,i){return e?t:i.replace(/^,\s*/," ")}).replace(/\[\s*([^\s]+)\s*]/g,"[$1]").split(" "),u=h.shift();switch(!!h.length&&(h=t.utils.filter(h,function(t){return""!==t})),n=h.join(" "),u){case"if":e="if("+n+"){";break;case"else":h="if"===h.shift()?" if("+h.join(" ")+")":"",e="}else"+h+"{";break;case"/if":case"/else":e="}";break;case"for":1!==h.length&&(h=[h[2],h[1],h[0],h[3],h[4]]);var c="in";case"each":var p=h[0]||this.getName("data"),f=h[1]||c||"as",m=h[2]||"$value",g=h[3]||"$index",v=h[4]||"$object",y=m+","+g+","+v,b={};b[g]=1,b[m]=1,b[v]=1,new RegExp("^("+g+"|"+m+"|"+v+")(?:\\[|)$").test(p)&&(b[RegExp.$1]=0),this.stack.unshift(b),f!==(c||"as")&&(p="null"),/^\[(.+)]$/.test(p)&&(this.variables[(p=RegExp.$1)+"@length"]=1),t.utils.some(this.stack.slice(1),function(t){return!!t[p]})&&(b[p]=1),e="this.forEach("+p+",function("+y+"){";break;case"/for":case"/each":this.stack.shift(),e="},this);";break;case"print":e=this.getName(u)+".call(this,"+n+");";break;default:e="="+e}return e},e.KEYWORDS="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,Infinity,NaN,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",e.REMOVE_RE=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,e.SPLIT_RE=/[^\w$]+/g,e.KEYWORDS_RE=new RegExp(["\\b"+e.KEYWORDS.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),e.NUMBER_RE=/^\d[^,]*|,\d[^,]*/g,e.BOUNDARY_RE=/^,+|,+$/g,e.SPLIT2_RE=/^$|,+/,e}();t.render=e}(utry||(utry={}));var utry;!function(t){function e(e){if(t.isString(e)){var s,o=t.get(e,"EVENTS"),r="COMPONENT";return o?(s=arguments[1]||window.event,s&&(s.currentTarget=arguments[2]),n.dispatch(t.utils.extend({},o,{event:s,target:s&&s.target,currentTarget:arguments[2]}))):(o=t.get(e,r)||t.get(e.replace(/^#/,""))||t.get("#"+e,r))?o:"function"==typeof t[e]?new t[e](arguments[1]):$(e)}if(e instanceof $||t.isElement(e)||t.isTextNode(e))return $(e);if(t.isFunction(e))t.Application.addLoadListener(e,arguments[1]);else if(t.isObject(e))return i(e)}function i(e){var i,s;if(t.isString(i=arguments[0])&&t.isObject(e=arguments[1])&&(e.className=i),!t.isObject(e)||!(i=e.className)||!t.isString(i))throw"Argument error.";if(s=i.toLowerCase(),t.utils.some(t,function(t,e){return e.toLowerCase()===s}))throw"The name of class '"+i+"' has been used.";return(s=t[i]=new Function("function "+i+"(){utry.Component.apply(this,arguments)}return "+i)()).prototype=t.utils.copy(e),t.inherits(s,n)}function s(e,i){var s,o,r=null;return t.isString(e)&&(o=e.toLowerCase())&&(s=t.utils.filter(t,function(e,i){return i.toLowerCase()===o&&t.isFunction(t[i])&&t[i].prototype instanceof n})).length?r=new s[0](i):t.print(new Error('Not found the definition of component by "'+e+'".'),"error"),r}var n=function(e){function i(s){var n=this;e.call(this),this.options=s=t.utils.extend({ajaxSetup:{data:{}},params:{},queryNamesMap:{}},s),this._name=this.constructor.name;var o=s.el;if(o&&"body"!=o&&o!=document.body&&(o=$(o)).length&&o[0]!=document.body){if(void 0!=o.attr(i.UUID))return t.print("The component's container has been used by others.\r\nMay be need to use one of the 'new utry."+this._name+"()' or 'class=\"utry-"+this._name+"\"'.","error"),this;o.length&&o.attr(i.UUID,"")}this.destroyed=this._destroyed=!1,this._view=null,this._viewMap={},this._pseudoViewMap={},this._pseudoEvents=[],this._childViews=[],this._childComponents=[],this._state={},this._stateChangeTrack=0,this._stateTrackMap={},this._dispatchViewEventMap={},this._globalDelegateEvents=[],this._elementEvents=[],this._hasBoundInitEvents=!1,this._fetched=!1,this._readied=!1,this._visibility="visible",this._broken=!1,this._recovering=!1,this._viewModel={},this._uuid=s.uuid||t.utils.uuid(12);var r=this.id=t.utils.trim(s.id);if(!t.isEmpty(r)){var a;if(a=t.get(r,"COMPONENT")){t.print("Reduplicate component id: "+r+"\r\nThe previous component with id of '"+r+"' will be destroyed.","warn");try{a.destroy()}catch(l){t.print(l,"error")}}t.put(r,this,"COMPONENT")}this.name=t.utils.trim(s.name),s.width=t.utils.setUnit(s.width),s.height=t.utils.setUnit(s.height),this.initRenderDelay=void 0!=s.initRenderDelay?s.initRenderDelay:30,this._children=s.children||[],this.childComponents=[],this._lifeCycle="Init,Fetch,Render,Ready,Update,Show,Hide,Destroy,Valid,Invalid".split(",");for(var d,h,u,c=this._lifeCycle.concat();d=c.pop();)u=/\bFetch|Render|Update|Show|Hide|Valid|Invalid\b/i.test(d)?"on":"once",s[h="onBefore"+d]&&this[u](h,s[h]),s[h="onAfter"+d]&&this[u](h,s[h]);if((u=s.onLoadError)&&this.on("onLoadError",u),(u=s.onLoadSuccess)&&this.on("onLoadSuccess",u),this.on("onAfterRender",function(){n.isFetched()&&(n.isReady()?n.emit("onMount"):n.once("onAfterReady",t.bind(n.emit,n,"onMount")))}),t.isFunction(s.onMount)&&this.on("onMount",s.onMount),t.isFunction(s.onFirstMount)&&this.once("onMount",s.onFirstMount),this.emit("onBeforeInit",s),this.isPaused())this._execAfterResumed(this._execInit);else{var p=this._execInit();if(p)return p}}return __extends(i,e),i.prototype.bind=function(e,i,s,n){var o,r,a=t.utils.argsToArray(arguments,1),l="["+this._view.slotKey+"]",d=this._getRootElement();if(this._boundDelegateEvents||(this._boundDelegateEvents=[]),!(e=t.utils.trim(arguments[0])))throw new Error("EventName can not be empty.");if(!t.isFunction(n=o=a.pop()))throw new Error("Listener must be a function.");return t.isFunction(i)&&(i=l),s=4==arguments.length?a.pop():void 0,n=this._getEventSourceHandler(n),n=void 0===s?t.bind(n,this):t.bind(n,this,s),i instanceof $||t.isElement(i)?($(i).bind(e,n),this):((r=String(i).match(/::([^\s]+)/))?this._registerPseudoDelegate(r[1],e,t.utils.trim(i.replace(/::[^\s]+/g,"")),n,o):!i||i===l||d.is(i)?(i=l,d.bind(e,n)):/^(?:document|window|body)$/i.test(i)?this._registerDelegate(e,i=i.toLowerCase(),n,o):this._delegateSpecialEvent(e,i,n)||d.delegate(i,e,n),this._boundDelegateEvents.push({data:s,selector:i,eventName:e,listener:n,original:o}),this)},i.prototype.unbind=function(e,i,s){var n=this._boundDelegateEvents,o=this._view.slotKey;if(t.isArray(n)&&n.length){var r=t.utils.argsToArray(arguments,1),a=this._getRootElement();if(!(e=t.utils.trim(arguments[0])))throw new Error("EventName can not be empty.");if(s=3==arguments.length?r.pop():void 0,i=t.utils.trim(r.pop()),i instanceof $||t.isElement(i))return $(i).unbind(e,s),this;t.isFunction(i)&&(s=i,i="["+this._view.slotKey+"]"),t.utils.each(this._getEventObjects(n,e,i,s),function(r){if(r){var l;e=r.eventName,i=r.selector,s=r.listener,(l=String(i).match(/::([^\s]+)/))?this._unRegisterPseudoDelegate(l[1],e,t.utils.trim(i.replace(/::[^\s]+/g,"")),s):!i||i==="["+o+"]"||a.is(i)?a.unbind(e,s):/^(?:document|window|body)$/i.test(i)?this._unRegisterDelegate(e,i,s):this._unDelegateSpecialEvent(e,i,s)||a.undelegate(i,e,s),t.utils.remove(n,r)}},this)}return this},i.prototype.setValue=function(t){return void 0!==t&&this.setState("value",t),this},i.prototype.getValue=function(){return this.getState("value")},i.prototype.getData=function(){return t.utils.copy(this._store.data)},i.prototype.pause=function(){return this.isPaused()||(this._lifeCycle.unshift("Paused"),this.emit("_paused")),this},i.prototype.isPaused=function(){return this._destroyed||"Paused"===this._lifeCycle[0]},i.prototype.resume=function(){return!this._destroyed&&this.isPaused()&&(this._lifeCycle.shift(),this.emit("_resumed")),this},i.prototype.callSuper=function(e){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];if(t.isFunction(e=this._super[e]))return e.apply(this,i)},i.prototype.show=function(t,e,i){var s;return this._destroyed||(!s||t&&t!==this.template&&!this._getRootElement().is(t)||this.emit("onBeforeShow"),this.isPaused()?this._execAfterResumed(this._execDisplay,t,"Show",e,i):this._execDisplay(t,"Show",e,i)),this},i.prototype.hide=function(t,e,i){return this._destroyed||(this.isHidden()||t&&t!==this.template&&!this._getRootElement().is(t)||this.emit("onBeforeHide"),this.isPaused()?this._execAfterResumed(this._execDisplay,t,"Hide",e,i):this._execDisplay(t,"Hide",e,i)),this},i.prototype.isHidden=function(){return this._destroyed||"hidden"===this._visibility},i.prototype.isPartlyHidden=function(){return this._destroyed||"collapse"===this._visibility},i.prototype.reload=function(e){return this._destroyed||(e=t.utils.extend({params:{},ajaxSetup:{data:{}}},e),this.emit("onBeforeUpdate",e).emit("onBeforeFetch",e),this.beforeFetch(this.options),this.isPaused()?this._execAfterResumed(this._execReload,e):this._execReload(e)),this},i.prototype.ajax=function(e){var e=t.utils.object(e),i=this._store||new t.Store(this._initStoreOptions()),s=i.getOptions();return i.setAjaxOptions(e,s).ajax(t.utils.extend(s,{context:this,url:s.src,success:e.success||e.onsuccess||e.onSuccess||t.voidFunc,complete:e.complete||e.oncomplete||e.onComplete||t.voidFunc,error:e.error||e.onerror||e.onError||t.voidFunc})),this},i.prototype.repaint=function(e,i){
return this.setState(t.utils.object(e),i)},i.prototype.redraw=function(t){return this},i.prototype.refresh=function(){return this._initRender(),this},i.prototype.appendTo=function(e){if(!this._destroyed){var i=this._getRootElement(),s=this._view;e=$(e),e.length?i.length?$(e).append(i):(s.element=this._el=this.options.el=$("<i/>").appendTo(e),this._initRender()):t.print("Not found the element to insert.","warn")}return this},i.prototype.destroy=function(){return this._destroyed||(this.emit("onBeforeDestroy"),this.isPaused()?this._execAfterResumed(this._execDestroy):this._execDestroy()),this},i.prototype.init=function(t){},i.prototype.setModel=function(e){if(!(e instanceof t.Store))throw'Model must be a instance of "utry.Store".';return this._store=this.model=e,this},i.prototype.dataFilter=function(t){return this._store.dataFilter(t)},i.prototype.beforeFetch=function(t){},i.prototype.afterFetch=function(t,e){},i.prototype.initState=function(e,i){return t.utils.extend({},this._store.data)},i.prototype.render=function(t,e,i){return this._view.render(t)},i.prototype.renderView=function(e){if(!this._readied||!e||!t.isArray(e.xPath))return this;var i=this._importPath=e.xPath,s=this._view.xPath;try{t.isEqual(i,s)?this.refresh():t.utils.startsWith(i,s)&&(this._oldState=this._state,this._state=t.utils.copy(this.initState(this._store.data,this.options)),this.template.execLogic(this._viewModel=t.utils.extend(this._viewModel,this._state)),this._execReplace(""))}catch(n){}return this._importPath=null,this},i.prototype.afterInit=function(t){},i.prototype.beforeRender=function(t){},i.prototype.afterRender=function(t){},i.prototype.ready=function(t){},i.prototype.listenTo=function(e,i,s){if(!arguments.length||!(e=t.utils.trim(e)))return this;if(i&&t.isFunction(s)&&!t.isArray(i)&&(i=[i]),t.isFunction(i)&&(s=i,i=null),!t.isFunction(s))throw"Handler must be a function.";return this._stateTrackMap[e]=1,this.on(this._uuid+"_"+e+"Change",function(t){if(i){for(var e=i.length,n=0;n<e;n++)if(t===i[n])return s.apply(this,arguments)}else s.apply(this,arguments)})},i.prototype.find=function(e,i){var s,n,o,r,a="__pseudo__"===arguments[2];if(t.isEmpty(t.utils.trim(e)))s=$();else if(r=/^::([^\s]+)$/.exec(e))s=$(),n=this._pseudoViewMap,(e=r[1])in n&&t.utils.each(o=n[e].views,function(t,e){s=s.add(t=t instanceof $?t:$("["+t+"]")),o[e]=t});else if(e instanceof $||t.isElement(e))s=$(e);else if(e instanceof t.Template){var l=e.id,d=$();for(o=t.utils.filter(this._viewMap,function(t){return t.name===l&&!t._destroyed});o.length;)d=d.add(o.pop().getViewFragment());s=d}else s=$(),(i=this._getRootElement(i?$(i):void 0)).each(function(t,i){(i=$(i)).is(e)&&(s=s.add(i)),s=s.add(i.find(e))}),a||t.utils.forEach(this._pseudoViewMap,function(n){var o,r,a=n.views||[];for(r=0;r<a.length;r++)o=a[r],o=o instanceof $?o:$("["+o+"]"),i[0]==o[0]||t.utils.contains(i,o)||(s=s.add(this.find(e,o,"__pseudo__"))),a[r]=o},this);return s},i.prototype.click=function(){return this},i.prototype.isReady=function(){return!!this._readied},i.prototype.isFetching=function(){return!!this._fetching},i.prototype.isFetched=function(){return!!this._fetched},i.prototype.isRendered=function(){return!!this._view.rendered},i.prototype.isDestroyed=function(){return!!this._destroyed},i.prototype.isInitialized=function(){return!!this._initialized},i.prototype.findViews=function(e,i){var s,n,o,r=[];if(!(e=t.utils.trim(e)))return r;e instanceof t.Template&&(n=e.id);for(o in this._viewMap)if(s=this._viewMap[o],n)s.name===n&&r.push(s);else{if(o===e){r.push(s);break}i&&s.hasModel(i,e)&&r.push(s)}return r},i.prototype.getPrevState=function(e){var i=this._oldState&&this._getState(e,this._oldState);return this.preventStateClone?i:t.utils.copy(i)},i.prototype.getState=function(e,i){var s=this._state&&this._getState(e);return i||this.preventStateClone?s:t.utils.copy(s)},i.prototype.setState=function(e,i,s){if(!this._view||void 0==e)return this;this._stateChangeTrack++||(this._oldState=this.preventStateClone?t.utils.extend({},this._state):t.utils.copy(this._state));var n,o,r;for(t.isObject(e)?(n=e,s=i===!0):(n={},n[e]=i,s=s===!0),r=t.utils.keys(n);e=r.pop();)if(o=this._getState(e),this._setState(e,i=this.preventStateClone?n[e]:t.utils.copy(n[e])),1===this._stateTrackMap[e]&&(s||!t.isEqual(o,i)))try{this.emit(this._uuid+"_"+e+"Change",i,o)}catch(a){throw this._stateChangeTrack=0,this._state=this._oldState,a}return--this._stateChangeTrack||this._repaint(this._state,this._oldState,s),this},i.prototype.updateState=function(e,i){return this._setState(e,this.preventStateClone?i:t.utils.copy(i)),this},i.prototype.replaceNodeElement=function(e,i){if(!e||!i)return $();var s,n,o,r,a;if(t.isString(e)?((n=document.createElement("div")).innerHTML=t.utils.trim(e),e=n.hasChildNodes()?t.utils.map(n.childNodes,function(t){return t}):[]):e=e instanceof $?e.get():t.isElement(e)||t.isTextNode(e)?[e]:[],!e.length)return $(i);if(i=i instanceof $?i.get():t.isElement(i)||t.isTextNode(i)?[i]:[],!i.length||i[0]===e[0])return $(e);if(i.length>1)for(a=0,r=i.length;a<r;a++)if(!o&&(o=i[a].parentNode),i[a].parentNode!==o){i=[i[0]];break}if(e.length>1)for(s=document.createDocumentFragment(),a=0,r=e.length;a<r;a++)s.appendChild(e[a]);else s=e[0];if(o=i[0].parentNode,i.length>1)for(a=1,r=i.length;a<r;a++)o.removeChild(i[a]);return o.replaceChild(s,i[0]),$(e)},i.prototype.makeNodeElement=function(e){if(e)if(t.isString(e)){var i=document.createElement("div");i.innerHTML=t.utils.trim(e),e=$(i.hasChildNodes()?t.utils.map(i.childNodes,function(t){return t}):void 0)}else e=$(e);else e=$();return e},i.prototype.appendChildComponents=function(t){return this.setChildComponents(t)._setChildComponents(t)},i.prototype.setChildComponents=function(e){var s=e;return t.isArray(e)||(s=[e]),t.utils.each([this.childComponents,this._childComponents],function(e){t.utils.each(s,function(s){s instanceof i&&!t.utils.some(e,s)&&e.push(s),e===this._childComponents&&s.once("onAfterDestroy",t.bind(this.removeChildComponents,this))},this)},this),this},i.prototype.removeChildComponents=function(e){var i=e;return t.isArray(e)||(i=[e]),t.utils.each([this.childComponents,this._childComponents],function(e){t.utils.each(i,function(i){t.utils.remove(e,i),e===this._childComponents&&i.emit("onAfterRemoveFromParent",this)},this)},this),this},i.prototype._setChildComponents=function(e){t.isArray(e)||(e=[e]);for(var s,n=this._childViews,o=[],r=0;s=e[r];r++)s instanceof i&&!t.utils.some(n,s)&&(n.push(s),s._fetched||o.push(new t.Promise(t.bind(function(e,i){e.once("onAfterFetch",i).once("onAfterRemoveFromParent",t.bind(function(t){t===this&&i()},this))},this,s))));return o.length?(this._resolved=!1,this.pause(),t.Promise.all(o).then(t.bind(function(){this._resolved=!0,this._resolving=!1,this.resume()},this))):(this._resolved=!0,this.resume()),this},i.prototype._fetch=function(){var e,i,s=this.options,n=s.url,o=s.storageType||"url";if(n&&s.dataSharing&&t.isString(n)){var r=this._name+"DataSharingStore";e=t.get(r,"COMPONENT"),e||t.put(r,e={},"COMPONENT");var a;(a=e[i=o+":"+n])&&this.setModel(a)}var l=this._initStoreOptions();this._store?t.utils.extend(l,this._store.getOptions()):this._store=this.model=new t.Store,e&&(e[i]=this._store),this._fetching=!0,this._store.on("change",t.bind(this._initRender,this)).on("loadError",t.bind(this.emit,this,"onLoadError")).on("loadSuccess",t.bind(this.emit,this,"onLoadSuccess")).on("fetched",t.bind(function(t){return this.isDestroyed()?this:(this._fetching=!1,this._fetched=!0,this.afterFetch(t,this.options),void(this.isPaused()?this._execAfterResumed(this.emit,"onAfterFetch",t):this.emit("onAfterFetch",t)))},this)).fetch(l),t.isObject(l.ajaxSetup)&&delete l.ajaxSetup.data},i.prototype._initStoreOptions=function(){var e=this.options;return{params:e.params,src:e.url,type:e.storageType||"url",data:t.utils.copy(e.data),dataKey:e.dataKey,contentType:e.contentType,dataType:e.dataType,queryNamesMap:e.queryNamesMap,fields:e.fields,ajaxSetup:e.ajaxSetup,dataFilter:e.dataFilter||t.bind(this.dataFilter,this)}},i.prototype._initRender=function(){if(this.isDestroyed())return this;var e=this._getRootElement();if(!e.length||t.utils.isDisconnected(e))return this._oldState=this._state,t.utils.extend(this._viewModel,this._state=t.utils.copy(this.initState(this._store.data||{},this.options))),void(this._readied||(this.isPaused()||this._lifeCycle.shift(),this._visibility="hidden",this._execReady()));if(this._children.length&&!this._resolved)return void(this._resolving||(this._execAfterResumed(this._initRender),this._resolving=!0));var i=this.initState(this._store.data||{},this.options);if(!t.isObject(i))throw"The method 'initState' must return a '{}' object who contains a lot of state property.";return this._view.rendered?void this.repaint(i):(this._oldState=this._state,this._state=t.utils.copy(i),this.emit("onBeforeRender"),this.beforeRender(this.options),void(this.isPaused()?this._execAfterResumed(this._execRender):this._execRender()))},i.prototype._initView=function(){var t=this.constructor.template||this.template;t=this.template=this.makeTemplate(t,"template",this._uuid),this._view=new o({superComponent:this,_pid:null,name:"template",uuid:this._uuid,template:t,pseudo:this._pseudoViewMap,eventsMap:this._dispatchViewEventMap}),this._viewMap[this._uuid]=this._view},i.prototype._repaint=function(e,i,s){return!s&&t.isEqual(e,i)||(this.emit("onBeforeRender"),s&&(this._view.rendered=!1),this.beforeRender(this.options),this.isPaused()?this._execAfterResumed(this._execRepaint,e):this._execRepaint(e)),this},i.prototype.getPseudoElement=function(e){return e in this._pseudoViewMap?this.find("::"+t.utils.trim(e)):$()},i.prototype.getPseudoSlotKey=function(e){var i=this._pseudoViewMap,s=i[e]=i[e]||{slotKey:t.utils.uuid(12).toLowerCase()};return s.slotKey},i.prototype.isPseudoElement=function(e,i){var s=!1;return!t.isEmpty(i=t.utils.trim(i))&&(e=this.find(e)).length&&(s=e.data("pseudo-slot")===this.getPseudoSlotKey(i)),s},i.prototype._getEventObjects=function(e,i,s,n){for(var o,r=e,a=[],l=0;l<r.length;l++)(o=r[l])&&o.eventName===i&&t.isEqual(s,o.selector)&&(t.isFunction(n)?o.original===n&&a.push(o):a.push(o));return a},i.prototype._bindLiveEvents=function(){var e,i,s,n,o=this._boundDelegateEvents,r=this._el;if(r.length&&(this._boundDelegateEvents=null,this._globalDelegateEvents=[],this._elementEvents=[],this._pseudoEvents=[],t.utils.each(o,function(t){t&&this.bind(t.eventName,t.selector,t.data,t.original)},this),!this._hasBoundInitEvents)){if(o=this.constructor.events||this.events,t.isObject(o))for(s=t.utils.keys(o);n=t.utils.trim(s.pop());)if(i=/(['"])([\w\s]+)\1\s+(.+)|(\w+)\s+(.+)/.exec(n)){if(e=o[n],t.isBasicType(e)&&t.isFunction(this[e])&&(e=this[e]),!t.isFunction(e))throw'\nThe value of property "'+n+'" is not a function in events object within '+this._name+" for binding.";this.bind(i[2]||i[4],i[3]||i[5],t.bind(function(e){return this.isPaused()?void t.print("Paused","warn"):e.apply(this,t.utils.argsToArray(arguments,1))},this,e))}this._hasBoundInitEvents=!0}o=null},i.prototype._delegateSpecialEvent=function(e,i,s){var n=this._globalDelegateEvents,o=!1;switch(e){case"propertychange":t.isIE&&document.body.attachEvent&&(this._registerDelegate(e,i,t.bind(function(e,i){if("value"===i.propertyName)return e.apply(this,t.utils.argsToArray(arguments,1))},this,s),s,!0),o=!0);break;case"scroll":this._registerDelegate(e,i,s),o=!0}return o&&this._elementEvents.push(n[n.length-1]),o},i.prototype._unDelegateSpecialEvent=function(e,i,s){switch(e){case"propertychange":if(t.isIE)return this._unRegisterDelegate(e,i,s,!0),!0;case"scroll":return this._unRegisterDelegate(e,i,s),!0;default:return!1}},i.prototype._registerPseudoDelegate=function(t,e,i,s,n){if(!this._delegateSpecialEvent(e,{selector:i,context:t},s)){var o=this._globalDelegateEvents;this._registerDelegate(e,i,s,n,!1,t),this._pseudoEvents.push(o[o.length-1])}},i.prototype._unRegisterPseudoDelegate=function(t,e,i,s,n){this._unDelegateSpecialEvent(e,{selector:i,context:t},s)||this._unRegisterDelegate(e,i,n,!1,t)},i.prototype._registerDelegate=function(e,i,s,n,o,r){var a=r?null:"body"===i?document.body:"document"===i?window.document:"window"===i?window:null,l=t.isObject(i)?this.getPseudoElement(i.context):null;a=r?this.getPseudoElement(r):null===a?this.find(l?i.selector:i,l):$(a),n=n||s,o?(a=a[0])?a.attachEvent("on"+e,s):s=n=e=null:r&&i&&!a.is(i)?a.delegate(i,e,s):a.bind(e,s),this._globalDelegateEvents.push({listener:s,original:n,eventName:e,selector:i,attach:!!o,delegate:r,target:a})},i.prototype._unRegisterDelegate=function(e,i,s,n,o){var r=this._globalDelegateEvents;t.utils.each(this._getEventObjects(r,e,i,s),function(s){var a=o?null:"body"==(i=s.selector)?document.body:"document"==i?window.document:"window"==i?window:null,l=s.listener,d=t.isObject(i)?this.getPseudoElement(i.context):null;a=o?this.getPseudoElement(o):null===a?this.find(d?i.selector:i,d):$(a),n?(a=a[0])&&a.detachEvent("on"+e,l):o&&i&&!a.is(i)?a.undelegate(i,e,l):a.unbind(e,l),t.utils.remove(r,s),t.utils.remove(this._elementEvents,s),t.utils.remove(this._pseudoEvents,s)},this)},i.prototype._getEventSource=function(e){var i=null;if("click"===e.type){var s,n=e.originalEvent||e,o=$(e.target||e.srcElement),r=o[0];n.srcComponent?i=n.srcComponent:(this._uuid===o.attr("eventsrccomponentuuid")?i=this:(s=this._getRootElement()[0])&&(s===r||$.contains(s,r)?i=this:t.utils.forEach(this._pseudoViewMap,function(e,n){if((s=this.getPseudoElement(n))&&(s[0]===r||t.utils.contains(s,r)))return i=this,!1},this),i&&o.attr("eventsrccomponentuuid",this._uuid)),n.srcComponent=i)}return i},i.prototype._getEventSourceHandler=function(t){return function(){var e=arguments[arguments.length-1];return e.srcComponent=this._getEventSource(e),t.apply(this,arguments)}},i.prototype._unbindLiveEvents=function(e,i){e&&e.length&&e.unbind().undelegate(),t.utils.each(i||this._globalDelegateEvents,function(t){t&&this._unRegisterDelegate(t.eventName,t.selector,t.original,t.attach,t.delegate)},this)},i.prototype._getState=function(t,e){var i=this._convertStatus(t);if(e=e||this._state,i=="['"+t+"']")return e[t];try{return new Function("state","return state"+i+";")(e)}catch(s){throw'Can not get the property value by the name of "'+i+'".'}},i.prototype._setState=function(t,e){var i=this._convertStatus(t);if(i=="['"+t+"']")this._state[t]=e;else try{new Function("state","value","state"+i+"=value;")(this._state,e)}catch(s){throw'Can not set the property value by the name of "'+i+'".'}},i.prototype._convertStatus=function(t){return t.replace(/(?:(['"])[^.\]]*\..*?\1)|\s*?\.\s*([a-zA-Z_$][a-zA-Z_$\d]*)\s*/g,function(t,e,i){return e?t:"['"+i.replace(/('|\\)/g,"\\$1")+"']"}).replace(/(['"]).*\1|\s+/g,function(t,e){return e?t:""}).replace(/^([^\[]+)/,"['$1']")},i.prototype.makeTemplate=function(e,i,s,n){if(void 0==e&&(e=" "),t.isArray(e)&&(e=e.join("\n")),t.isString(e)){var o=this.constructor,r=o.tplOpenTag||"{{",a=o.tplCloseTag||"}}";e=new t.Template(t.utils.extend({openTag:r,closeTag:a,id:i+"",name:this._name+" "+i,source:e,filters:this.constructor.filters||this.filters,filterContext:this,insert:n||t.bind(this._makeDispatcher,this,t.isString(s)?s:""),include:t.isFunction(s)?t.bind(s,this):s&&this._makeImporter(s),context:this},i)),e.viewId=t.isString(s)?s:void 0}return e},i.prototype._makeDispatcher=function(e,i){var s=t.utils.uuid(8);if(t.isFunction(i))this[s]=i,i=s;else if(!t.isFunction(this[i]))throw"'"+i+"' is not a function belong to '"+this._name+"'.";var n,o,r=t.utils.argsToArray(arguments,2),a="&#x27;";return t.put(this._uuid,this,"COMPONENT"),t.put(s,{uuid:this._uuid,method:i,params:r},"EVENTS"),o=(n=this._dispatchViewEventMap)[e]||[],o.push(s),n[e]=o,"utry("+a+s+a+",event"+(t.utils.some(r,"this")?",this":"")+")"},i.prototype._stringifyArgs=function(t,e){for(var i,s=0,n=t.length,o="";s<n;s++)s>0&&(o+=","),o+=/(this(?:\s*\.?\s*\w+)*)/.test(i=t[s])?i:"string"==typeof i||i instanceof Object?e+i+e:i+"";return o},i.prototype._makeImporter=function(e){return t.bind(function(e,s,n,r,a){var l=this.constructor,d=l[s]||this[s];if(!d)throw"Not found template '"+s+"'.";var h,u=this._viewMap[e.pid],c=this._viewMap[e[r]];this[s]instanceof t.Template?d=this[s]:!c||this[s]instanceof i||(t.utils.forEach(e,function(t,i,s){(+i||-1)>=r&&(s=this._viewMap[t])&&(s.destroyed=!0,delete e[i])},this),c=null),c&&!c.destroyed?((d instanceof i||c._component instanceof i)&&(n=t.utils.objectInherits(n,c._viewModel)),d=null):t.isString(d)||t.isArray(d)?(t.isArray(d)&&(d=d.join("\n")),/^\s*<([A-Z_\d][^\s{}$<%@=]*)([^>]+)\/>\s*$/.test(d)&&(c=this._makeSubComponent(RegExp.$1,RegExp.$2,n,u)),c?(h=c.uuid,n=t.utils.objectInherits(n,c._viewModel)):this[s]=d=this.makeTemplate(d,s,h=t.utils.uuid(12))):d instanceof t.Template?(h=t.utils.uuid(12),d=d.clone({filters:l.filters||this.filters,filterContext:this,insert:t.bind(this._makeDispatcher,this,h),include:this._makeImporter(h)})):d instanceof i&&(c=this._includeSubComponent(d,u),h=c.uuid,n=t.utils.objectInherits(n,c._viewModel)),d instanceof t.Template&&(c=new o({superComponent:this,pid:e.pid,uuid:h,name:s,parent:u,template:d,pseudo:this._pseudoViewMap,eventsMap:this._dispatchViewEventMap})),t.isObject(n)&&n!==this._viewModel&&(n=t.utils.objectInherits(n,this._viewModel)),d&&(u.childViews.push(c),(c.xPath=u.xPath.concat()).push(r),this._viewMap[h]=c,e[r]=h),a||(c.rendered=!1,c.element=$());var p,f=this._importPath;return f?(p=c.xPath,t.utils.startsWith(p,f)?void 0===(c=c.render(n))?"":c:void(t.utils.startsWith(f,p)&&c.template.execLogic(n))):void 0===(c=c.render(n))?"":c},this,{pid:e})},i.prototype._includeSubComponent=function(e,i,s){var n=e;return e=t.utils.objectInherits({},e),e.destroy=null,e.uuid=s||t.utils.uuid(12),e._pid=i.uuid,e.parent=i,e.parentComponent=this,e._view.rendered=!1,e._view.element=$(),e._component=n,t.isFunction(e.hasModel)||(e.hasModel=t.voidFunc),this.once("onAfterRender",t.bind(function(t){var e=t._view,i=t._component;e.resetContext(t.parentComponent._view),i._unbindLiveEvents(i._el),i._el=i.options.el=e.getViewFragment(),i._setBrowserAgentPrefix(i._el),i._bindLiveEvents(),i.afterRender(i.options),i.emit("onAfterRender")},this,e)),e},i.prototype._makeSubComponent=function(e,s,n,o){var r,a,l;if(t.isFunction(r=t[e])&&r.prototype instanceof i)return l=t.utils.uuid(12),a=new r(t.utils.extend(this._parseProps(s,t.utils.objectInherits(n,this._viewModel),l,r)),{uuid:l,pseudo:this._pseudoViewMap}),r=this._includeSubComponent(a,o,l),delete r.destroy,t.put(l,a,"COMPONENT"),r},i.prototype._parseProps=function(e,i,s,n){var o,r=this,a={},l=this.makeTemplate(e,"#props",null,function(e){if(t.isFunction(r[e])){var i,n=t.utils.uuid(12);return t.put(r._uuid,r,"COMPONENT"),a[n]="with(utry.get('"+s+"','COMPONENT')){var slice=Array.prototype.slice,args=slice.call(arguments),self=utry.get('"+r._uuid+"', 'COMPONENT');self."+e+".apply(self,(function(array){return slice.call(arguments, 1).concat(array);}(args"+(""===(i=r._stringifyArgs(t.utils.argsToArray(arguments,1),"'"))?"":","+i)+")));}",n}throw"'"+e+"' is not a function belong to '"+r._name+"'."}).compile(e);if(l)return o={},l(i).replace(/(\w+)\s*=\s*(['"])(.*?)\2/g,function(e,i,s,n){return t.utils.some(a,function(t,e){return n===e})?(o[i]=new Function(a[n]),/on(\w+)/.test(i)&&(o["on"+t.utils.capitalize(RegExp.$1)]=o[i])):o[i]=n,""}).replace(/\b\w+\b/g,function(t){o[t]=t}),o;throw'Can not resolve the props by "'+n+'" as a result of template error.'},i.prototype._execInit=function(){var e,s=this.options,n=t.utils.trim(s.id),o=s.el;this._lifeCycle.shift(),o=$(o),o.length||void 0!=s.el||t.isEmpty(n)||(o=$("#"+n)),s.el=o,e=this.init(s);var r,a,l=[],d=this.constructor;for(r in d)d.hasOwnProperty(r)&&(r=d[r])instanceof i&&l.push(r);for(a=t.utils.keys(this);r=a.pop();)(r=this[r])!==this._super&&r instanceof i&&l.push(r);return l.length&&this._setChildComponents(l),e instanceof i?e:(s=t.utils.object(this.options),this._el=s.el=$(s.el),this.emit("onAfterInit",s),void(this.isPaused()?this._execAfterResumed(this._execInitView):this._execInitView()))},i.prototype._execInitView=function(){this._initView(),this._initialized=!0,this.afterInit(this.options),this.emit("onBeforeFetch",this.options),this.beforeFetch(this.options),this.isPaused()?this._execAfterResumed(this._execFetch):this._execFetch()},i.prototype._execFetch=function(){this._lifeCycle.shift(),this._fetch();var e=this.constructor.initRenderDelay;(e=Number(void 0==e?this.initRenderDelay:e))?setTimeout(t.bind(function(){this._destroyed||this._view.rendered||this._initRender()},this),e):this._destroyed||this._view.rendered||!this._getRootElement().length||this._initRender()},i.prototype._execRender=function(){this._lifeCycle.shift(),this._execReplace(this.render(t.utils.extend(this._viewModel,this._state),this._getRootElement(),this.options)),this.emit("onAfterRender"),this.isPaused()?this._execAfterResumed(this._execReady):this._execReady()},i.prototype._execReady=function(){this._readied||(this.emit("onBeforeReady"),this.isPaused()?this._execAfterResumed(this._execBindEvent):this._execBindEvent())},i.prototype._execBindEvent=function(){this._lifeCycle.shift(),this._readied=!0,this.ready(this.options),this.emit("onAfterReady")},i.prototype._execRepaint=function(e){try{this._execReplace(this.render(t.utils.extend(this._viewModel,e),this._getRootElement(),this.options)),this.emit("onAfterRender"),this.isPaused()?this._execAfterResumed(this._execReady):this._execReady()}catch(i){throw i}finally{this._clearDestroyedViews()}},i.prototype._clearDestroyedViews=function(){for(var e,i,s,n,o=this._viewMap,r=t.utils.keys(o),a=this._dispatchViewEventMap;e=r.pop();)if((i=o[e]).destroyed){if(s=a[i.uuid]){for(;n=s.pop();)t.remove(n,"EVENTS"),this[n]&&delete this[n];delete a[i.uuid]}t.isFunction(i.destroy)?i.destroy():t.isFunction(i.getViewFragment)&&(i.getViewFragment().remove(),i.superComponent=i.root=i.element=i.template=null),o[e]=null,delete o[e]}},i.prototype._execReplace=function(e){var i,s,n=this.options,o=this._el,r=this._view,a=this._getRootElement(),l=t.utils.trim(n["class"])||"";a.length?(e?a.is("body")?(a.append(this.makeNodeElement(e)),a=this._el=n.el=this._getRootElement()):a=this._el=n.el=this.replaceNodeElement(e,a):this._el=n.el=a,(a.is("body")||!a.length||t.utils.isDisconnected(a))&&(a=this._el=n.el=r.getViewFragment()),(r.rendered=!!a.length)&&a.attr(r.slotKey,""),this._el.addClass(t.utils.trim(l.replace(/\s*utry-[^\s]+/g," "))),this._setBrowserAgentPrefix(this._el),this._el.is(o)?(i=this._elementEvents.concat(this._pseudoEvents)).length&&(s=this._globalDelegateEvents,t.utils.each(i,function(e){e&&t.utils.isDisconnected(e.target)&&(this._unRegisterDelegate(e.eventName,e.selector,e.original,e.attach,e.delegate),this._registerDelegate(e.eventName,e.selector,e.listener,e.original,e.attach,e.delegate),(e.delegate?this._pseudoEvents:this._elementEvents).push(s[s.length-1]))},this),i=null):(this.emit("onComponentRemount"),this._unbindLiveEvents(o),this._bindLiveEvents()),this._setVisibility()):r.rendered=!1,this.afterRender(this.options)},i.prototype._setBrowserAgentPrefix=function(e){var i="";return t.isIE?i+=" ut-ie ut-ie"+t.browserVersion:t.isFirefox?i+=" ut-firefox ut-mozilla":t.isSafari?i+=" ut-safari":t.isChrome?i+=" ut-chrome":t.isOpera&&(i+=" ut-opera"),i&&(e||this._getRootElement()).addClass(i),this},i.prototype._execDisplay=function(e,s,n,o){var r,a,l=this,d=s.toLowerCase(),h=("show"==d?"remove":"add")+"Class",u=this.isHidden(),c=[];for(t.isArray(e)?c=e:c.push(e||this.template),n=t.isString(n)&&(n=t.utils.trim(n))?/^ut-am-/.test(n)?n:"ut-am-"+n:"";r=c.pop();)r instanceof i?r[d](null,n,o):(r=this.find(r),r.each(function(e,i){i.className=i.className.replace(/\s*ut-am-[^\s]+/gi," ");var s=$(i);n?(s.addClass(n),"show"===d?s.hasClass("ut-hidden")||(a="none"==s.css("display"))?(s.removeClass("ut-hidden"),(a||"none"==s.css("display"))&&s.css("display",""),t.isFunction(o)&&(t.utils.addAnimationEndListener(s,t.bind(function(e){t.utils.removeAnimationEndListener(e),o.call(this,e)},l,s))||o.call(l,s))):t.isFunction(o)&&o.call(l,s):s.hasClass("ut-hidden")||"none"==s.css("display")?t.isFunction(o)&&o.call(l,s):t.utils.addAnimationEndListener(s,t.bind(function(e){t.utils.removeAnimationEndListener(e).addClass("ut-hidden"),t.isFunction(o)&&o.call(this,e)},l,s))||(s.addClass("ut-hidden"),t.isFunction(o)&&o.call(l,s))):(s[h]("ut-hidden"),"show"==d&&"none"==s.css("display")&&s.css("display",""),t.isFunction(o)&&o.call(l,s))}));this._setVisibility(),s=!this.isHidden(),u||s?u&&s&&this.emit("onAfterShow"):this.emit("onAfterHide")},i.prototype._execReload=function(e){this._fetching=!0,this._fetched=!1,this._store.once("fetched",t.bind(function(t,i){var s=e.onSuccess||e.onsuccess,n=e.onError||e.onerror;i?s&&s.call(this,t):n&&n.call(this,t),this.emit("onAfterUpdate",i,t)},this)).reload({params:e.params,src:e.url,data:t.utils.copy(e.data),contentType:e.contentType,dataType:e.dataType,queryNamesMap:e.queryNamesMap,type:e.storageType,ajaxSetup:e.ajaxSetup,preserveData:!!e.preserveData})},i.prototype._execDestroy=function(){var e=this._el;e&&(this._unbindLiveEvents(e),e.is(document.body)||e.remove()),t.utils.forEach(this._pseudoViewMap,function(t,e){this.getPseudoElement(e).remove()},this),t.utils.each(this._childComponents,function(e){try{e.destroy()}catch(i){t.print(i,"error")}}),t.remove(this._uuid,"COMPONENT"),t.remove(this.id,"COMPONENT"),t.utils.forEach(this._dispatchViewEventMap,function(e){if(e&&e.length)for(var i=0;i<e.length;i++)t.remove(e[i],"EVENTS")}),this._store&&(this._store._destroyed=!0),t.utils.forEach(this,function(t,e){"_events"!==e&&(this[e]=null)}),this.destroyed=this._destroyed=!0,this.emit("onAfterDestroy",this),this.off()},i.prototype._getRootElement=function(e){var i=e?e:this._view.getViewFragment(),s=t.utils.isDisconnected;return i&&i.length&&!s(i)||(i=this._el)&&i.length&&!s(i)||(i=this.options.el)&&i.length&&!s(i)||(i=$()),i},i.prototype.getRootElement=function(){return this._getRootElement()},i.prototype._setVisibility=function(){var t=this._view;this._visibility=!t||t.isHidden()?"hidden":"visible"},i.prototype._execAfterResumed=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.once("_resumed",function(){t.apply(this,e)})},i.dispatch=function(e){var i=e.uuid,s=i?t.get(i,"COMPONENT"):null,n=t.utils.getEventObject(e.event),o=e.method;if(s){if(s.isPaused())return void t.print("Paused","warn");n.srcComponent=s._getEventSource(n),o=s[o]}else t.isFunction(o)?s=e.context:o=(s=window)[o];return t.isFunction(o)?o.apply(s,t.utils.map(e.params,function(t){return"this"===t?e.currentTarget:t}).concat(n,e.currentTarget)):void t.print("unresolved function or method "+e.method+"().","error")},i.tplOpenTag="{{",i.tplCloseTag="}}",i.UUID=t.utils.uuid(12).toLowerCase(),i}(t.EventEmitter);t.Component=n;var o=function(){function e(e){e=t.utils.extend({},e),this._pid=e.pid||null,this.uuid=e.uuid||t.utils.uuid(12),this.element=e.element||$(),this.template=e.template||null,this.name=e.name,this.xPath=e.xPath||[],this.parent=e.parent||$(),this.slotKey=e.slotKey||t.utils.uuid(12).toLowerCase(),this.childViews=[],this.superComponent=e.superComponent,this.root=$(),this.model={},this.pseudo=e.pseudo||{},this.pseudoName=e.pseudoName,this.eventsMap=e.eventsMap||{}}return e.prototype.find=function(t){var e=this.getViewFragment();return(e.is(t)?e:$()).add(e.find(t))},e.prototype.hasModel=function(t,e){return!!t&&this.model[t]===e},e.prototype.show=function(){this.getViewFragment().removeClass("ut-hidden")},e.prototype.hide=function(){this.getViewFragment().addClass("ut-hidden")},e.prototype.isHidden=function(){var t=this.getViewFragment();return t.hasClass("ut-hidden")||"none"===t.css("display")},e.prototype.render=function(e){if(this.rendered)this.repaint(e);else{for(var i,s=this.eventsMap[this.uuid]||[],n=this.superComponent;i=s.pop();)t.remove(i,"EVENTS"),n&&n[i]&&delete n[i];this.clearChildViews();var o=this.setViewSlot(this.template.render(e));if(this.model=this.collectModel(e),this.rendered=!0,!this.element.length)return o;this.element=this.root=$(o).replaceAll(this.element)}},e.prototype.repaint=function(e){var i=this.model;t.isEqual(i,this.model=this.collectModel(e))?this.template.execLogic(e):(this.element=this.getViewFragment()).length?(this.rendered=!1,this.render(e)):this.template.execLogic(e)},e.prototype.resetContext=function(t){this.root=[],this.parent=t,this.getViewFragment(t),this.root.length&&(this.rendered=!0)},e.prototype.setViewSlot=function(e){if(this.template.htmlText){var i=t.bind(this.getPseudoSlotKey,this);e=t.utils.trim(e).replace(/^(<[A-Z][A-Z0-9]*)/i,"$1 "+this.slotKey+" ").replace(/<[A-Za-z][A-Za-z0-9]*\b.*?\b(?:data-pseudo\s*=\s*('|")\s*[^\s]+\s*\1)[^>]*>/g,function(t){return t.replace(/data-pseudo\s*=\s*('|")\s*(\w+)\s*\1/g,i)})}return e},e.prototype.getPseudoSlotKey=function(){var i=this.pseudo,s=arguments[2],n=t.utils.uuid(12).toLowerCase(),o=i[s]=i[s]||{slotKey:t.utils.uuid(12).toLowerCase()},r=o.views=o.views||[];return r.push(n),this.childViews.push(new e({slotKey:n,pseudoName:s,parent:this})),n+" data-pseudo-slot='"+o.slotKey+"'"},e.prototype.getViewFragment=function(i){var s,n=this.root;return n&&n.length&&!t.utils.isDisconnected(n)||(s=i||this.parent,s instanceof e&&s.root&&s.root.length||(s=$("body")),n=s.find("["+this.slotKey+"]")),this.root=n},e.prototype.clearChildViews=function(){for(var e,i=this.childViews,s=this.pseudo,n=function(e){var i,n,o;e.destroyed=!0,(i=e.pseudoName)&&(n=e.slotKey,o=e.parent.root||[],t.utils.remove(s[i].views,function(t){if((t===n||t instanceof $&&void 0!==t.attr(n))&&(t=t instanceof $?t:$("["+n+"]")).length)return t[0]!==o[0]&&t.remove(),!0}))};e=i.pop();)t.utils.treeWalker(e,n,!1,"childViews")},e.prototype.collectModel=function(e){void 0==e&&(e={});for(var i,s,n=t.utils.keys(this.template.getVariables()),o={};i=n.pop();)/^(.+)@length$/.test(i)?(i=RegExp.$1,o[i]=(s=e[i])&&s.length):o[i]=e[i];return o},e}();t.init=e,t.define=i,t.create=s}(utry||(utry={}));var utry;!function(t){function e(i,s){function n(i,s){t.isString(i)&&e.registerRule(i,s)}return n.prototype=e,new n(i,s)}function i(t,i){e.registerRule(t,i)}t.Validator=e;var e;!function(e){function i(e){var i=e.name=t.utils.trim(e.name);return!s(i)&&t.isFunction(e.handler)&&n(e.name=i+"#"+t.utils.uuid(6),function(t,e,i){var s=this.handler(t,e);i(s,s?"":this.message)}),e=new r(e)}function s(e){var i=null;return e=e.toLowerCase(),t.utils.forEach(r.prototype,function(t,s){if(e===s.toLowerCase())return i=t,!1}),i}function n(e,i){(e=t.utils.trim(e))&&t.isString(e)?s(e)?t.print('Rule of "'+e+'" has been used.',"error"):t.isFunction(i)?r.prototype[e]=i:t.print("The handler of rule must be a function.","error"):t.print("The first argument must be a valid string value.","error")}function o(i,n,o){function a(t){for(var l,d;n.length&&(!((l=n.shift())instanceof r)||l.exclude||!(d=s(l.name)));)l=null;if(l)try{e.rule=l,d.call(l,i,l.value,function(t,i){(l.valid=!!t)?a(i):(o(!1,i,l),e.rules=[],e.rule=null)})}catch(h){throw e.rules=[],e.rule=null,h}else o(!0,t),e.rules=[],e.rule=null}if(!t.isFunction(o))throw"Arguments error.";t.isArray(n)||(n=[n]),t.isString(i)&&(i=t.utils.trim(i)),t.utils.each(n=n.concat(),function(t){t.exclude=!1,t.valid=void 0}),n.sort(function(t,e){return r.getPriority(e)-r.getPriority(t)}),e.rules=n,a()}e.makeRule=i,e.registerRule=n,e.validate=o,e.validator=e;var r=function(){function e(e){e=t.utils.extend({},e),this.name=t.utils.trim(e.name),this.message=t.utils.trim(e.message),this.handler=t.isFunction(e.handler)?e.handler:null,this.exclude=!!e.exclude,(this.value=t.utils.trim(e.value))!==this.name&&this.value!==!0&&"true"!==this.value||(this.value="");var i;isNaN(i=Number(e.priority))||(this.priority=i)}return e.getPriority=function(t){return t instanceof e?void 0!=t.priority?t.priority:e.Priority[t.name]||0:0},e.prototype.empty=function(t,e,i){i(!1,void 0!=t&&t+""?"":this.message||e||"请填写此字段。")},e.prototype.required=function(t,e,i){var s=void 0!=t&&!!(t+"");i(s,s?"":this.message||e||"请填写此字段。")},e.prototype.pattern=function(t,e,i){var s=void 0==t||!(t+"")||!(e+"")||new RegExp(e+"").test(t);
i(s,s?"":this.message||"请与所请求的格式保持一致。")},e.prototype.number=function(t,e,i){var s=void 0==t||!(t+"")||/^(?:[+-]?)\d+(?:\.\d+|)$/.test(t);i(s,s?"":this.message||e||"请输入有效的数值。")},e.prototype.digits=function(t,e,i){var s=void 0==t||!(t+"")||/^(?:[+-]?)\d+$/.test(t);i(s,s?"":this.message||e||"请输入有效的数字。")},e.prototype.equal=function(e,i,s){var n=t.utils.trim($(i).val()),o=!(void 0!=e&&e+""&&i+""&&n&&n!==e);s(o,o?"两次输入不一致。":this.message)},e.prototype.equalTo=function(e,i,s){var n,o,r;o=!(void 0!=e&&e+""&&(n=$(i)).length&&(r=t.utils.trim(n.val()))&&r!==e),s(o,o?"":this.message||"两次输入不相同。")},e.prototype.maxLength=function(t,e,i){var s=void 0==t||!(t+"")||!(e+"")||t.replace(/[^\x00-\xff]/g,"..").length<=(Number(e)||0);i(s,s?"":this.message||"最多可以输入"+e+"个字符。（一个汉字当作两个字符计算）")},e.prototype.minLength=function(t,e,i){var s=void 0==t||!(t+"")||!(e+"")||t.replace(/[^\x00-\xff]/g,"..").length>=(Number(e)||0);i(s,s?"":this.message||"最少要输入"+e+"个字符。（一个汉字当作两个字符计算）")},e.prototype.max=function(t,e,i){var s=void 0==t||!(t+"")||!(e+"")||Number(t)<=Number(e);i(s,s?"":this.message||"值必须小于或等于"+e+"。")},e.prototype.min=function(t,e,i){var s=void 0==t||!(t+"")||!(e+"")||Number(t)>=Number(e);i(s,s?"":this.message||"值必须大于或等于"+e+"。")},e.prototype.email=function(t,e,i){var s=void 0==t||!(t+"")||/^(?:\w+\.?)*\w+@(?:\w+\.)+\w+$/.test(t);i(s,s?"":this.message||e||"请输入有效的电子邮件地址。")},e.prototype.mobile=function(t,e,i){var s=void 0==t||!(t+"")||/^1\d{10}$/.test(t);i(s,s?"":this.message||e||"请输入有效的手机号码。")},e.prototype.date=function(t,e,i){var s=void 0==t||!(t+"")||/^(?:(?!0000)[0-9]{4}([-\/.]?)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-\/.]?)0?2\2(?:29))$/.test(t);i(s,s?"":this.message||e||"请输入有效的日期值。")},e.prototype.remote=function(e,i,s){var n=void 0==e||!(e+"");if(n&&(i=t.utils.trim(i)))s(!0,"");else{var o=this.message;$.ajax({url:i,cache:!1,context:this,success:function(t){n=!this.handler||this.handler(t)},error:function(e,i){t.print(new Error("Ajax error from remote validate.\n"+i),"error"),n=!1},complete:function(){s(n,n?"":o||"请修正此字段。")}})}},e.Priority={required:123456799,empty:123456789,pattern:123456,digits:12348,number:12347,mobile:12346,email:12345,url:12345,date:12345,accept:12345,maxlength:1234,minlength:1234,range:1234,max:123,min:123,equal:12,equalto:12,remote:-12},e}()}(e=t.Validator||(t.Validator={})),t.registerRule=i}(utry||(utry={}));var utry;!function(t){function e(e){var s=t.utils.extend({onComplete:t.voidFunc,enabled:!0,color:"#000",opacity:.6,zIndex:9999,topNoScroll:!1},e),n=!(e===!1||!s.enabled),r=s.onComplete,a=+s.zIndex||9999,l=String((n?0:arguments[1]||s.id)||t.utils.uuid(10)).toLowerCase();return e={id:l,zIndex:a,enabled:n,color:s.color,opacity:s.opacity,topNoScroll:s.topNoScroll},s.context==window?(e.paths=e.original=[],o.makeShadow(r,e)):i({enabled:!1,onChange:function(){var i=function(i){e.paths=e.original=i,t.postMessage(window.top,"__makeFullShadow",[e],r),s=r=e=null};n?t.postMessage(window,"getGlobalMessagePath",i):i([])}}),l}function i(e){var i,s;$.isPlainObject(e)?i=e.enabled!==!1:(i=e!==!1,e={target:e}),s=$(t.utils.trim(e.target)||window),$.extend(e,{target:s,enabled:i}),t.postMessage(window.top,"__toggleShadowResize",[!e.enabled],function(){o.launch(e),e=s=null})}function s(e){t.postMessage(window.top,"__isFullScreen",e)}function n(e){t.postMessage(window,"getGlobalMessagePath",function(i){t.postMessage(window.top,"__hasShadowMask",[i],e)})}var o;!function(e){function i(e,i){var s,n=document,o=n.documentElement;if(!(n.fullscreenEnabled||n.mozFullScreenEnabled||n.webkitFullscreenEnabled))return e();for(s in{requestFullscreen:1,mozRequestFullScreen:1,webkitRequestFullscreen:1,msRequestFullscreen:1}){if(o[s]){if(n.fullscreen||n.webkitIsFullScreen||n.mozFullScreen||null!==(n.fullscreenElement||n.webkitCurrentFullScreenElement||n.mozFullScreenElement||null))if(i)s=null;else for(s in{exitFullscreen:1,mozCancelFullScreen:1,webkitExitFullscreen:1}){if(n[s]){o=n;break}s=null}else i||(s=null);break}s=null}s?($(n).one("fullscreenchange webkitfullscreenchange mozfullscreenchange",function(){i&&$(n).one("fullscreenchange webkitfullscreenchange mozfullscreenchange",function(){t.fullscreen(!1)}),e()}),o!==n&&t.isChrome?o[s](Element.ALLOW_KEYBOARD_INPUT):o[s]()):e()}function s(i,o,a,l,d){l=l||{},p&&p!==i&&!t.isFunction(d)?s(function(){s(i,o,a,l)},!1,e.pathsArray,f,p):r(function(){var s=$(window);s.unbind("resize",n),o?(s.resize(n),p=i,e.pathsArray=a.slice(),f=l):p=e.pathsArray=f=null,t.isFunction(d)&&d(o),i(o)},o,a.slice(),l)}function n(){clearTimeout(m),m=setTimeout(o,30)}function o(){e.pathsArray&&r(function(){},!0,e.pathsArray.slice(),f)}function r(e,i,s,n,o){if(n=n||{},$("#"+c).remove(),i&&!o){$(a(null,n)).appendTo("body");var d=$(window);r(e,i,s,n,{width:d.width(),height:d.height()})}else{var h,u=s.shift(),p=u?$("["+u+"]"):$();i?$(a(o,n)).appendTo("body"):(g&&(h=$(document),h.scrollLeft(g.left),h.scrollTop(g.top),g=null),p.removeAttr(u),$(".h"+c).removeClass("h"+c)),p.length?(l(p,!!i,"w"+c),t.postMessage(p.get(0).contentWindow,"__setFullStyle",[i,s,n,o],e)):e(i)}}function a(t,e){var i,s,n=[],o="!important;";return g||(s=$(document),g={left:s.scrollLeft(),top:s.scrollTop()}),n.push("<style id='"+c+"' type='text/css'>"),n.push("html, body {"),n.push("\t width: 100%"+o),n.push("\t height: 100%"+o),n.push("\t margin: 0"+o),n.push("\t border: 0"+o),n.push("\t padding: 0"+o),n.push("\t overflow: hidden"+o),n.push("}"),t&&(i=(void 0==e.zIndex?0:parseInt(e.zIndex))||999999999,n.push(".p"+c+" {"),n.push("\t overflow: visible"+o),n.push("}"),n.push(".h"+c+" {"),n.push("\t display: none"+o),n.push("}"),n.push("."+c+" {"),n.push("\t position: fixed"+o),n.push("\t z-index: "+i+o),n.push("\t left: 0"+o),n.push("\t top: 0"+o),n.push("\t margin: 0"+o),n.push("\t width: "+t.width+"px"+o),n.push("\t height: "+t.height+"px"+o),n.push("\t -webkit-box-sizing: border-box"+o),n.push("\t -moz-box-sizing: border-box"+o),n.push("\t box-sizing: border-box"+o),n.push("}"),n.push(".w"+c+" {"),n.push("\t padding: 0"+o),n.push("}"),e.style&&n.push(e.style)),n.push("</style>"),n.join("\r\n")}function l(t,e,i){i&&t.toggleClass(i,e),t.toggleClass(c,e).parents().not("html,body").toggleClass("p"+c,e)}function d(t,i){$(window)[i&&(e.shadowList||[]).length?"bind":"unbind"]("resize",b),t&&t()}function h(i,s){var n,o,r,a,l,d,h,u,p,f,m,g,y,x,w=s.id,C=s.enabled,_=s.paths||[],k="shadow"+c,S="!important;",T=s.zIndex,E=s.opacity,L=[],I=$(document),M=$(document.body),N=parseFloat;if(C)t.utils.some(e.shadowList,w)||(s.original&&(v[w]=t.utils.copy(s),s.original=null,$(window).unbind("resize",b).bind("resize",b)),e.shadowList.push(w),$("."+k).addClass(k+"transparent"),$("<div>").addClass(k+" "+(k+w)).appendTo("body"),L.push("<style id='"+k+w+"' type='text/css'>"),L.push("."+(k+w)+" {"),L.push("\t position: fixed"+S),L.push("\t left: 0"+S),L.push("\t top: 0"+S),L.push("\t width: 4000px"+S),L.push("\t height: 4000px"+S),L.push("\t z-index: "+(T-1)+S),L.push("\t opacity: "+E+S),L.push("\t filter: alpha(opacity="+100*E+")"+S),L.push("\t background-color: "+s.color+S),L.push("}"),L.push("."+(k+"transparent")+" {"),L.push("\t opacity: 0"+S),L.push("\t filter: alpha(opacity=0)"+S),L.push("}"),s.topNoScroll||window.top!=window||L.push("html,body {\t overflow: hidden"+S+"}"),L.push("</style>")),h=_.shift(),(d=h?$("["+h+"]"):$()).length?(x=d.hasClass("sw"+c)?o=$("#"+(g=d.data("shadow-uuid-"+c))):d,n=x.offset(),r=(N(x.css("borderLeftWidth"))||0)+(N(M.css("borderLeftWidth"))||0),a=(N(x.css("borderTopWidth"))||0)+(N(M.css("borderTopWidth"))||0),r+=N(x.css("paddingLeft"))||0,a+=N(x.css("paddingTop"))||0,u=I.scrollLeft(),p=I.scrollTop(),f=x.width(),m=x.height(),o?(t.utils.some(l=o.data("shadow-list-"+c),w)||l.push(w),o=null):o=d.data("shadow-uuid-"+c,g=t.utils.uuid(10).toLowerCase()).clone(!1,!1).removeAttr("src").removeAttr("name").attr("id",g).removeAttr(h).addClass("is"+k).data("shadow-list-"+c,[w]),d.addClass(k+g+"win sw"+c),L.push("<style id='iw"+k+g+"' type='text/css'>"),L.push("."+(k+g+"win")+" {"),L.push("\t border: 0"+S),L.push("\t margin: 0"+S),L.push("\t padding: 0"+S),L.push("\t width: "+f+"px"+S),L.push("\t height: "+m+"px"+S),L.push("\t background-color: #fff"+S),s.topNoScroll&&window.top==window?(x.parentsUntil("body").each(function(){var t,e=$(this);if("static"!==e.css("position"))return t=e.offset(),n.left-=t.left,n.top-=t.top,!1}),L.push("\t position:absolute"+S)):(n.left-=u,n.top-=p,L.push("\t position:fixed"+S)),L.push("\t left: "+(n.left+r)+"px"+S),L.push("\t top: "+(n.top+a)+"px"+S),L.push("\t z-index: "+T+S),L.push("}"),L.push("</style>"),$("#iw"+k+g).remove(),t.postMessage(d.get(0).contentWindow,"__makeFullShadow",[s],i)):i&&i(C),$(L.join("\r\n")).appendTo("body"),o&&o.insertBefore(d);else{if(!t.utils.some(e.shadowList,w))return i&&i(C);$("."+k+w).remove(),$("#"+k+w).remove(),t.utils.remove(e.shadowList,w),_=(v[w]||{}).paths||_,delete v[w],$(".is"+k).each(function(){var i=$(this),s=i.data("shadow-list-"+c),n=this.id,o=$("."+k+n+"win");t.utils.remove(s,w),s.length&&o.length||(o.length?o.removeClass(k+n+"win").removeClass("sw"+c):t.utils.each(s,function(i){$("."+k+i).remove(),$("#"+k+i).remove(),t.utils.remove(e.shadowList,i)}),i.remove(),i=null,$("#iw"+k+n).remove())}),(y=e.shadowList.length)?$("."+(k+e.shadowList[y-1])).removeClass(k+"transparent"):$(window).unbind("resize",b),(h=_.shift())&&(d=$("["+h+"]")).length?(d.removeAttr(h),s.paths=_,t.postMessage(d.get(0).contentWindow,"__makeFullShadow",[s],i)):i&&i(C)}}function u(e){var i=e.target;t.postMessage(window,"getGlobalMessagePath",function(s){t.postMessage(window.top,"__toggleFullScreen",[e.enabled,s,{zIndex:e.zIndex,style:e.style}],function(s){return e?(s=!!s,l(i,s,e.fullClass),$.isFunction(e.onChange)&&e.onChange({element:i,enabled:s}),e.browser&&t.postMessage(window.top,"__requestFullScreen",[s]),void(s||(e=null))):void(i=null)},2)})}var c="nothingseeknothingfind";t.registerMessageListener("__requestFullScreen",i),t.registerMessageListener("__toggleFullScreen",s);var p=null;e.pathsArray=[];var f=null,m=-1,g=null;t.registerMessageListener("__setFullStyle",r),e.shadowList=[];var v={},y=0,b=t.utils.throttle(function(){y++;var i=(e.shadowList||[]).slice(),s=y,n=function(){var e;if(y>s)n=null;else{for(;(e=i.shift())&&!(e in v);)e=null;e?h(n,t.utils.copy(v[e])):n=null}};n()},80);t.registerMessageListener("__toggleShadowResize",d),e.makeShadow=h,t.registerMessageListener("__makeFullShadow",h),e.launch=u}(o||(o={})),t.fullShadow=e,t.FullScreen=i,t.fullscreen=i,t.registerMessageListener("__isFullScreen",function(t){t((window.top==window||window.parent==window)&&!!o.pathsArray)}),t.isFullScreen=s,t.registerMessageListener("__hasShadowMask",function(e,i){var s;(o.shadowList||[]).length?e(!0):(s=i.shift())&&(s=$("["+s+"]")[0])?t.postMessage(s.contentWindow,"__hasShadowMask",[i],e):e(!1)}),t.hasShadowMask=n}(utry||(utry={}));var utry;!function(t){function e(t,e,i){var s=new d({time:i,type:t,msg:e}),n=$(s._el),o=.1*$(window).height(),r=($(window).width()-n.outerWidth(!0))/2;return n.css({top:o,left:r,position:"fixed"}),s}function i(e){t.postMessage(window.top,"__loading",["loading",{status:!!e}])}function s(e,i){t.postMessage(window.top,"__loading",["info",{msg:e,time:i||"2"}])}function n(e,i){t.postMessage(window.top,"__loading",["error",{msg:e,time:i||"2"}])}function o(e,i){t.postMessage(window.top,"__loading",["warn",{msg:e,time:i||"2"}])}function r(e,i,s,n){var o=t.utils.argsToArray(arguments,1);t.isObject(i)&&(i=o[0].msg),t.postMessage(window,"__modalLoading",[{status:!!e,msg:i,time:s||o[0].timer||"2",shadow:n||o[0].isFullShadow?1:2}],o[0].callback)}function a(i,s,n){var o="GlobalLoadingSpace",r="loading",a=t.get(r,o);if(a&&!a.destroyed){if("loading"==s&&n.status&&"loading"==a.options.type)return;("loading"!=s||n.status||"loading"==a.options.type||"loading"==s&&!n.status&&"loading"==a.options.type)&&a.destroy()}"loading"==s&&n.status?t.put(r,e("loading","<span class='ut-tip-loading'>数据加载中......</span>"),o):"loading"!=s&&t.put(r,e(s,n.msg,n.time||2),o)}function l(e,i){var s="GlobalLoadingSpace",n="modalLoading",o=t.get(n,s);if(o&&!o.destroyed){if(i.status)return;o.destroy(),e&&e()}if(i.status){var r=new d({time:i.time,type:"loading",msg:"<span class='ut-tip-loading'>"+i.msg+"</span>"||"数据加载中......",shadow:i.shadow}),a=$(r._el),l=.5*($(window).height()-a.outerHeight(!0)),h=($(window).width()-a.outerWidth(!0))/2;a.css({top:l,left:h,position:"fixed"}),t.put(n,r,s)}}var d=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(t){t.el="body",t.shadow&&(this._isFullShadow=1==t.shadow)},i.prototype.initState=function(t,e){return this.side=void 0==e.side?11:Math.max(Math.min(Number(e.side)||0,3),0),{type:e.type?"ut-"+e.type:"",msg:e.msg,side:["btm","lt","top","rt"][this.side]}},i.prototype.ready=function(t){void 0!==t.msg&&this.show()},i.prototype.setSide=function(t){if(this.isDestroyed())return this;t=this.side=void 0==t?11:Math.max(Math.min(Number(t)||0,3),0);var e,i,s=this.options.elem,n=this.getRootElement();return n.removeClass("ut-btm ut-lt ut-top ut-rt"),11==t&&s&&s.length&&(i=n.offset(),e=s.offset(),t=i.top+n.outerHeight()<=e.top?0:e.top+s.outerHeight()<=i.top?2:i.left+n.outerWidth()<=e.left?3:1),11!=t&&n.addClass("ut-"+["btm","lt","top","rt"][t]),this},i.prototype.show=function(i){if(this.isDestroyed())return this;var s,n=t.isObject(i)?i:{},o=this.options,r=n.elem||o.elem;t.isString(i)&&(n.msg=i),t.utils.extend(o,n),this.model.changed(),(s=Number(o.time))&&setTimeout(t.bind(function(){t.fullShadow({enabled:!1,id:this._shadowId,context:this._isFullShadow?null:window}),this.destroy()},this),1e3*s);var a=t.Window||{},l=parseInt((a.zIndex||[]).slice(-1)[0]);return this._zIndex=l,l&&o.el.css("zIndex",l++),e.prototype.show.call(this,null,"fadein"),t.isString(r)&&(r=t.init(r)),r instanceof t.Component&&(r=r.getRootElement()),t.utils.locate(o.el,o.elem=r,["top","right center","bottom","left center"][this.side],8),o.shadow?this._shadowId=t.fullShadow({zIndex:this._zIndex,opacity:.4,context:this._isFullShadow?null:window}):t.fullShadow({enabled:!1,id:this._shadowId,context:this._isFullShadow?null:window}),this},i.prototype.destroy=function(){if(!this.destroyed){var i=this.options;i.shadow&&t.fullShadow({enabled:!1,id:this._shadowId,context:this._isFullShadow?null:window}),e.prototype.destroy.call(this)}return this},i.initRenderDelay=0,i.template=["<div class='ut-tip ut-box ut-shadow ut-radius ut-{{side}} ut-hidden {{type}}'>","    <div class='ut-wrap'>","        {{#msg}}","    </div>","    <span class='ut-arrow'><span class='ut-arrow-inr'></span></span>","</div>"],i}(t.Component);t.Tips=d,t.tips=e,t.registerMessageListener("__loading",a),t.loading=i,t.infomsg=s,t.errormsg=n,t.warnmsg=o,t.registerMessageListener("__modalLoading",l),t.modalLoading=r}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(i){var s=e.call(this,i=t.utils.object(i));return s?s:(this.inputElementSelector=this.inputElementSelector||this._getTextBoxInputSelector(),this._textBoxFocused=!1,(this.disabled=!!i.disabled)&&this.setDisabled(),(this.readonly=!!i.readonly)&&this.setReadonly(),i=this.options||i||{},this.options=i,void 0==i.popupWidth&&(i.popupWidth=i.panelWidth),void 0==i.popupHeight&&(i.popupHeight=i.panelHeight),this._bindTextBoxEvents(this.options),void this._setTextBoxValidator(this.options))}return __extends(i,e),i.prototype.validate=function(e,i){return t.Validator.validate(t.utils.trim(this.getValue()),e||this.options.rules,i||t.bind(this.validateHandler,this)),this},i.prototype.focus=function(){var e=this.find(this.inputElementSelector)[0];return t.isElement(e)&&/textarea|input/i.test(e.tagName)?$(e).focus():this.emit("focus"),this},i.prototype.destroy=function(){var t=this._textBoxValidateTips;return t&&t.destroy(),e.prototype.destroy.call(this),this},i.prototype.catchChangeEvent=function(e,i){if(i=this._getTextBoxInputSelector(i),this._BoundChangeEventSelector||(this._BoundChangeEventSelector=[]),!t.utils.some(this._BoundChangeEventSelector,i)){var s=t.browserVersion,n=i+"@change";t.isIE&&s<=9&&(s<9?this.bind("propertychange",i,n,this.emit):9==s&&this.bind("keyup blur",i,n,this.emit)),this.bind("input",i,n,this.emit).on(n,function(){var t=this.find(i),e=this.value,s=t.val();e!==s&&this.emit("change",this.value=s,e,t,i)})._BoundChangeEventSelector.push(i)}return t.isFunction(e)&&this.on("change",e),this},i.prototype.setDisabled=function(t){void 0===t&&(t=!0);var e=this.options,i=this.find(this.inputElementSelector),s=this.find(this.validateStyleSelector||e.el),n=this.getPseudoElement("popup"),o="ut-disabled";return t?(i.attr("disabled",!0),s.addClass(o),n.addClass(o)):(i.removeAttr("disabled"),s.removeClass(o),n.removeClass(o)),e.disabled=this.disabled=!!t,this},i.prototype.setReadonly=function(t){return void 0===t&&(t=!0),this.find(this.inputElementSelector).attr("readonly",this.options.readonly=this.readonly=!!t),this.find(this.validateStyleSelector||this.options.el)[t?"addClass":"removeClass"]("ut-readonly"),this.getPseudoElement("popup")[t?"addClass":"removeClass"]("ut-readonly"),this},i.prototype.showPopup=function(e,i,s,n){var o,r,a,l,d=this.find(e||this.tplPopup),h=this.options;if(!d.length)return this;if(this.isPseudoElement(d,"popup"))d[0].parentNode!==(o=document.body)&&d.appendTo(o),o=this.getRootElement(),this.show(d,s),void 0==(a=h.zIndex)&&(l=t.Window||{},a=parseInt((l.zIndex||[]).slice(-1)[0])),t.utils.locate(d.css(t.utils.extend({},{width:t.utils.setUnit(h.popupWidth||"100%",r=o.outerWidth())||r,maxHeight:t.utils.setUnit(h.popupHeight)||void 0,position:"absolute",zIndex:a||void 0})),o,"auto",void 0==n?1:n);else{var u,c=t.utils.getVisibleWidth(this.find(i||this.template)),p="ut-top";this.show(d,s),u=d.outerHeight(!0),u>c.bottom&&c.bottom<c.top?d.addClass(p):d.removeClass(p)}return this},i.prototype.showValidationTips=function(){var t;return(t=this.validationResult)&&this._showTextBoxValidateTips(t.message,t.valid),this},i.prototype.hideValidationTips=function(){var t=this._textBoxValidateTips;return t&&t.hide(),this},i.prototype.clearValidationTips=function(){return this.validationResult=null,this.hideValidationTips(),this._toggleValidationClass(!0),this},i.prototype._bindTextBoxEvents=function(e){var i="onFocus,onBlur,onClick,onDblClick,onMouseDown,onMouseUp,onMouseOver,onMouseMove,onMouseOut,onKeyPress,onKeyDown,onKeyUp",s=this.inputElementSelector;t.utils.each(i.split(","),function(i){var n=i.toLowerCase(),o=e[i]||e[n];t.isFunction(o)&&this.on(i,o),this.on(n=n.substring(2),t.bind(this.emit,this,i)).bind(n,s,t.bind(this.emit,this,n))},this),this.on("change",t.bind(this.emit,this,"onChange")),t.isFunction(e.onSelect)&&this.on("onSelect",e.onSelect)},i.prototype._getTextBoxInputSelector=function(e){return(e=t.utils.trim(e))||(e=t.utils.trim(this.inputElementSelector)||"."+(t.utils.trim(this.constructor.inputElementClass)||"ut-input")),e},i.prototype._setTextBoxValidator=function(e){var i=this.inputElementSelector;if(i){var s=String(t.utils.trim(e.validateTrigger)||"").toLowerCase()||"blur",n=[],o=e.rules;t.utils.forEach(e,function(i,s){if(/^rule([A-Z]\w*)$/.test(s)){var o=RegExp.$1.toLowerCase();/^rule\w+(?:Message)$/.test(s)||n.push(t.Validator.makeRule({name:o,value:e[s],message:e[s+"Message"]}))}}),o&&!t.isArray(o)&&(o=[o]),t.utils.each(o,function(e){if(t.isObject(e)){var i=e.name=String(t.utils.trim(e.name)||"").toLowerCase();i&&!t.utils.some(n,function(t){return t.name==i})&&n.push(t.Validator.makeRule(e))}});var r=t.utils.filter(n,function(t){return"empty"===t.name})[0],a=this.constructor.prototype.validate;if(r){var l,d=t.utils.trim(r.value||r.message),h=this.inputElementSelector;this.on("focus",t.bind(a,this,r,t.bind(this.validateHandler,this))),(l=$(e.validateWrapper)).length&&!t.utils.trim(this.find(h).val())&&l.html(d),t.utils.remove(n,r),l.length||n.length||this.on("blur",this.hideValidationTips)}n.length&&(this.on(s,t.bind(function(e){this.disabled||e.apply(this,t.utils.argsToArray(arguments,1))},this,a,n,t.bind(this.validateHandler,this))),t.isFunction(e.onValid)&&this.on("onValid",e.onValid),t.isFunction(e.onInvalid)&&this.on("onInvalid",e.onInvalid),this.on("onFocus",function(){this._textBoxFocused=!0,this.showValidationTips()}).on("onBlur",function(){this._textBoxFocused=!1,this.hideValidationTips()}).on("onChange",function(t){""===t&&this.clearValidationTips()}).bind("hover",function(t){/(?:enter|over)$/.test(t.type)?this.showValidationTips():this._textBoxFocused||this.hideValidationTips()}).on("onAfterRender",function(){var t=this.validationResult;t&&!t.valid&&this._toggleValidationClass(!1)}).emit("onValidatorInit",n.slice())),e.rules=n,n=e=r=null}},i.prototype.validateHandler=function(e,i,s){var n=this.options,o=s&&"empty"===s.name,r=t.utils.trim(n.validateWrapper);i=t.isString(i)&&(i=t.utils.trim(i))?i:"",!i&&e&&(i=t.utils.trim(n.validMessage||n.validmessage)||""),r=(r=r?$(r):"").length?r:"",o?i&&(r?r.html(i):(this._toggleValidationClass(!0),this._showTextBoxValidateTips(i,!0))):(r?r.html(i):t.isEmpty(i)?(this.validationResult=null,this.hideValidationTips()):this.validationResult={message:i,valid:e,rule:s},this._toggleValidationClass(e),this.emit(e?"onValid":"onInvalid",i))},i.prototype._toggleValidationClass=function(t){var e=this.find(this.validateStyleSelector);e.length||(e=this.getRootElement()),e.toggleClass("ut-error",!t)},i.prototype._showTextBoxValidateTips=function(e,i){var s,n=this.options;(s=this._textBoxValidateTips)||(s=this._textBoxValidateTips=new t.Tips({side:void 0!==n.tipsSide?n.tipsSide:1})),e?s.show({msg:e,elem:this.getRootElement(),type:i?"info":"error"}):s.hide()},i.initRenderDelay=0,i.inputElementClass="ut-input",i}(t.Component);t.TextBox=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){this.options=e=t.utils.extend({maxSize:10,panelHeight:"auto",fields:[{field:"id",type:"string"},{field:"name",type:"string"}]},e),(this.url=t.utils.trim(e.url))&&(e.url=""),e.onChange&&this.on("onChange",e.onChange),e.onItemClick&&this.on("onItemClick",e.onItemClick)},i.prototype.initState=function(t,e){return this.dataList=t,{id:e.id,name:e.name,value:this.getValue(),className:e.className,text:this.getText(),list:t,style:e.style,panelWidth:e.panelWidth,panelHeight:e.panelHeight,placeholder:e.placeholder,inputStyle:e.inputStyle}},i.prototype.ready=function(e){this.listenTo("value",function(t,e){this.emit("onChange",this.value=t,e)}),this.bind("keyup","input",t.utils.throttle(function(e){var i=$(e.currentTarget).val();if(!t.isEmpty(i)){var s=this.model.data;t.isEmpty(this.url)?(s=t.utils.filter(this.model.data,function(t){return t.name.indexOf(i)!==-1}),s.length?s.length>this.options.maxSize&&(s=s.slice(0,this.options.maxSize)):s.push({name:"未找到",id:""}),this.setState("list",s),this.showPopup(this.tplList)):this.reload({url:this.url,ajaxSetup:{data:{maxSize:this.options.maxSize,keywords:i}},onSuccess:function(){this.once("onAfterRender",t.bind(this.showPopup,this,this.tplList))}})}if(13==e.keyCode){var n=this.find(".ut-hover");n=n.get(0)?n.eq(0):this.find("li:first");var o=n.data("value"),r=n.data("name");if(!o)return;this._isFocused=!0,this.emit("focus"),this.setState({text:r,value:o}),this._hiddenList(),$(e.currentTarget).focus()}},e.delay||20)),this.bind("keydown","input",function(t){var e=this.find("ul"),i=this.find(".ut-hover");40==t.keyCode?i.get(0)?(i.removeClass("ut-hover").next("li").addClass("ut-hover"),i.get(0)||this.find("li:last").addClass("ut-hover"),i.offset().top>e.height()+e.offset().top&&e.scrollTop(i.height()+e.scrollTop())):(this.find("li:first").addClass("ut-hover"),e.scrollTop(0)):38==t.keyCode&&(i.get(0)?(i.removeClass("ut-hover").prev("li").addClass("ut-hover"),i.get(0)||this.find("li:first").addClass("ut-hover"),i.offset().top<e.offset().top&&e.scrollTop(e.scrollTop()-i.height())):(this.find("li:last").addClass("ut-hover"),e.scrollTop(i.offset().top-e.height())))}),this.bind("click","input",function(t){this.showPopup(this.tplList)}),this.bind("click","::popup li",function(t){var e=$(t.currentTarget).data("value");if(e){this._hiddenList();var i=$(t.currentTarget).data("name");if(this.options.onItemClick){for(var s,n=0;n<this.dataList.length;n++)this.dataList[n].id==e&&(s=this.dataList[n]);this.emit("onItemClick",i,s)}else this.setState({text:i,value:e})}}),this.bind("click","document",function(t){t.srcComponent!==this&&this._hiddenList()}),void 0!=e.value&&this.setValue(e.value)},i.prototype.getText=function(){return this.getState("text")},i.prototype.getValue=function(){return this.getState("value")},i.prototype._hiddenList=function(){this.hide(this.tplList),this.find("li").removeClass("ut-hover"),this._isFocused&&(this._isFocused=!1,this.emit("blur"))},i.template=["<div class='ut-autocomplete ut-box' style='{{style}}'>","   <div class='ut-wrap'>","       {{include tplInput}}","   </div>","       {{include tplList}}","</div>"],i.tplInput=["<input id='{{id}}' name='{{name}}'  placeholder='{{placeholder}}' style='{{inputStyle}}'  value='{{text}}' autocomplete='off' class='ut-input'/>"],i.tplList=["<ul data-pseudo='popup' class='ut-autocomplete ut-list ut-shadow ut-hidden ut-popup' style='width:{{panelWidth}};height:{{panelHeight}};'>","   {{each [list]}}","       <li data-value='{{$value.id}}' data-name='{{$value.name}}'>{{$value.name}}</li> ","   {{/each}}","</ul>"],i.tplItem=["<li data-value='{{item.id}}' data-name='{{item.name}}'>{{item.name}}</li>"],i.events={},i}(t.TextBox);t.AutoComplete=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(t){t.onClick&&this.on("onClick",t.onClick)},i.prototype.initState=function(e,i){return{id:i.id,name:i.name,html:this.getHTML(),disabled:i.disabled,style:t.utils.getStyle({style:i.style}),attributes:i.attributes,img:i.img,imgDir:i.imgDir,iconFontClass:i.iconFontClass,iconDir:i.iconDir,btnCls:this.getButtonClass(i.type)}},i.prototype.ready=function(t){t.disabled&&this.find("button").addClass("ut-disabled").off("onClick")},i.prototype.getButtonClass=function(t){var e;switch(t){case"imge":e="ut-imge";break;case"primary":e="ut-primary";break;case"success":e="ut-success";break;case"warn":e="ut-warn";break;case"danger":e="ut-danger";break;case"link":e="ut-link";break;case"disabled":e="ut-disabled";break;default:e="ut-btn"}return e},i.prototype.getHTML=function(){var t=this.options;return t.text||t.value||t.el.html()},i.prototype.getText=function(){var t=this.options;return t.text||t.value||t.el.text()},i.template=["<button type='button' id='{{id}}' {{#attributes | getAttributes }} name='{{name}}' {{disabled}} class='ut-box ut-button {{btnCls}} {{imgDir | getClass}}' style='{{style}}'>","<i class='iconfont {{iconFontClass}} {{iconDir}}' aria-hidden=true></i>","{{#img | setIcon}} {{# html }}","</button>"],i.filters={setIcon:function(t){return t?"<img src='"+t+"'>":""},getClass:function(t){return t?"ut-"+t:""},getAttributes:function(e){if(void 0!==e&&!t.isObject(e))return e;var i=[];return t.utils.forEach(e,function(t,e){void 0===t||""===t?i.push(e):i.push(e+'="'+t+'"')}),i.join(" ")}},i.events={"click button":function(){this.emit.apply(this,["onClick"].concat(t.utils.argsToArray(arguments)))}},i}(t.Component);t.Button=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){(e.onClick=e.onClick||e.onclick)&&this.on("onClick",e.onClick).on("onclick",e.onClick),this.options=t.utils.extend({eventName:"click",eventTarget:"default",width:200,height:30},e)},i.prototype.initState=function(e,i){return{list:e,text:this.getText(),style:t.utils.getStyle({width:i.width,height:i.height}),img:i.img}},i.prototype.getText=function(){return this.options.text||this.options.value||this.options.el.text()},i.prototype.showMenu=function(){var e,i=this.find(this.tplList);return i[0].parentNode!==(e=document.body)&&i.appendTo(e),e=this.getRootElement(),this.show(i),t.utils.locate(i.css({width:t.utils.setUnit("100%",e.outerWidth()),position:"absolute"}),e,"auto"),this._isFocused=!0,this},i.prototype.hideMenu=function(){return this._isFocused=!1,this.hide(".ut-buttoncontent")},i.prototype.ready=function(t){var e,i=this.options.eventTarget,s=this.options.eventName;e="default"==i?".ut-buttongroup":"text"==i?".ut-buttontext":".ut-buttonicon",this.find(e).css("cursor","pointer"),this.bind(s,e,this.showMenu)},i.template=["<div class='ut-buttonlist' style='{{style}}' id='{{id}}'>","   <div class='ut-buttongroup'>","       <span class='ut-buttontext'>{{text}}</span>","       <span class='ut-buttonicon'>{{#img | setIcon}}</span>","   </div>","   {{include tplList}}","</div>"],i.tplList=["<div data-pseudo='popup' class='ut-buttonlist ut-buttoncontent ut-shadow ut-hidden' style='{{style}}'>","       <ul>","           {{for item in list}}","               <li class='ut-buttonitem' data-id='{{item.id}}'>{{item.text}}</li>","           {{/for}}","       </ul>","</div>"],i.filters={setIcon:function(t){return t?"<img src='"+t+"'>":""}},i.events={"click span":function(){this.emit("onClick")},"click ::popup li":function(){this.emit("onClick"),this.hideMenu()},"click document":function(t){this._isFocused&&t.srcComponent!==this&&this.hideMenu()}},i}(t.Component);t.ButtonList=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.initState=function(e,i){return{style:t.utils.getStyle({width:i.width,height:i.height,maxWidth:i.maxWidth,minWidth:i.minWidth}),name:this.name,itemWidth:t.utils.setUnit(i.itemWidth),list:e,type:i.type,value:this.value=this.getValue()}},i.prototype.init=function(e){this._parseElement(e),void 0==e.value&&(e.value=""),this.options=e=t.utils.extend({fields:[{field:"text",type:"string"},{field:"value",type:"string"}],dataKey:"key"},e),e.data&&e.data.length||e.url||(e.data=[{name:e.name,text:e.text,value:""===e.value?"checked":e.value,disabled:!!e.disabled,checked:!!e.checked}],e.checked&&""===e.value&&(e.value="checked")),this.inputElementSelector=".ut-box",e.validateTrigger||(e.validateTrigger="click")},i.prototype.ready=function(t){this.catchChangeEvent(t.onChange,"input"),void 0!=t.value?this.model.size()?this._initValue():this.once("onAfterRender",this._initValue):this._initValue()},i.prototype._initValue=function(){this.setValue(this.options.value),this.listenTo("value",function(t,e){this.emit("change",this.value=t,e,this.getCheckedItems())})},i.prototype.getValue=function(){return this._getItem("value")},i.prototype.getText=function(){return this._getItem("text")},i.prototype.getCheckedItems=function(){return this.model.select({checked:!0})},i.prototype._getItem=function(e){var i=this.model.select({checked:!0}),s=t.utils.map(i,function(t){return t[e]});return s.join(",")},i.prototype.setValue=function(e){if(void 0!=(e=t.utils.trim(e))){this.value=e+="";var i=t.isArray(e)?e:e.split(",");this.model.forEach(function(e){e.checked=t.utils.some(i,function(t){return t==e.value})}),this.model.changed()}return this},i.prototype._parseElement=function(e){var i,s=e.el;i=[],s.children(":"+(e.type=t.utils.trim(e.type||"checkbox"))).each(function(e,s){var n=t.Application.parseOptions(s);i.push({name:n.name,text:n.text,value:n.value,disabled:!!n.disabled,checked:!!n.checked})}),!i.length&&(i=void 0),t.utils.extend(e,{data:i})},i.initRenderDelay=0,i.template=["<div class='ut-box {{ico}} ut-{{type}}' style='{{style}}'>","{{each [list] as item}}","   {{include tplCheckBox item}}","{{/each}}","</div>"],i.tplCheckBox=["<div data-id='{{item.key}}' class='ut-wrap {{item | getClass}}' style='width:{{itemWidth}}'>","    <input type='{{type}}' {{item | getCheck}} value='{{item.value}}' id='{{item.key}}' name='{{item.name==void 0?name:item.name}}'>","    <label class='ut-label'>{{item.text}}</label>","</div>"],
i.filters={getClass:function(t){return(t.checked?"ut-checked ":"")+(t.disabled?"ut-disabled ":"")+(t.readonly?"ut-readonly ":"")},getCheck:function(t){return(t.checked&&this.value?" checked ":"")+(t.disabled?" disabled ":"")+(t.readonly?" readonly ":"")}},i.events={"click .ut-wrap":function(t){if(!this.readonly&&!this.disabled){var e=$(t.currentTarget),i=this.model,s=i.select("key",e.data("id"))[0];!s||s.readonly||s.disabled||(s.checked=!s.checked,i.update(s),this.value=this.getValue())}}},i}(t.TextBox);t.CheckGroup=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(t){this.dataType=t.dataType,this.rootPid=t.rootPid,this.nodeMap={},this.on("loaded",this.loadTreeData)},i.prototype.getNodeMap=function(){return this.nodeMap},i.prototype.setNodeMap=function(t){return this.nodeMap=t,this},i.prototype.loadTreeData=function(e){var i,s,n=this.options,o=this.nodeMap;if(!/tree/i.test(this.dataType))if(n.async)if(t.isArray(e)){for(s=0;s<e.length;s++)!(i=e[s])||i.id in o?(e.splice(s--,1),i&&t.print("Invalid Node with reduplicate id. "+i.id)):(o[i.id]=i,i.parent=null,i.children=[]);this.data=e}else this.data=[];else this.data=t.utils.listToTree(e,{childField:"children",parentField:"parent",rootPidVal:n.rootPid},o);return this},i.prototype.convertFields=function(i,s){var n=this,o=this.nodeMap;return s&&/tree/i.test(this.dataType)?(t.utils.treeWalker(i,function(i,s,r,a){return i=e.prototype.convertFields.call(n,i,!0),i.id in o?(a[r]=null,t.print("Invalid Node with reduplicate id. "+i.id),!1):(o[i.id]=i,void(i.parent=s||null))},!1,"children",this),i):e.prototype.convertFields.call(this,i,s)},i.prototype.getNode=function(t){return void 0!=t?this.nodeMap[void 0!=t.id?t.id:t]||null:null},i.prototype.makeNode=function(e){return t.isObject(e)?(e=this.convertFields(e,!0),this.nodeMap[e.id]=e):e=null,e},i.prototype.removeNodes=function(e){t.isArray(e)||(e=[e]);for(var i,s=this.nodeMap,n=e.length,o=0;o<n;o++)(i=this.getNode(e[o]))&&(s[i.id]=null,delete s[i.id]);return this},i.prototype.drop=function(){return this.nodeMap={},this.data=[],this},i}(t.Store);t.TreeModel=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){e.dataKey="id",void 0==e.dataType&&(e.dataType="tree"),void 0==e.mode&&(e.mode="vertical"),this.mode=e.mode,this.setModel(new t.TreeModel({dataType:e.dataType,rootPid:e.rootPid,preventChangeEvent:!0,preventDataClone:!0,preventDataMerge:!0}))},i.prototype.initState=function(e,i){var s="",n="",o="";return"inline"==i.mode?n=t.utils.getStyle({"max-width":i.width}):"vertical"==i.mode?(s=t.utils.getStyle({left:i.width}),o=t.utils.getStyle({left:i.width}),n=t.utils.getStyle({width:i.width})):"horizontal"==i.mode&&(s=t.utils.getStyle({left:i.width}),o=t.utils.getStyle({left:"0px",top:i.height})),{list:e,mode:i.mode,listStyle:t.utils.getStyle({width:i.width,"min-height":i.height,"line-height":i.height}),ulStyle:s,wrapStyle:n,secondUlStyle:o}},i.prototype.getSelectedNode=function(){var e=[];return t.utils.treeWalker(this.model.data,function(t){1==t.selected&&e.push(t)},!1,"children",this),e},i.prototype.getDisabledNode=function(){var e=[];return t.utils.treeWalker(this.model.data,function(t){1==t.disabled&&e.push(t)},!1,"children",this),e},i.prototype.getNodeById=function(t){return this.model.getNode(t)},i.prototype.ready=function(t){},i.template=["<div class='ut-comnav {{mode | setClass}}' style='{{wrapStyle}}'>","   {{include tplList}}","</div>"],i.tplList=["<ul>","   {{each list as item}}","       <li data-id='{{item.id}}' class='{{item | addClass}}' style='{{listStyle}}'>","           <div class='ut-comnav-title'>","               {{if item.icon}}","                   <img src='{{item.icon}}' class='ut-comnav-icon'/>","               {{/if}}","                   <a href='{{item.url | setUrl}}'>{{item.text}}</a>","               {{if item.children && item.children.length}}","                   <span class='ut-comnav-arrow {{mode | setFirstArrow}}'></span>","               {{/if}}","           </div>","           {{if item.children && item.children.length}}","               {{include tplChildList item.children as list}}","           {{/if}}","       </li>","   {{/each}}","</ul>"],i.tplChildList=["<ul style='{{secondUlStyle}}' class='ut-hidden'>","   {{each list as item}}","       <li data-id='{{item.id}}' class='{{item | addClass}}' style='{{listStyle}}'>","           <div class='ut-comnav-title'>","               {{if item.icon}}","                   <img src='{{item.icon}}' class='ut-comnav-icon'/>","               {{/if}}","                   <a href='{{item.url | setUrl}}'>{{item.text}}</a>","               {{if item.children && item.children.length}}","                   <span class='ut-comnav-arrow {{mode | setSecondArrow}}'></span>","               {{/if}}","           </div>","           {{if item.children && item.children.length}}","               {{include tplSecondChildList item.children as list}}","           {{/if}}","       </li>","   {{/each}}","</ul>"],i.tplSecondChildList=["<ul style='{{ulStyle}}' class='ut-hidden'>","   {{each list as item}}","       <li data-id='{{item.id}}' class='{{item | addClass}}' style='{{listStyle}}'>","           <div class='ut-comnav-title'>","               {{if item.icon}}","                   <img src='{{item.icon}}' class='ut-comnav-icon'/>","               {{/if}}","                   <a href='{{item.url | setUrl}}'>{{item.text}}</a>","               {{if item.children && item.children.length}}","                   <span class='ut-comnav-arrow {{mode | setSecondArrow}}'></span>","               {{/if}}","           </div>","           {{if item.children && item.children.length}}","               {{include tplSecondChildList item.children as list}}","           {{/if}}","       </li>","   {{/each}}","</ul>"],i.filters={setClass:function(t){return t?"ut-comnav-"+t:""},setUrl:function(t){return t?t:"javascript:void(0)"},addClass:function(t,e){var i="";return t.disabled?i+="ut-comnav-disabled":!t.selected||t.children&&0!=t.children.length||(i+="ut-comnav-selected"),i},setFirstArrow:function(t){var e="";return e+="horizontal"==t||"inline"==t?"ut-comnav-arrowDown":"ut-comnav-arrowRight"},setSecondArrow:function(t){var e="";return e+="inline"==t?"ut-comnav-arrowDown":"ut-comnav-arrowRight"}},i.events={"click li":function(t){t.stopPropagation();var e=$(t.currentTarget),i=e.attr("data-id"),s=this.model.getNode(i);if(e.hasClass("ut-comnav-disabled"))return!1;if(s.children&&0!=s.children.length||($("li").removeClass("ut-comnav-selected"),e.addClass("ut-comnav-selected")),"inline"==this.mode){e.children("ul").removeClass("ut-hidden");var n=e.hasClass("ut-comnav-expand");n?(e.children("ul").slideUp(200),e.removeClass("ut-comnav-expand"),e.children(".ut-comnav-title").find(".ut-comnav-arrow").removeClass("ut-comnav-am-inline-slideDown-rotate").addClass("ut-comnav-am-inline-slideUp-rotate")):(e.children("ul").slideDown(200),e.addClass("ut-comnav-expand"),e.children(".ut-comnav-title").find(".ut-comnav-arrow").removeClass("ut-comnav-am-inline-slideUp-rotate").addClass("ut-comnav-am-inline-slideDown-rotate"))}this.emit("onClick",s)},"mouseenter li":function(t){var e=$(t.currentTarget);if(e.hasClass("ut-comnav-disabled"))return!1;if("horizontal"==this.mode||"vertical"==this.mode){this.show(e.children("ul"),"fadein");var i=e.attr("data-id"),s=this.model.getNode(i);this.emit("onMouseenter",s)}},"mouseleave li":function(t){var e=$(t.currentTarget);"horizontal"!=this.mode&&"vertical"!=this.mode||this.hide(e.children("ul"))}},i}(t.Component);t.ComNav=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments),this.menus=[]}return __extends(i,e),i.prototype.getPosition=function(t,e,i,s,n,o,r){var a=5,l=$(window).width(),d=$(window).height(),h=this.menuLeft+this.find(".ut-ctx-menu").parent().position().left,u=this.menuTop+this.find(".ut-ctx-menu").parent().position().top;t>=0?this.eleLeft=h+i+t+n<=l?t+i-a:t-n+a:this.eleLeft=h+n<=l?-a:t-n+a;var c=28;this.eleTop=u+s+o<d?s+e:s+c+e-o,r.css({left:this.eleLeft,top:this.eleTop,opacity:"1",filter:"alpha(opacity=100)"})},i.prototype.init=function(e){e.dataKey="id",e.el.remove(),e.el="body",e.target=$(e.target),this.optionsDefault=e.defaultCon||!0,this.setModel(new t.TreeModel({dataType:void 0==e.dataType?"":e.dataType,rootPid:e.rootPid,preventChangeEvent:!0,preventDataClone:!0,preventDataMerge:!0})),this.options=e=t.utils.extend({icons:!0},e),e.onClick&&this.on("onClick",e.onClick),e.onBeforContextmenu&&this.on("onBeforContextmenu",e.onBeforContextmenu)},i.prototype.initState=function(t,e){return{list:t,icons:e.icons}},i.prototype.ready=function(e){var i=this,s=e.eleTarget?e.eleTarget:document,n=e.triggerEventType?e.triggerEventType:"contextmenu";$(s).bind(n,function(e){return!!i.optionsDefault&&(e.preventDefault(),void(t.utils.some(i.emitHelper("onBeforContextmenu",e.currentTarget,e),!1)||i.showContextMenu(e.clientX,e.clientY)))}),e.x&&e.y&&this.showContextMenu(e.x,e.y)},i.prototype.showContextMenu=function(t,e){this.find("li").removeClass("cur");var i=$(document).scrollTop(),s=$(document).scrollLeft(),n=t+s,o=e+i,r=this.find(".ut-ctx-menu"),a=r.width(),l=r.height(),d=$(window).width(),h=$(window).height()+i,u=r.parent().offset().top,c=r.parent().offset().left;n+a>d?this.menuLeft=d-c-a:this.menuLeft=n-c,o+l>h?this.menuTop=h-l-u:this.menuTop=o-u,this.find("ul").css("display","none"),this.find(".ut-ctx-menu").css({display:"block",left:this.menuLeft,top:this.menuTop})},i.prototype.hideContextMenu=function(){this.find(".ut-ctx-menu").css({display:"none"})},i.prototype.getNode=function(t){return this.model.getNode(t)},i.prototype.getNodeLevel=function(t){var e=-1;return(t=this.getNode(t))&&(e=void 0!=t._level?t._level:t._level=this.getParents(t).length),e},i.prototype.getParents=function(e){var i,s,n,o;if(e=i=this.getNode(e)){if(t.isArray(e.parents))s=e.parents;else for(o={},s=[];n=this.getNode(e.parent);){if(e===n||e.id===n.id||o[n.id]){e.parent=null,t.utils.remove(s,n);break}o[e.id]=o[n.id]=1,s.unshift(n),e=n}i.parents=s}return s&&s.slice()||[]},i.prototype.makeMenu=function(t,e,i,s,n){for(var o=this.model.getNode(t).children,r=this.model.getNode(t),a=this.getNodeLevel(r),l=a;l<this.menus.length;l++)this.menus[l].remove();if(void 0==o)return!1;this.menus[a]=$(this.tplList.render({list:o,pid:t})),this.menus[a].appendTo($(".ut-ctx-menu")).css({display:"block",opacity:"0",filter:"alpha(opacity=0)"});var d=this.menus[a].width(),h=this.menus[a].height();this.getPosition(e,i,s,n,d,h,this.menus[a])},i.template=["<div class='ut-ctx-menu {{icons | setClass}}'>","       {{include tplList}}","</div>"],i.tplList=["<ul class='ut-border ut-shadow'>","    {{each list as item}}","         <li class='ut-item {{item | getClass}}' data-id='{{item.id}}' >{{#item.img | setImg}}<span class='{{item.children | setPaddingClass}}'>{{item.text}}</span>{{#item.children | setIcon}}</li>","    {{/each}}","</ul>"],i.filters={getClass:function(t){var e="";return t.disabled&&(e+="ut-disabled "),t.group&&(e+="ut-group "),t.children&&(e+="ut-more"),e},setClass:function(t){return t?"":"ut-ctx-icons"},setImg:function(t){return t?"<img src='"+t+"'>":""},setIcon:function(t){return t?"<em></em>":""},setPaddingClass:function(t){return t?"":"ut-ctx-nochild"}},i.events={"hover .ut-item":function(t){var e=t.type,i=/(?:out|leave)/.test(e),s=$(t.currentTarget),n=s.attr("data-id"),o=s.parent().position().left,r=s.parent().position().top,a=s.parent().width()+2,l=s.position().top;i||(s.addClass("cur"),s.siblings().removeClass("cur"),this.makeMenu(n,o,r,a,l))},"click .ut-item":function(t){t.preventDefault(),t.stopPropagation(),this.emit("onClick",this.model.getNode($(t.currentTarget).attr("data-id")))},"click document":function(){this.optionsDefault&&this.hideContextMenu()}},i}(t.Component);t.ContextMenu=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){this.uuid=t.utils.uuid(12).toLowerCase();var i;(i=this.remote=t.utils.trim(e.async))&&(this.remote=t.utils.object(i,!0)),this.sizeList=[],this.hidden=!this.remote&&!!e.hidden,this.initSizeList(e.sizeList,e.size),this.calculate(void 0==e.count?"":e.count,i,e.index),t.isFunction(i=e.render)?(this.customRender=i,this.customEvents=t.isArray(i=e.events)?i:null):void 0!=(this.summary=t.utils.trim(e.summary))&&this.summary!==!0||(this.summary="第 ${begin} - ${end} 条&nbsp;共 ${count} 条"),this.queryNamesMap=t.utils.extend({size:"size",index:"index",begin:"begin",end:"end"},(i=this.remote)&&i.queryNamesMap),(i=e.border)===!1||/none/i.test(i)||(this.borderClass=/(left|right|top|bottom|true|all)/i.test(i)?"ut-border-"+{left:"lt",right:"rt",top:"top",bottom:"btm","true":"all",all:"all"}[RegExp.$1.toLowerCase()]:"")},i.prototype.initState=function(){return{showPageSize:!!this.sizeList.length,customRender:!!this.customRender,borderClass:this.borderClass,pageList:this.makePageList(),summary:this.makeSummary(),sizeList:this.sizeList,index:this.currentPage,hidden:!!this.hidden,size:this.pageSize,count:this.total}},i.prototype.ready=function(){this.hidden||(this.customRender?t.utils.each(this.customEvents,function(e){t.isObject(e)&&t.isFunction(e.listener)&&t.isString(e.selector)&&this.bind(t.utils.trim(e.type)||"click",e.selector,t.bind(e.listener,this))},this):this.bind("click",".ut-page-item",function(e){var i,s=e.currentTarget;t.utils.isDisconnected(s)||(i=$(s).data("page"),this.setIndex(/(\+1|-1|\+5|-5)/.test(i)?this.currentPage+ +RegExp.$1:i))}).bind("click",".ut-page-size",function(e){var i=this.find(".ut-size-list").eq(0),s=i[0],n=document.body;s&&(s.parentNode!=n&&i.appendTo(n),i.removeClass("ut-hidden"),t.utils.locate(i,e.currentTarget,"auto",1),this.$list=1)}).bind("click","::popup .ut-size-list",function(e){var i,s=e.currentTarget;t.utils.isDisconnected(s)||(i=$(e.target).data("size"),i&&(this.pageSize=+i,this.setIndex(1)))}).bind("click",".ut-pagination",function(){this.focused=1}).bind("click","document",function(){!this.focused&&this.$list&&(this.hide(".ut-size-list"),this.$list=0),this.focused=0}))},i.prototype.setIndex=function(e,s){if(!this.hidden){var n,o=this.remote;this.prevPagingState=this.getPagingState(!!o),e=i.getInt(e,this.currentPage,1,this.pageCount),this.calculate(this.total,this.pageSize,this.currentPage=e),n=this.getPagingState(!!o),!s&&t.isEqual(n,this.prevPagingState)||this.emit("onChange",t.utils.extend({},o,{params:n})),this.setState(this.initState())}return this},i.prototype.setRecordCount=function(t){return this.hidden||void 0==t||this.total==+t||this.calculate(t).setState(this.initState()),this},i.prototype.getPagingState=function(e){var i={count:this.total,size:this.pageSize,pageCount:this.pageCount,index:this.currentPage,begin:this.begin,end:this.end};return e?(e={},t.utils.forEach(this.queryNamesMap,function(t,s){e[t]=i[s]}),e):i},i.prototype.makeSummary=function(){var e,i=this.getPagingState();return this.customRender?e="":t.isFunction(e=this.summary)?e=e(i):t.isString(e)?(i.pagecount=i.pageCount,e=e.replace(/(\$?\{\s*([^}\s]+)\s*})/gi,function(t,e,s){return t=i[s.toLowerCase()],void 0!=t&&isFinite(t)?t:""})):e!==!1&&t.isBasicType(e)||(e=""),t.utils.trim(e)},i.prototype.makePageList=function(){var t=this.pageCount,e=this.currentPage,i=Math.max(Math.min(Math.max(e-2,2),t-6),2),s=Math.max(Math.min(Math.max(e+2,7),t-1),1),n=[{title:"上一页",value:"-1",text:""},{title:t>1?"首页":1,value:1,text:1}];for(e>=5&&t>5&&(n.push({title:"向前 5 页",value:"-5",text:""}),i=Math.max(i,3)),e<5&&7===s&&8===t&&(s=6);i<=s;i++)n.push({title:i,value:i,text:i});return s+1<t&&n.push({title:"向后 5 页",value:"+5",text:""}),isFinite(t)&&t>1&&n.push({title:"尾页",value:t,text:t}),n.push({title:"下一页",value:"+1",text:""}),n},i.prototype.initSizeList=function(e,s){var n=this.defaultSize={1200:20,1080:15,1050:15}[screen&&screen.height]||10;return s=this.pageSize=i.getInt(s,n,1),this.sizeList=[],e!==!1&&(t.isString(e)&&(e=e.split(",")),t.isArray(e)||(e=[n,20,30,40,50]),t.utils.each(e,function(e){t.utils.some(this.sizeList,e=i.getInt(e,n,1,1e6))||this.sizeList.push(e)},this),t.utils.some(e=this.sizeList,s)||e.push(s),e.sort(function(t,e){return t-e}),e.length&&(this.defaultSize=e[0])),this},i.prototype.calculate=function(t,e,s){return this.total=i.getInt(t,this.total||1/0),this.pageSize=i.getInt(e,this.pageSize||this.defaultSize,1),this.pageCount=isFinite(this.total)?i.getInt(Math.ceil(this.total/this.pageSize),1,1):1/0,this.currentPage=i.getInt(s,this.currentPage||1,1,this.pageCount),this.begin=(this.currentPage-1)*this.pageSize+1,this.end=Math.max(Math.max(Math.min(this.currentPage*this.pageSize,this.total),this.begin),this.pageSize),this},i.getInt=function(t,e,i,s){return e=void 0==e?0:e,t=/^\s*(0|[1-9]\d*)\s*$/.test(t)?+RegExp.$1:e,void 0!=i&&(t=void 0==s?Math.max(i,t):i<=s?Math.min(Math.max(i,t),s):e),t},i.initRenderDelay=0,i.template=["<div class='ut-pagination {{ | getClassName}}'>","{{if !hidden}}","{{if customRender}}","   {{# | getCustomHTML}}","{{else}}","   <span class='ut-page-summary'>{{#summary}}</span>","   <ul class='ut-pagination-page ut-txt-select-none'>","       {{each pageList as item}}","       <li data-page='{{item.value}}' class='ut-page-item {{item | getItemClassName : index, size, false, count}}' title='{{item.title}}'>{{item.text}}</li>","       {{/each}}","       {{if showPageSize}}","       <li class='ut-page-size'>","           <span class='ut-size-text'>{{size}} 条/页</span>","           <ul data-pseudo='popup' class='ut-pagination ut-size-list ut-list ut-shadow ut-hidden ut-popup'>","               {{each sizeList as item}}","               <li data-size='{{item}}' class='{{item | getItemClassName : index, size, true, count }}'>{{item}} 条/页</li>","               {{/each}}","           </ul>","       </li>","       {{/if}}","   </ul>","{{/else}}","{{/if}}","</div>"],i.filters={getClassName:function(){return t.utils.trim(this.uuid+" "+(this.hidden?" ut-hidden ":"")+(this.borderClass?this.borderClass:""))},getCustomHTML:function(){return this.customRender()+""},getItemClassName:function(t,e,i,s){var n,o="";return s?t==i&&(o="ut-selected"):t.text?o=t.value==e?"ut-page-curr":"":(n=" ut-disabled",o="ut-page-"+{"-1":"prev"+(1==e?n:""),"+1":"next"+(e==this.pageCount?n:""),"-5":"jump-p","+5":"jump-n"}[t.value]),o}},i}(t.Component);t.Pagination=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){var i;t.isFunction(e.render)?(this.customRender=e.render,this.eventsList=t.isArray(i=e.events)?i:[]):this.eventsList=[],this.leftButtons=[],this.rightButtons=[],t.utils.each(e.buttons,function(e){t.isObject(e)&&(this.initButton(e),this[/left/i.test(e.align)?"leftButtons":"rightButtons"].push(e))},this),this.buttons=this.leftButtons.concat(this.rightButtons),(i=e.border)===!1||/none/i.test(i)||(this.borderClass=/(left|right|top|bottom|true|all)/i.test(i)?"ut-border-"+{left:"lt",right:"rt",top:"top",bottom:"btm ","true":"all",all:"all"}[RegExp.$1.toLowerCase()]:""),this.alignClass="ut-align-"+(/left/i.test(e.align)?"left":"right")},i.prototype.initButton=function(e){var i,s=t.utils.trim(e.style);return t.isObject(s)?s=t.utils.getStyle(s):t.isString(s)||(s=""),e.style=(e.hidden?"display:none;":"")+s,i=t.isString(s=t.utils.trim(e.className))?s:"",i+=t.isString(s=t.utils.trim(e.type))?" ut-"+s:"",i+=t.isString(s=t.utils.trim(e.icon))?" "+s:"",i+=e.disabled?" ut-disabled":"",e.className=i,e.value=t.isEmpty(e.value)?e.text:e.value,(e.img=t.utils.trim(e.img||e.image))&&("left"==e.imgDir?e.className+=" ut-left":e.className+=" ut-right"),!e.disabled&&t.isFunction(e.onClick=e.onClick||e.onclick||e.click)&&this.eventsList.push({selector:"."+(e.eventSelector=t.utils.uuid(12).toLowerCase()),listener:e.onClick}),e},i.prototype.initState=function(e,i){return{style:t.utils.getStyle({height:i.height,padding:i.padding}),buttons:this.buttons,borderClass:this.borderClass,alignClass:this.alignClass,customRender:!!this.customRender}},i.prototype.ready=function(){t.utils.each(this.eventsList,function(e){t.isObject(e)&&t.isString(e.selector)&&t.isFunction(e.listener)&&this.bind(e.type||"click",e.selector,e.listener)},this)},i.initRenderDelay=0,i.template=["<div class='ut-toolbar {{borderClass}} {{alignClass}}' style='{{style}}'>","   <div class='ut-toolbar-wrap'>","   {{if customRender}}","      {{# | getCustomHTML }}","   {{else}}","      {{each buttons as button}}","        <button type='button' style='{{button.style}}' {{# button.attributes | getAttributes }} class='ut-button {{button.eventSelector}} {{button.className}} {{button.imgDir|getClass}}' name='{{button.name}}' id='{{button.id}}'>","          {{#button.img|setIcon}} {{button.value}}","        </button>","       {{/each}}","   {{/if}}","   </div>","</div>"],i.filters={setIcon:function(t){return t?"<img src='"+t+"'>":""},getClass:function(t){return t?"ut-"+t:""},getCustomHTML:function(){return this.customRender()+""},getAttributes:function(e){if(void 0!==e&&!t.isObject(e))return e;var i=[];return t.utils.forEach(e,function(t,e){void 0===t||""===t?i.push(e):i.push(e+'="'+t+'"')}),i.join(" ")}},i}(t.Component);t.Toolbar=e}(utry||(utry={}));var utry;!function(t){var e=function(){function e(i){this.tpl={n:'<span class="ui-resizable-handle ui-resizable-handle-n" style="cursor: n-resize; height: 10px; width: 100%; top: -5px; left: 0; position: absolute;"></span>',s:'<span class="ui-resizable-handle ui-resizable-handle-s" style="cursor: s-resize; height: 10px; width: 100%; bottom: -5px; left: 0; position: absolute;"></span>',e:'<span class="ui-resizable-handle ui-resizable-handle-e" style="cursor: e-resize; width: 10px; right: -5px; top: 0; height: 100%; position: absolute;"></span>',w:'<span class="ui-resizable-handle ui-resizable-handle-w" style="cursor: w-resize; width: 10px; left: -5px; top: 0; height: 100%; position: absolute;"></span>',se:'<span class="ui-resizable-handle ui-resizable-handle-se" style="cursor: se-resize; width: 14px; height: 14px; right: -5px; bottom: -5px; position: absolute;"></span>',sw:'<span class="ui-resizable-handle ui-resizable-handle-sw " style="cursor: sw-resize; width: 14px; height: 14px; left: -5px; bottom: -5px; position: absolute;"></span>',nw:'<span class="ui-resizable-handle ui-resizable-handle-nw" style="cursor: nw-resize; width: 14px; height: 14px; left: -5px; top: -5px; position: absolute;"></span>',ne:'<span class="ui-resizable-handle ui-resizable-handle-ne" style="cursor: ne-resize; width: 14px; height: 14px; right: -5px; top: -5px; position: absolute;"></span>'},i=this.options=t.utils.extend({},e.DEFAULTS,i);var s,n=i.handles,o=i.element;i.handles=[],n=/all/i.test(t.utils.trim(n))?["n","ne","e","se","s","sw","w","nw"]:n?n.toString().split(","):[];for(var r=0;r<n.length;r++)/n[ew]|n|s[ew]|s|w|e/i.test(s=t.utils.trim(n[r]))&&i.handles.push(s);i.handles=i.handles.length?i.handles:["e","s","se"],i=this.options=t.utils.extend(i,{zIndex:parseInt(i.zIndex,10)||2013,ratio:Math.abs(parseFloat(i.ratio)||0),element:$(t.isObject(o)?o[0]:o).addClass("ui-resizable-element"),container:$(t.isObject(i.container)?i.container[0]:i.container),axis:i.axis&&/\s*(x|y)?\s*\,?\s*(x|y)?\s*$/i.exec(i.axis.toString())?[RegExp.$1,RegExp.$2===RegExp.$1?"":RegExp.$2].join(""):null});var a=document;i=this.options=t.utils.extend(i,{uuid:t.utils.uuid(12),win:$(window),doc:$(a),resizeHandler:[]});for(var l,d,o,h,u=a.body,r=0;o=i.element[r++];)l=this.getHandlerWrapper(o=$(o)),d=o.css("position"),/canvas|textarea|input|select|button|img/i.test(o[0].nodeName)?l.css({position:"static"===d?"relative":d,top:"static"===d?0:o.css("top"),left:"static"===d?0:o.css("left"),zIndex:o.css("zIndex"),display:o.css("display"),width:o.outerWidth(!0),height:o.outerHeight(!0)}).replace(o.css({position:"relative",left:0,top:0})).append(o):(l.children("span").appendTo(o),l.remove(),"static"===d&&o.css({position:"relative",left:0,top:0}),l=null),o[0]["resizeWrapper"+i.uuid]=l||o;if(i.resizeHandler.length){var c=[];i.mask=$(o=a.createElement("div")).css({top:0,left:0,width:1,height:1,opacity:.01,display:"none",position:"absolute",zIndex:i.zIndex+1}),c.push(o),h=i.helper=$(o=a.createElement("div")).css({display:"none",position:"absolute",border:i.border,zIndex:i.zIndex+1,backgroundColor:i.backgroundColor,opacity:i.ghost?parseFloat(i.opacity)||.4:.001}).addClass(i.helperCls||"ui-resizable-helper"),c.push(o),i.tips=i.showTips?$(o=a.createElement("div")).css({opacity:.4,display:"none",border:"1px solid",position:"absolute",backgroundColor:"#FFFFCC",zIndex:i.zIndex+1}):null,c.push(o),$(c).appendTo(u)}(i.oncreate||function(){}).call(this),this.preventTextSelectHandler=function(){return!1}}return e.prototype.getHandlerWrapper=function(t){for(var e,i=this.options,s=$("<div class='ui-resizable-wrapper' style='zoom:1'/>"),n=0;e=i.handles[n];n++)s.append(e=$(this.tpl[e]).css("zIndex",i.zIndex+(/n[we]|s[we]/.test(e)?20:10)).bind("mousedown",this.getResizeHandle(t))),i.resizeHandler.push(e);return s},e.prototype.getResizeHandle=function(e){var i=this;return function(s){return s.button===(t.isIE?1:0)?i.startResize(s,e):void 0}},e.prototype.startResize=function(e,i){var s,n,o,r,a,l,d,h,u=this,c=this.options,p=c.helper;c.disabled||(c.onstart||function(){}).call(i,e)===!1||(n=i[0]["resizeWrapper"+c.uuid],i[0]["resizeSettings"+c.uuid]=s=t.utils.extend(i[0]["resizeSettings"+c.uuid]=s={},{handler:o=$(e.currentTarget),handlerName:o[0].className.match(/ui-resizable-handle-(n[ew]|n|s[ew]|s|w|e)/)[1],wrapper:n,parent:a=c.container.length?n.parent():c.container,startLeft:(r=n.offset()).left,startHeight:d=n.outerHeight(!0),startWidth:l=n.outerWidth(!0),limit:this.limit(n,a),position:n.css("position"),zIndex:i.css("zIndex"),sClientX:e.clientX,sClientY:e.clientY,startTop:r.top}),"fixed"===s.position&&(s.fixedPosition={left:n[0].offsetLeft,top:n[0].offsetTop},n.css("position","absolute").offset(r)),n.css("zIndex",c.zIndex+1).addClass("ui-resizable-resizing"),c.mask.css("cursor",h=o.css("cursor")),c.helperBorder=c.helperBorder||{horizontal:p.outerWidth()-p.innerWidth(),vertical:p.outerHeight()-p.innerHeight()},p.css({cursor:h,display:"block",width:Math.max(l-c.helperBorder.horizontal,2),height:Math.max(d-c.helperBorder.vertical,2)}).offset(r),c.showTips&&c.tips.css({display:"block",left:e.clientX+10,top:e.clientY+10}).text(Math.ceil(l)+" × "+Math.ceil(d)),c.doc.bind("mousemove",c.resizingHandle=function(t){return u.doResizing(t,i)}).bind("mouseup",c.stopHandle=function(t){return u.stopResize(t,i)}).bind("dblclick",c.stopHandle).bind("selectstart",e.stopPropagation),"undefined"!=typeof document.body.style.maxHeight&&"onlosecapture"in document.documentElement?s.handler.bind("losecapture",c.stopHandle):c.win.bind("blur",c.stopHandle),"setCapture"in document.documentElement&&e.target.setCapture(),this.clsSelect())},e.prototype.doResizing=function(t,e){var i,s,n=this.options,o=e[0]["resizeSettings"+n.uuid];if((n.onresize||function(){}).call(e,t,i=t.clientX-o.sClientX,s=t.clientY-o.sClientY)!==!1){var r,a=o.handlerName,l=n.axis,d=o.limit,h=o.startWidth,u=o.startHeight,c=o.startLeft,p=o.startTop,f=h,m=u,g=c,v=p;"e"===a||"x"===l?(f=h+i,n.ratio&&(m=f/n.ratio)):"s"===a||"y"===l?(m=u+s,n.ratio&&(f=m*n.ratio)):"se"===a?(f=h+i,m=n.ratio?f/n.ratio:u+s):/nw|sw|w/.test(a)?(g=c+i,f=h-i,n.ratio&&(s=i/n.ratio,m=f/n.ratio),"nw"===a?(v=p+s,m=u-s):n.ratio||"sw"!==a||(m=u+s)):(v=p+s,m=u-s,n.ratio?f=m*n.ratio:"ne"===a&&(f=h+i)),f=Math.max(d.minWidth,Math.min(d.maxWidth,f)),m=Math.max(d.minHeight,Math.min(d.maxHeight,m)),g=g===c?g:Math.max(f===d.maxWidth?c-(f-h):0,Math.min(c+h-d.minWidth,g)),v=v===p?v:Math.max(m===d.maxHeight?p-(m-u):0,Math.min(p+u-d.minHeight,v)),n.helper.css({width:Math.max(f-n.helperBorder.horizontal,2),height:Math.max(m-n.helperBorder.vertical,2)}).offset(r={left:g,top:v}),n.mask.css({display:"block",width:n.win.width()+n.doc.scrollLeft(),height:n.win.height()+n.doc.scrollTop()}),n.showTips&&n.tips.css({left:t.clientX+10,top:t.clientY+10}).text(Math.ceil(f)+" × "+Math.ceil(m)),n.ghost||this.resize(e,f,m,Math.max(f-(e.outerWidth(!0)-e.width()),1),Math.max(m-(e.outerHeight(!0)-e.height()),1),g,v)}},e.prototype.stopResize=function(e,i){var s,n,o,r=this.options,a=i[0]["resizeSettings"+r.uuid],l=i[0]["resizeWrapper"+r.uuid],d=r.helper,h=d.offset();if(this.clsSelect(!1),r.doc.unbind("mousemove",r.resizingHandle).unbind("mouseup",r.stopHandle).unbind("dblclick",r.stopHandle).unbind("selectstart",e.stopPropagation),"undefined"!=typeof document.body.style.maxHeight&&"onlosecapture"in document.documentElement?a.handler.unbind("losecapture",r.stopHandle):r.win.unbind("blur",r.stopHandle),"setCapture"in document.documentElement&&a.handler[0].releaseCapture(),r.mask.css("display","none"),r.helper.css("display","none"),r.showTips&&r.tips.css("display","none"),s=a.fixedPosition)i.css({position:"fixed",left:s.left,top:s.top}),h.left-=r.doc.scrollLeft(),h.top-=r.doc.scrollTop();else if("relative"===a.position){var u=a.parent,c=t.utils.stripUnits(i.css("left"),u.width())||0,p=t.utils.stripUnits(i.css("top"),u.height())||0;h.left+=c-a.startLeft,h.top+=p-a.startTop}return l.css("zIndex",a.zIndex).removeClass("ui-resizable-resizing"),(r.onstop||function(){}).call(i,e,n=d.outerWidth(!0),o=d.outerHeight(!0),h)!==!1&&this.resize(i,n,o,n,o,h.left,h.top),!1},e.prototype.resize=function(t,e,i,s,n,o,r){var a=t[0]["resizeWrapper"+this.options.uuid];a[0]!==t[0]&&a.css({width:e,height:i,top:r,left:o}),t.css({width:s,height:n,top:r,left:o})},e.prototype.limit=function(e,i){var s,n,o,r,a=this.options,l=a.ratio,d=i.width(),h=i.height(),u={minWidth:t.utils.stripUnits(a.minWidth,d)||1,maxWidth:t.utils.stripUnits(a.maxWidth,d)||1/0,minHeight:t.utils.stripUnits(a.minHeight,h)||1,maxHeight:t.utils.stripUnits(a.maxHeight,h)||1/0};return l&&(s=u.minHeight*l,n=u.minWidth/l,o=u.maxHeight*l,r=u.maxWidth/l,s>u.minWidth&&(u.minWidth=s),n>u.minHeight&&(u.minHeight=n),o<u.maxWidth&&(u.maxWidth=o),r<u.maxHeight&&(u.maxHeight=r)),u},e.prototype.clsSelect=function(t){var e=$(document);e.unbind("selectstart",this.preventTextSelectHandler),(void 0==t||t)&&e.bind("selectstart",this.preventTextSelectHandler)},e.prototype.enable=function(){var t=this.options;t.disabled=!!t.destroyed;for(var e,i=0;e=t.resizeHandler[i++];)e.css("visibility","visible");return this},e.prototype.disable=function(){this.options.disabled=!0;for(var t,e=this.options,i=0;t=e.resizeHandler[i++];)t.css("visibility","hidden");return this},e.prototype.destroy=function(){var t,e,i,s,n=this.options;for(n.destroyed=n.disabled=!0,n.element.removeClass("ui-resizable-element"),(e=n.mask)&&e.remove(),(i=n.helper)&&i.remove(),(s=n.tips)&&s.remove();t=n.resizeHandler.shift();)t.remove();return this},e.DEFAULTS={element:null,handles:"s,e,se",maxWidth:1/0,maxHeight:1/0,minWidth:"1px",minHeight:"1px",ratio:null,axis:"x,y",container:"",ghost:!0,border:"2px dotted #6699FF",opacity:.4,backgroundColor:"#dfefff",helperCls:"",zIndex:2e3,showTips:!1,oncreate:function(){},onstart:function(){},onresize:function(){},onstop:function(){}},e}();t.Resizable=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.init=function(e){this.uuid=this.getUUID(12),this.paintingId=this.getUUID(),this.hStyleID=this.getUUID(),this.vStyleID=this.getUUID(),this.tStyleID=this.getUUID(),this.sStyleID=this.getUUID(),this.resizeRules={},this.headClass=this.getUUID(12),this.bodyClass=this.getUUID(12),this.fixedBodyClass=this.getUUID(12),this.fixedBottomClass=this.getUUID(12),this.fixedWrapClass=this.getUUID(12),this.fixedRightClass=this.getUUID(12);var i;this.checkedRecords=[],this.initOptions(e).initGrid().initPagination().initEvents(this.options),e=this.options,t.isString(i=e.dataKey)&&"id"!==i&&(t.isArray(e.fields)||(e.fields=[]),e.fields.push({type:"string",field:"id",map:i})),"id"!==i&&(e.dataKey="id"),
this.fixedLeftHidden=!0,this.throttledResizeWatcher=t.voidFunc},n.prototype.initOptions=function(e){e=this.options=t.utils.extend({showTableHeader:!0,stretchColumns:!0,tableBorder:!0,fillRows:!0,stripes:!0,border:!0},e),e.footerHTML=t.utils.trim(e.footerHTML),e.headerHTML=t.utils.trim(e.headerHTML),e.showRowDetail=t.isFunction(e.rowDetailRender),e.showTableFooter=!t.isEmpty(e.footerHTML),e.showToolbar=t.isObject(e.toolbar),e.bodyAlign=e.align,void 0==e.headAlign&&(e.headAlign=e.align),t.isFunction(e.rowHeight)||(e.rowHeight=this.parseInt(e.rowHeight)),e.radio&&(e.checkbox=!1),e.layout="",e.stretchColumns&&(e.layout="fixed");var i,s=e.scroll;return(i=t.isObject(s))||(e.scroll={}),e.scroll.x=void 0==s||(i?void 0==s.x||!!s.x:!!s),e.scroll.y=void 0==s||(i?void 0==s.y||!!s.y:!!s),this},n.prototype.initEvents=function(e){for(var i,s,n="onClick onRowClick onSelect onRowSelect onCheck onCheckAll onDblClick onRowDblClick onContextMenu onRowContextMenu onBeforePageChange onPageChange onRecordChange onResize onDragStart onDragMove onDragEnd onDropOver onDrop onDragDrop".split(" ");i=n.pop();)t.isFunction(s=e[i])&&this.on(i,s);return this},n.prototype.getUUID=function(e){return t.utils.uuid(e||10).toLowerCase()},n.prototype.toKeys=function(t){return this.filterRecords(t,!0)},n.prototype.toRecords=function(t){return this.filterRecords(t)},n.prototype.update=function(e){return t.isArray(e)||(e=[e]),this.model.batchUpdate(e),this},n.prototype.check=function(e,i){t.isArray(this.checkedRecords)||(this.checkedRecords=[]);var s=this.options,n=!!s.radio;n&&!t.isBoolean(e)&&((e=this.filterRecords(e)).length&&(e=e[0]),arguments[2]=1);var o,r,a,l,d=!!s.asyncCheckAssociation,h=(this.getState("list",!0)||[]).slice(),u=this.toKeys(h),c=arguments[2]?this.toKeys(e):null,p=t.utils.map(this.checkedRecords,function(t){return t.id});return t.isBoolean(e)?(i=!!e,n?i?r=o=[]:(r=this.toRecords(t.utils.filter(u,function(e){return t.utils.some(p,e)})),o=[],this.checkedRecords=[]):(a=this.toRecords(t.utils.filter(u,function(e){var s=t.utils.some(p,e);return i?!s:s})),i?(o=a,r=[],this.checkedRecords=this.checkedRecords.concat(a),l=!0):(o=[],r=a,d?t.utils.remove(this.checkedRecords,function(e){return t.utils.some(r,function(t){return e.id===t.id})}):this.checkedRecords=[]))):c?(o=t.utils.filter(c,function(e){return!t.utils.some(p,e)}),a=t.utils.filter(u,function(e){return!t.utils.some(c,e)}),r=t.utils.filter(a,function(e){return t.utils.some(p,e)}),d&&!n?(t.utils.each(r,function(e){t.utils.remove(this.checkedRecords,function(t){return t.id===e})},this),t.utils.each(o,function(e){t.utils.some(p,e)||this.checkedRecords.push(this.getRecord(e))},this)):this.checkedRecords=this.toRecords(c),o=this.toRecords(o),r=this.toRecords(r),l=c.length===u.length):(i=void 0===i||!!i,a=this.filterRecords(e,!0),!i&&d&&t.utils.each(t.isArray(e)?e:[e],function(e){var i=t.isObject(e)?e.id:e;t.utils.some(a,i)||a.push(i)}),i?(o=this.toRecords(t.utils.filter(a,function(e){return!t.utils.some(p,e)})),r=[],this.checkedRecords=this.checkedRecords.concat(o)):(o=[],r=this.toRecords(t.utils.filter(a,function(e){if(t.utils.some(p,e))return t.utils.remove(this.checkedRecords,function(t){return t.id===e}),!0},this))),l=!0,!n&&t.utils.each(u,function(t){return l=this.isChecked(t)},this)),n&&(l=!1),r.length&&this.emit("onCheck",r,!1),o.length&&(this.emit("onCheck",o,!0),l&&this.emit("onCheckAll",h,!0)),this},n.prototype.select=function(t,e){return this.tableBody.select(t,e),this},n.prototype.sort=function(e,i,s,n){var o;return o=1===arguments.length&&t.isObject(e)?e:{field:e,order:i,sorter:s,async:n},t.isEmpty(o.field)||(t.isEmpty(o.async)&&(o.async=/remote/i.test(this.options.sortType)),o.async?this.setPageIndex(1,t.utils.deepExtend(o.async,{params:{sort:o.field,order:o.order||"desc"}})):this.setState("list",t.Store.arraySort(this.getState("list",!0),o.field,t.isFunction(o.sorter)?o.sorter:o.order))),this},n.prototype.resize=function(t){return this.resizeWithSilence(t).emit("onResize")},n.prototype.resizeWithSilence=function(e){if(this.isDestroyed())return this;var i,s;return e&&(e=t.utils.object(e),s={},(i=t.utils.setUnit(e.width))&&(s.width=this.options.width=i),(i=t.utils.setUnit(e.height))&&(s.height=this.options.height=i),this.setBoundResizeWatcher().getRootElement().css(s)),this.adjustTable().scroll({left:this.bodyScrollLeft,top:this.bodyScrollTop},!0)},n.prototype.scroll=function(e,i){e=t.utils.object(e),i&&(this.bodyScrollLeft=void 0,this.bodyScrollTop=void 0);var s=+e.left,n=+e.top,o=this.getBody().parentNode;return isNaN(s)&&(s=this.bodyScrollLeft||o.scrollLeft),isNaN(n)&&(n=this.bodyScrollTop||o.scrollTop),this.scrollHBar(s).scrollVBar(n).scrollHFixed(s).scrollVFixed(n),this.bodyScrollLeft=s,this.bodyScrollTop=n,this},n.prototype.getScrollPosition=function(){var t=this.getBody().parentNode;return{left:t.scrollLeft,top:t.scrollTop}},n.prototype.getRecord=function(e){return void 0!=e&&""!==e&&t.isBasicType(e=t.isObject(e)?e.id:e)?this.model.select("id",e)[0]:null},n.prototype.getChangedRecords=function(){return this.tableBody.getDirtiedRecord()},n.prototype.clearDirtiedMarks=function(){return this.tableBody.clearMarks(),this},n.prototype.getAllRecords=function(e){var i=[];return this.model.forEach(function(t){i.push(e?t.id:t)}),e?i:t.utils.copy(i)},n.prototype.getCheckedRecords=function(e){return t.utils.map(this.checkedRecords,function(t){return e?t.id:t})},n.prototype.getSelectedRecords=function(t){return this.tableBody.getSelection(t)},n.prototype.clearSelection=function(){return this.tableBody.clearSelection(),this},n.prototype.isChecked=function(e){var i=t.isObject(e)?e.id:e;return t.utils.some(this.checkedRecords,function(t){return t.id===i})},n.prototype.isSelected=function(e){var i=t.isObject(e)?e.id:e;return t.utils.some(this.getSelectedRecords(!0),function(t){return i===t})},n.prototype.getRecordCount=function(){return this.pagination.getPagingState().count},n.prototype.getCellByRecordAndField=function(t,e){return this.tableBody.getCellByRecordAndField(t,e)},n.prototype.setCellContent=function(e,i,s){return t.isObject(e)&&this.tableBody.setCellContent(e,s,i),this},n.prototype.setCellContentByRecordAndField=function(t,e,i,s){return this.setCellContent(this.tableBody.getCellByRecordAndField(t,e),i,s)},n.prototype.getPageSize=function(){return this.pagination.getPagingState().size},n.prototype.getPageIndex=function(){return this.pagination.getPagingState().index},n.prototype.setPageIndex=function(e,i){return this.once("onBeforeFetch",function(e){this.resize(),t.utils.deepExtend(e,i)}).pagination.setIndex(e,!0),this},n.prototype.isAllChecked=function(){var e=!1;return this.options.radio||t.utils.each(this.getState("list",!0),function(t){return e=this.isChecked(t)},this),e},n.prototype.filterRecords=function(e,i){var s=[];return t.isString(e)?e=e.split(","):t.isArray(e)||(e=[e]),t.utils.each(e,function(t){(t=this.getRecord(t))&&s.push(i?t.id:t)},this),s},n.prototype.initState=function(e,i){!t.isArray(e)&&(e=[]);var s,n=this.pagination;n.remote||n.hidden||(s=n.getPagingState(),e=this.model.slice(s.begin-1,s.end,!0)),this.tableBody.checked=this.filterRecords(this.checkedRecords);var o=this.tableHead,r=this.tableBody,a=i.pagePosition,l=i.showFixedLeft&&!!o.leftFixedColumns.length,d=i.showFixedRight&&!!o.rightFixedColumns.length,h=i.showFixedBottom&&!!r.statsRows.length,u=i.showTableFooter&&!t.isEmpty(i.footerHTML),c=!t.isEmpty(i.headerHTML);return{uuid:this.uuid,paintId:this.paintingId,bodyClass:this.bodyClass,headClass:this.headClass,fixedBodyClass:this.fixedBodyClass,fixedWrapClass:this.fixedWrapClass,fixedRightClass:this.fixedRightClass,fixedBottomClass:this.fixedBottomClass,showToolbar:!!i.showToolbar,showTopPagination:!!a.top,showBottomPagination:!!a.bottom,showTableHeader:!!i.showTableHeader,showTableFooter:!!u,showHeader:!!c,showFixedBottom:!!h,showFixedLeft:!!l,showFixedRight:!!d,list:e,style:t.utils.getStyle({width:i.width,height:i.height})}},n.prototype.initGrid=function(){var e=this.options,n=this.tableHead;return this.toolbar&&this.toolbar.destroy(),this.toolbar=new t.Toolbar(t.utils.extend({align:"right"},e.toolbar,{border:"bottom"})),n&&n.destroy(),n=this.tableHead=new s(t.utils.extend({},e,{adjusterLineSelector:".ut-adjuster-line",context:this})).on("onCheck",t.bind(this.check,this)).on("onSort",t.bind(this.sort,this)).on("onColumnResize",t.bind(this.resizeColumn,this)),this.tableBody&&this.tableBody.destroy(),this.tableBody=new i(t.utils.extend({},e,{columns:n.effectiveColumns,stretchColumns:n.stretchColumns,context:this,contextClass:this.bodyClass})).on("onSelect",t.bind(this.emit,this,"onSelect")).on("onClick",t.bind(this.emit,this,"onClick")).on("onDblClick",t.bind(this.emit,this,"onDblClick")).on("onCheck",t.bind(this.check,this)).on("onContextMenu",t.bind(this.emit,this,"onContextMenu")),n.stretchColumns&&(e.layout="fixed"),this},n.prototype.initPagination=function(){var e=this.options,i=e.pagination,s=e.pagePosition={bottom:!1,top:!1};return void 0!=i&&i?t.isObject(i)?/(top|bottom)/i.test(i.position)?s[RegExp.$1.toLowerCase()]=!0:/both/i.test(i.position)?s.top=s.bottom=!0:s.bottom=!0:i&&(s.bottom=!0):i={hidden:!0},e._pagePosition=t.utils.object(s,!0),this.pagination&&this.pagination.destroy(),s=this.pagination=new t.Pagination(t.utils.extend({async:!!t.utils.trim(e.url)},i,{border:"none",count:0})).on("onChange",t.bind(this.jumpToPage,this)),s.remote&&(this.model=new t.Store({preventDataMerge:!0}),i=(s=s.remote).ajaxSetup||{},e.ajaxSetup=t.utils.extend(e.ajaxSetup,i,{data:t.utils.extend(t.utils.parseParams((e.ajaxSetup||{}).data),t.utils.parseParams(i.data))}),t.utils.extend(e,{url:s.url,dataType:s.dataType,storageType:s.storageType,contentType:s.contentType,queryNamesMap:t.utils.extend(e.queryNamesMap,s.queryNamesMap),params:t.utils.extend(t.utils.parseParams(e.params),t.utils.parseParams(s.params))})),(s=this.pagination).remote&&t.utils.trim(e.url)&&(e.params=t.utils.extend(s.getPagingState(!0),e.params)),this},n.prototype.jumpToPage=function(e){return t.utils.some(this.emitHelper("onBeforePageChange",e),!1)?this:(this.pagination.remote?this.reload(e):(e=e.params,this.tableBody.checked=this.filterRecords(this.checkedRecords),this.setState({list:this.model.slice(e.begin-1,e.end,!0)})),this.emit("onPageChange",this.pagination.getPagingState()))},n.prototype.makeTableFoot=function(e){var i=t.utils.trim(this.options.footerHTML);return t.isFunction(i)?i(e||[]):i},n.prototype.resizeColumn=function(e){var i={left:this.bodyScrollLeft,top:this.bodyScrollTop};t.utils.extend(this.resizeRules,e),this.adjustTable().scroll(i,!0)},n.prototype.ready=function(e){this.tableHead.ready(),this.tableBody.ready(),this.on("onRecordChange",function(e,i,s){var n=function(t){if(t.id==e.id)return t[i]=s,!1};this.model.forEach(n),t.utils.each(this.checkedRecords,n)}),this.bind("scroll",".s"+this.bodyClass,function(t){var e=t.currentTarget;this.scroll({left:e.scrollLeft,top:e.scrollTop})}).on("onComponentRemount",function(){t.utils.each(this.childComponents,function(e,i){e instanceof t.Component&&!e.destroyed&&(e.destroy(),this.childComponents[i]=null,t.utils.remove(this._childComponents,e))},this),t.utils.remove(this.childComponents,null)}).setBoundResizeWatcher();var i=this.getRootElement();e.resizable&&new t.Resizable(t.utils.extend({minWidth:Math.min(200,i.width()),minHeight:Math.min(200,i.height()),border:"2px dashed #6699FF"},e.resizable,{element:i,ghost:!0,onstop:t.utils.makeRunSequence(e.onstop,t.bind(function(t,e,i){return this.resize({width:e,height:i}),!1},this))})),e.delayRefresh&&this.on("onAfterRender",function(){var t=this;setTimeout(function(){t.isDestroyed()||t.resize()},0)})},n.prototype.setBoundResizeWatcher=function(){var e=this.options,i=/^\d+(?:px)?$/;return this.unbind("resize","window",this.throttledResizeWatcher),(!i.test(e.width)||e.height&&!i.test(e.height))&&this.bind("resize","window",this.throttledResizeWatcher=t.utils.throttle(t.bind(this.resize,this,null),100)),this},n.prototype.scrollHBar=function(t){if(t!==this.bodyScrollLeft){this.getHead().style.left=this.getBody("b").style.left=-t+"px";var e=this.getBody().parentNode;e.scrollLeft!==t&&(e.scrollLeft=t)}return this},n.prototype.scrollVBar=function(t){if(t!==this.bodyScrollTop){this.getBody("l").style.top=this.getBody("r").style.top=-t+"px";var e=this.getBody().parentNode;e.scrollTop!==t&&(e.scrollTop=t)}return this},n.prototype.scrollHFixed=function(t){if(t!==this.bodyScrollLeft){var e,i,s="ut-shadow";this.getState("showFixedLeft",!0)&&(e=this.tplFixedLeft,t?this.fixedLeftHidden&&(this.find(e).addClass(s),this.fixedLeftHidden=!1):(this.find(e).removeClass(s),this.fixedLeftHidden=!0)),this.getState("showFixedRight",!0)&&(e=this.tplFixedRight,i=this.find(this.tplTableBody).get(0),t===i.scrollWidth-i.clientWidth?(this.find(e).removeClass(s),this.fixedRightHidden=!0):this.fixedRightHidden&&this.find(e).addClass(s))}return this},n.prototype.scrollVFixed=function(t){if(t!==this.bodyScrollTop&&this.getState("showFixedBottom",!0)){var e=this.tplFixedBottom,i=this.find(this.tplTableBody).get(0),s="ut-shadow";t===i.scrollHeight-i.clientHeight?(this.find(e).removeClass(s),this.fixedBottomHidden=!0):this.fixedBottomHidden&&this.find(e).addClass(s)}return this},n.prototype.afterFetch=function(e){var i,s=this.options,n=s.checked,o=this.pagination;if(s.checked=null,t.isObject(e)?(i=e.count,this.model.setData(t.utils.filter(t.isArray(e=e.data)?e:[],function(e){return t.isObject(e)}),!0)):(e=this.model.data=t.isArray(e)?t.utils.filter(e,function(e){return t.isObject(e)}):[],i=e.length),o.hidden||void 0==i||o.setRecordCount(i),s.asyncCheckAssociation?t.isArray(this.checkedRecords)||(this.checkedRecords=[]):this.checkedRecords=[],s.radio||s.checkbox)if(s.asyncCheckAssociation){for(var r,a=(n=n||[]).length;a--;)if(void 0!=(r=n[a])){if("object"!=typeof r)r={id:r},"id"!==s.dataKey&&s.dataKey&&(r[s.dataKey]=r.id);else if(void 0==r.id)continue;this.isChecked(r)||this.checkedRecords.push(r)}s.radio&&this.checkedRecords.length&&(this.checkedRecords=[this.checkedRecords[0]])}else(n=this.filterRecords(n)).length&&(s.radio?this.checkedRecords=[n[0]]:t.utils.each(n,function(t){this.isChecked(t)||this.checkedRecords.push(t)},this))},n.prototype.afterRender=function(){this.setChildComponents(new t.Application({context:this.getRootElement()}).getComponents()),this.fixedLeftHidden=!0,this.fixedRightHidden=!0,this.fixedBottomHidden=!0,this.adjustTable().scroll({left:this.bodyScrollLeft},!0).tableHead.check(this.isAllChecked())},n.prototype.redraw=function(e){var i,s,n=this.options;return e=t.utils.object(e),e.url=e.data=e.params=e.dataKey=e.ajaxSetup=e.queryNamesMap,t.isBoolean(i=e.pagination)&&(s=n.pagePosition,i?(s.top=n._pagePosition.top,s.bottom=n._pagePosition.bottom):s.top=s.bottom=!1),t.isBoolean(i=e.toolbar)?i?e.toolbar=n._toolbar||n.toolbar:(e.toolbar=!1,n._toolbar=n.toolbar):t.isObject(toolbar)&&(n._toolbar=toolbar),e.checkbox&&!e.radio&&(n.radio=!1),this.paintingId=this.getUUID(),this.initOptions(t.utils.extend(n,e)).initGrid(),this.tableHead.ready(),this.tableBody.ready(),this.refresh()},n.prototype.showToolbar=function(){return this.redraw({toolbar:!0})},n.prototype.hideToolbar=function(){return this.redraw({toolbar:!1})},n.prototype.showPagination=function(){return this.redraw({pagination:!0})},n.prototype.hidePagination=function(){return this.redraw({pagination:!1})},n.prototype.setColumns=function(e,i){if(!this.isDestroyed()&&(t.isArray(e)||t.isObject(e))){var s,n,o,r,a=this.options.columns,l=[];if(e=t.isArray(e)?e:[e],i)l=e;else for(l=(t.isArray(a)?a:[a]).slice(),s=function(e){var i=null;return t.utils.treeWalker(a,function(t){if(t.field==e.field)return i=t,!1},!0,"group",this),i},r=0;r<e.length;r++)t.isObject(n=e[r])&&((o=s(n))?t.utils.extend(o,n):n.field&&l.push(n));return this.redraw({columns:l})}return this},n.prototype.adjustTable=function(){return this.find("."+this.uuid).empty(),this.makeStyleRule(this.adjustWidth(),this.hStyleID).makeStyleRule(this.adjustHeight(),this.vStyleID).makeStyleRule(this.divideHeight(),this.tStyleID).fixScrollWidth()},n.prototype.fixScrollWidth=function(){var t=this.find(this.tplTableBody).get(0),e=t.scrollHeight;return e>t.clientHeight&&(this.makeStyleRule([{className:this.headClass,"overflow-y":"scroll","padding-right":t.offsetWidth-t.clientWidth+"px"}],this.sStyleID,!0),t=$("<div style='height:"+e+"px'></div>").appendTo(t),$([document.getElementById(this.hStyleID),document.getElementById(this.vStyleID)]).remove(),this.makeStyleRule(this.adjustWidth(),this.hStyleID).makeStyleRule(this.adjustHeight(),this.vStyleID),t.remove(),this.makeStyleRule(this.divideHeight(e),this.tStyleID,!0)),this},n.prototype.divideHeight=function(e){var i,s=this.find(this.tplTableBody).get(0),n=this.fixedBottomClass,o=[],r=!!t.isFirefox;if(s.scrollWidth-(t.isIE?1:0)>s.clientWidth&&this.getBody("l").offsetWidth+this.getBody("r").offsetWidth<s.offsetWidth?(i=s.offsetHeight-s.clientHeight-+r,o.push({className:this.fixedBodyClass,"margin-bottom":-i+"px","padding-bottom":i+"px"}),o.push({className:n,bottom:i+"px"})):o.push({className:this.fixedWrapClass,display:"none"}),this.options.scroll.y){var a,l=this.getRootElement(),d=l.children(".ut-grid-top"),h=l.children(".ut-grid-foot"),u=l.children(".ut-grid-bottom"),c=l.find("."+this.headClass),p=Math.ceil(this.find("."+n).height());o.push({className:this.bodyClass,height:(a=Math.floor(l.height()-d.outerHeight()-h.outerHeight()-u.outerHeight()-c.outerHeight())+1)+"px"}),(e?e<=s.clientHeight:s.clientHeight<=a)?o.push({className:n,display:"none"}):(p>=a&&o.push({className:n,display:"none"}),i||($(s).height(a),i=s.offsetWidth-s.clientWidth-+r),o.push({className:this.fixedRightClass,right:i+"px"}),o.push({className:n,"margin-left":-i+"px","padding-left":i+"px"}))}return o},n.prototype.adjustHeight=function(){var e=this.options,i=e.rowHeight,s=!!e.showRowDetail,n=t.isFunction(i)?i:null,o=[],r=this.tableBody.list||[],a=0;return t.utils.each(["Head","Body"],function(t){var e=this;this.find("."+this["table"+t].uuid+">t"+t.toLowerCase()).children().each(function(l,d){if(l){--l,d=$(d);var h="Body"===t,u=h&&s&&n?+d.hasClass("ut-embed"):0;o.push({className:d.data("id"),height:Math.max(Math.ceil(d.outerHeight()),n?e.parseInt(n(l,h?r[l-(s?u?++a:a:0)]||{}:{},h,!!u,d.hasClass("ut-stats"))):i)+"px"})}})},this),o},n.prototype.parseInt=function(t){return/^\s*([1-9]\d*)\s*(?:px)?\s*$/.test(t)?+RegExp.$1:0},n.prototype.adjustWidth=function(e){var i,s=this.find("."+this.tableHead.rule).children(".ut-scale"),n=this.find("."+this.tableBody.rule).children(".ut-scale"),o=s.length-1,r=[];return e=e||this.resizeRules,s.each(function(s,a){a=$(a),i=a.data("id"),r.push({className:i,width:(i in e?parseInt(e[i],10):Math.max(Math.max(Math.ceil(a.width()),Math.ceil(n.eq(s).width())),30))-(t.isIE&&s===o?2:0)+"px"})}),r},n.prototype.makeStyleRule=function(t,e,i){var s,n,o,r=["<style type='text/css' id='"+e+"'>"],a="!important;";for(o=0;o<t.length;o++){r.push("."+(s=t[o]).className+"{");for(n in s)s.hasOwnProperty(n)&&"className"!==n&&r.push(n+":"+s[n]+a);r.push("}")}return this.hStyleID===e&&r.push("."+this.tableHead.uuid+",."+this.tableBody.uuid+"{width:100%!important;table-layout:fixed!important;}"),r.push("</style>"),i&&$("#"+e).remove(),this.find("."+this.uuid).append($(r.join(""))),this},n.prototype.getHead=function(){return(this.options.showTableHeader?document.getElementById(this.tableHead.uuid):null)||{style:""}},n.prototype.getBody=function(t,e){return document.getElementById((t||"")+this.tableBody.uuid)||(e?null:{style:"",offsetWidth:0})},n.template='<div class="ut-grid ut-box {{ | getGridClass}}" {{paintId}} style="{{style}}">  <div class="ut-grid-top">  {{if showHeader}}  {{include tplHeader}}  {{/if}}  {{if showToolbar}}  {{include toolbar}}  {{/if}}  {{if showTopPagination}}  {{include tplPagination "top" as position}}  {{/if}}  </div>  <div class="ut-grid-middle">  {{if showTableHeader}}  {{include tplTableHead}}  {{/if}}  {{include tplTableBody}}  {{if showFixedLeft}}  {{include tplFixedLeft}}  {{/if}}  {{if showFixedRight}}  {{include tplFixedRight}}  {{/if}}  {{include tplFixedBottom}}  <span class="ut-adjuster-line ut-hidden"></span>  </div>  {{if showTableFooter}}  {{include tplTableFooter}}  {{/if}}  <div class="ut-grid-bottom">  {{if showBottomPagination}}  {{include tplPagination "btm" as position}}  {{/if}}  </div>  <div class="{{uuid}} ut-clear"></div> </div>',n.tplPagination='<div class="ut-pagination-{{position}}">  {{include pagination}} </div>',n.tplTableHead='<div class="ut-grid-head {{headClass}}">  {{# "" | getTableHead }} </div>',n.tplTableBody='<div class="ut-grid-body s{{bodyClass}} {{bodyClass}}">  {{# list | getTableBody : "", false }} </div>',n.tplHeader='<div class="ut-grid-foot">  {{# list | getHeader}} </div>',n.tplTableFooter='<div class="ut-grid-foot">  {{# list | getTableFoot }} </div>',n.tplFixedBottom='<div class="ut-fixed-bottom ut-shadow {{fixedBottomClass}}">  {{if showFixedBottom}}  <div class="ut-fixed-wrap">  {{# list | getTableBody : "", true }}  </div>  {{/if}} </div>',n.tplFixedLeft='<div class="ut-fixed-left {{fixedWrapClass}}">  <div class="ut-fixed-wrap">  {{if showTableHeader}}  <div class="ut-grid-head">  {{ # "left" | getTableHead }}  </div>  {{/if}}  <div class="ut-grid-body {{bodyClass}} {{fixedBodyClass}}">  {{# list | getTableBody : "left", false }}  </div>  </div> </div>',n.tplFixedRight='<div class="ut-fixed-right ut-shadow {{fixedWrapClass}} {{fixedRightClass}}">  <div class="ut-fixed-wrap">  {{if showTableHeader}}  <div class="ut-grid-head">  {{ # "right" | getTableHead }}  </div>  {{/if}}  <div class="ut-grid-body {{bodyClass}} {{fixedBodyClass}}">  {{# list | getTableBody : "right", false }}  </div>  </div> </div>',n.initRenderDelay=50,n.filters={getGridClass:function(){var e=this.options,i="";return/(small|large)/i.test(e.size)&&(i+=" ut-"+RegExp.$1),e.stripes&&(i+=" ut-stripes"),e.showRowDetail&&(i+=" ut-grid-detail"),e.border&&"none"!=e.border||(i+=" ut-border-none"),i+=this.tableHead.multiple?" ut-v-border ut-h-border":" ut-thead-single",/bold/i.test(e.headFontWeight)&&(i+=" ut-thead-bold"),e.tableBorder&&(i+=/(horizontal|vertical)/i.test(e.tableBorder)?" ut-"+{horizontal:"h",vertical:"v"}[RegExp.$1]+"-border":" ut-h-border ut-v-border"),t.utils.each(["head","body"],function(t){/(left|right|center)/i.test(e[t+"Align"])&&(i+=" ut-t"+t+"-"+RegExp.$1.toLowerCase())}),/fixed/i.test(e.layout)&&(i+=" ut-grid-fixed"),e.scroll.x||(i+=" ut-scroll-x-none"),e.scroll.y||(i+=" ut-scroll-y-none"),t.utils.trim(i)},getTableHead:function(t){return this.tableHead.render({fixed:t})},getTableBody:function(t,e,i){var s=this.pagination;return this.tableBody.render({size:!s.hidden&&s.pageSize,list:t,fixed:e,stats:i})},getTableFoot:function(t){return this.makeTableFoot(t)},getHeader:function(e){var i=t.utils.trim(this.options.headerHTML);return t.isFunction(i)?i(e||[]):i}},n}(t.Component);t.DataGrid=e;var i=function(i){function s(e){i.call(this),this.context=e.context,this.space=t.utils.uuid(12).toLowerCase(),this.init(e)}return __extends(s,i),s.prototype.getTableClass=function(t){return t+(this.nowrap?" ut-grid-nowrap":"")},s.prototype.getRowClass=function(e,i,s){if(i&&void 0!=e.detailRowClass)return e.detailRowClass;if(!i&&void 0!=e.cellRowClass)return e.cellRowClass;var n,o=this.rowClassFilter,r=t.utils.trim((o?o(e.index,e.record,!!i,!!s):"")||this.rowClassName),a=this.droppedRecords,l=e.record||{};if(i)e.detailRowClass=r;else{if(e.checked&&(r+=" ut-checked"),!t.isIE8&&!t.isIE9)for(n=0;n<a.length;n++)l.id==(a[n]||{id:1}).id&&(r+=" "+this.droppedClassName,a.splice(n--,1));e.cellRowClass=r}return r},s.prototype.getColumnClass=function(e,i){var s,n,o=e.className,r="";return i?void 0!=i.cellClassName?i.cellClassName:(t.isFunction(o)&&(r=t.utils.trim(o(i.value,i.record,i.colIndex,i.rowIndex,i.isStats))),i.cellClassName=t.utils.trim((t.isEmpty(r)?"":r)+" "+e.cellColumnClass+(i.editable?" ut-grid-editable "+this.getContentIconClass(i):""))):void 0!=e.cellColumnClass?e.cellColumnClass:(n=e.align,(s=this.columnClassFilter)&&(r=t.utils.trim(s(e.colIndex,e.field,!!e.flag))),e.cellColumnClass=t.utils.trim((r||this.columnClassName||"")+(t.isFunction(o)||t.isEmpty(o)?"":" "+o)+(/(left|right|center)/i.test(n)?" ut-align-"+{left:"lt",right:"rt",center:"ct"}[RegExp.$1]:"")+(e.nowrap?" ut-nowrap":"")))},s.prototype.getCellStyleRule=function(e){if(void 0!=e.cellStyleRule)return e.cellStyleRule;var i=e.column,s=i.style;return t.isFunction(s)&&(s=s(e.value,e.record,e.colIndex,e.rowIndex,e.isStats)),t.isObject(s=t.utils.trim(s))&&(s=t.utils.getStyle(s)),e.cellStyleRule=t.isEmpty(s)?"":s},s.prototype.getContent=function(e){if(void 0!=e.cellInnerHTML)return e.cellInnerHTML;var i,s,n=e.html,o=e.flag;if((!e.row.isEmpty||e.field==="RI"+o)&&e.flag)switch(i=e.row.checked?"checked":"",s=" class='ut-checkbox c"+e.row.uuid+" "+this.space+"' "+i+" ",e.field){case"CK"+o:n="<input"+s+"type='checkbox'>";break;case"RD"+o:n="<input"+s+"name='"+this.uuid+"' type='radio'>";break;case"RI"+o:n=e.rowIndex+1;break;case"EP"+o:n="<i class='ut-trigger "+this.space+"'></i>"}return e.cellInnerHTML=t.isEmpty(n)?"<i class='ut-empty-holder ut-nowrap' style='visibility:hidden;'>NaN</i>":n},s.prototype.getContentIconClass=function(t){var e;switch(t.contentType){case"select":case"list":e="ut-edit-select";break;case"date":case"datetime":e="ut-edit-date";break;default:e=""}return e},s.prototype.init=function(e){var i=this;this.options=t.utils.extend({dropLineColor:"#a3c4e1"},e),this.uuid=t.utils.uuid(12).toLowerCase(),this.rule="rule"+this.uuid,this.rowClass=t.utils.uuid(6).toLowerCase(),this.nowrap=!!e.nowrap,this.preventSelection=!!e.preventSelection,this.stretchColumns=!!e.stretchColumns,this.layout=e.layout;var n=this.showRowDetail=!!e.showRowDetail;this.mergeRows=!n&&!!e.mergeRows,this.fillRows=!!e.fillRows,this.checkType=e.radio?"radio":e.checkbox?"checkbox":"",this.checkOnSelect=!!e.checkOnSelect,this.multiple=!!e.multiple,this.rowDetailRender=t.isFunction(e.rowDetailRender)?e.rowDetailRender:null,this.checked=t.isArray(e.checked)?e.checked:[],t.utils.each(["rowClass","columnClass"],function(i){var s=i+"Filter",n=i+"Name",o=e[n],r=t.isFunction(o);this[s]=r?o:null,this[n]=r?"":t.utils.trim(o)||""},this),this.draggable=!!e.draggable,this.droppable=!!e.droppable,this.dropLineStyle=e.dropLineStyle,this.droppedClassName=t.utils.uuid(10).toLowerCase(),this.dropTransitionTimer={on:-1,off:-1},this.contextClass=e.contextClass||"",this.subGridComponents=[],this.droppedRecords=[],this.columns=e.columns||[],this.rows=[],this.statsRows=[],this.cellsMap={},this.recordsMap={},this.rowsMap={},this.list=t.isArray(e.list)?e.list:[],this.showFixedLeft=!!e.showFixedLeft,this.showFixedRight=!!e.showFixedRight,this.showFixedBottom=!!e.showFixedBottom,(this.showContentTitle=!!e.contentTitle||t.utils.some(this.columns,function(t){return void 0!=t.contentTitle}))&&(this.contentTitle=$(s.tplTitle).appendTo("body")),this.template=new t.Template({source:s.template,filterContext:this,filters:this});var o;return this.context&&this.context.on("onCheck",o=function(e,s){i.destroyed||("radio"===i.checkType&&i.context.find("."+i.rowClass).removeClass("ut-checked"),t.utils.each(e,function(t){var e=this.getRowByRecord(t),i=this.context,n="ut-checked";i.find(".r"+e.uuid).toggleClass(n,!!s).find(".c"+e.uuid).attr("checked",s)},i))}).on("onCheckAll",o).once("onBeforeDestroy",function(){i.contentTitle&&i.contentTitle.remove(),i.dropRuleLine&&i.dropRuleLine.remove(),i.destroyed||i.cellEditable&&i.emit("onCellDestroy").destroyValidateTips()}),this.makeStatsRowGroup(this.list)},s.prototype.render=function(e){e=t.utils.object(e);var i=e.fixed||"",s=!!e.stats,n=e.list,o=+e.size,r=!i||s?this.columns:t.utils.filter(this.columns,function(t){return t.fixed===i}),a=r.length;if(n=t.isArray(n)?n.slice():this.list,this.fillRows&&(o-=n.length)>0)for(;o--;)n.push({});return t.isEqual(n,this.list)||(this.emit("onCellDestroy"),this.rows=[],this.subGridComponents=[],this.statsRows=[],this.cellsMap={},this.rowsMap={},this.recordsMap={},this.editableCell=this.selectedCell=null,this.destroyValidateTips(),this.makeCell(this.list=n).makeStatsRowGroup(n)),t.isIE8||t.isIE9||!this.droppedRecords.length||this.setColorTransition(),this.template.render({rowClass:this.rowClass,statsRows:this.statsRows,style:!i&&this.stretchColumns?"width:100%":"",stretch:!!this.stretchColumns,showRowDetail:!s&&this.showRowDetail,rows:s?[]:this.rows,uuid:(i?i.charAt(0):s?"b":"")+this.uuid,rule:i||s?"":this.rule,colLength:a,columns:r,fixed:i})},s.prototype.setColorTransition=function(t,e){var i=this.droppedClassName,s=this.dropTransitionTimer,n=this;return t||(clearTimeout(s.on),clearTimeout(s.off),$(document.getElementById(i)).remove(),$(document.getElementById(i+"t")).remove()),s.on=setTimeout(function(){$("<style id='"+i+(t?"t":"")+"'>."+i+"{background-color:"+(t||n.options.dropLineColor||"#fbf0c4")+"!important;transition:background-color 1s;-moz-transition:background-color 1s;-webkit-transition:background-color 1s;}</style>").appendTo("body"),void 0==t?n.setColorTransition("transparent",1200):s.off=setTimeout(function(){$(document.getElementById(i)).remove(),$(document.getElementById(i+"t")).remove()},1e3)},e||0),this},s.prototype.renderRowDetail=function(i){var s,n=this.rowDetailRender,o=document.getElementById(i.embedUUID),r=n?n(i.record,i.index,o):"";r instanceof t.Component?s=[r.appendTo(o)]:((o=$(o)).html(r),s=t.parse(o)),t.utils.each(s,function(s){s instanceof e&&(this.subGridComponents.push(s),s._parentGridContainerId=i.embedUUID),this.context.on("onAfterRender",t.bind(s.destroy,s))},this),this.context.setChildComponents(s),i.rendered=!0},s.prototype.resizeSubGrid=function(){if(this.destroyed)return this;var e=!1;return t.utils.each(this.subGridComponents,function(t){var i,s,n,o;t&&!t.isDestroyed()&&(i=document.getElementById(t._parentGridContainerId))&&(s=i._boundingRect||{width:0,height:0},i._boundingRect=s,i=$(i),n=i.width(),o=i.height(),n==s.width&&o==s.height||(t.resize(),s.width=n,s.height=o,e=!0))}),e&&this.context.resizeWithSilence(),this},s.prototype.ready=function(){var e=this;if(!this.context)return this;var i,s="."+this.space;this.context.bind("click",s+".ut-trigger",function(t){var i=$(t.currentTarget),s=i.parents("tr:first").data("id"),n=e.rowsMap[s];i.parent().toggleClass("ut-collapse").parent().next().toggleClass("ut-hidden"),!n.rendered&&e.renderRowDetail(n),e.context.resize()}).bind("mousedown","."+this.rowClass,function(i){i.shiftKey&&t.utils.clearSelection(),e.draggable&&$(i.currentTarget).hasClass("ut-selected")&&e.initDrag(i)}).bind("click","."+this.rowClass,i=function(i){var s,n,o,r,a,l,d,h,u=$(i.currentTarget),c=u.data("id"),p=(i.type||"").toLowerCase(),f=e.preventSelection,m=e.context,g=e.rowsMap,v=g[c],y=m.find("tr.r"+c+":not(.ut-embed)"),b=f?"":"ut-selected",x="ut-checked",w=i.shiftKey,C=u.hasClass("ut-stats"),_=u.hasClass("ut-embed");if(C||_?s=v.record:"click"===p?(n=m.find("tr."+e.rowClass+(e.multiple||f?"":"."+b)).not(".ut-stats,.ut-embed"),e.multiple?(w?(e.focused&&(o=m.find("tr.r"+e.focused.uuid)[0])?((r=y[0])!==o&&(a=[],n.each(function(){return(this===o||this===r)&&(l=!l),void 0!=l&&(a=a.concat(m.find("tr.r"+g[$(this).data("id")].uuid).not(".ut-stats,.ut-embed").get())),l})),y=$(a||y)):e.focused=v,f||(n.removeClass(b),y.addClass(b))):(f?d=!0:(y.toggleClass(b),d=!y.hasClass(b)),e.focused=v),s=[],y.each(function(){var e=g[$(this).data("id")].record;!t.utils.some(s,e)&&s.push(e)})):(f||(n.removeClass(b),y.addClass(b)),s=v.record),e.checkType&&(e.checkOnSelect?e.emit("onCheck",s,w||!y.hasClass(x),w):$(i.target).hasClass("c"+c)&&e.emit("onCheck",v.record,!y.hasClass(x)))):s=v.record,h=e.getCellByElem($(i.target)),h&&e.cellEditable&&/click/.test(p)&&e.handleEditableCell(h,"dblclick"==p),!d){var k=m.emitHelper({click:f||"onSelect",dblclick:"onDblClick",contextmenu:"onContextMenu"}[p],s,_,C,{x:i.clientX,y:i.clientY},h,i),S=m.emitHelper({click:f||"onRowSelect",dblclick:"onRowDblClick",contextmenu:"onRowContextMenu"}[p],i,s,h);
if(t.utils.some(k,!1)||t.utils.some(S,!1))return!1}"click"===p&&(e.emit("onClick",v.record,_,C,h,i),m.emit("onRowClick",i,v.record,h))}).bind("dblclick","."+this.rowClass,i).bind("contextmenu","."+this.rowClass,i),(this.showFixedLeft||this.showFixedRight||this.showFixedBottom)&&this.context.bind("hover","."+this.rowClass,function(t){var i=$(t.currentTarget),s=i.data("id"),n=/(?:enter|over)$/.test(t.type);e.context.find("tr.r"+s).toggleClass("ut-hover",n),e.emit(n?"onHover":"onHoverOut",e.rowsMap[s].record)}),this.context.on("onResize",t.bind(this.resizeSubGrid,this)),(this.showContentTitle||this.droppable)&&(this.mouseMoveHandler=function(t){var i,s=e.contentTitle;s&&(i=$(window),s.css({left:Math.min(t.clientX+12,Math.max(i.width()-s.outerWidth()-3,0)),top:Math.min(t.clientY+20,Math.max(i.height()-s.outerHeight()-3,0))}))},this.showContentTitle&&this.context.bind("hover","."+this.rowClass+">td",function(i){var s=e.contentTitle;if(t.get("dragMoving","DragAndDropSpace"))return s.hide(),void(s.currentCell=null);var n,o=/(?:enter|over)$/.test(i.type),r=$(document),a=e.getCellByElem($(i.target));r.unbind("mousemove",e.mouseMoveHandler),a&&(n=t.utils.trim(a.contentTitle)),s=e.contentTitle,o&&!t.isEmpty(n)?(r.bind("mousemove",e.mouseMoveHandler),s.text(n).show(),s.currentCell=a):(s.hide(),s.currentCell=null)}),this.droppable&&(this.dropRuleLine=$('<div class="ut-grid-drop-rule" style="'+t.utils.getStyle(this.dropLineStyle)+'">').appendTo("body"),this.options.dropLineColor&&this.dropRuleLine.css("background-color",this.options.dropLineColor),this.dropHandler=t.bind(this.makeDrop,this),this.context.bind("hover","tr."+this.rowClass+",."+this.contextClass,t.bind(this.initDrop,this)))),this.cellEditable&&this.on("onCellDestroy",function(){t.utils.forEach(this.cellsMap,function(t){t.editComponent&&t.editComponent.destroy()})}),this.draggable&&this.on("onDragDrop",function(e){var i,s,n=this.list.slice(),o=function(t){return i.id==t.id},r=this.context,a=r.getScrollPosition();for(s=0;s<n.length;s++)i=n[s],t.utils.some(e,o)&&n.splice(s--,1);r.options.checked=r.getCheckedRecords(!0),r.reload({data:n}).scroll(a,!0)})},s.prototype.initDrop=function(e){var i="DragAndDropSpace";if(t.get("dragMoving",i)){var s=/(?:enter|over)$/.test(e.type),n=t.get("dragRelatedTarget",i);if("tr"==e.currentTarget.nodeName.toLowerCase())this.stopDropPropagation=!!s;else if(this.stopDropPropagation)return void(this.stopDropPropagation=!1);if(s&&n&&(n[0]==e.target||t.utils.contains(n,e.target)))return;var o=$(document),r=$(document.getElementById(this.uuid)).parent();if(o.unbind("mouseup",this.dropHandler),s){var a=$(e.currentTarget),l=a.data("id"),d=this.rows||[],h=l?this.rowsMap[l]:d[d.length-1],o=$(document);!l&&h&&(a=this.context.find("tr.r"+h.uuid));var u,c,p,f=a.offset(),m=e.clientY,g=f.top-o.scrollTop();h&&h.index==this.rows.length-1&&m>g+.5*(u=a.height())?(g+=u,c=null,p=h.record||null):(c=h?h.record||null:null,p=h?(this.rows[h.index-1]||{}).record||null:null),this.dropRuleLine.css({display:"block",left:f.left-o.scrollLeft(),top:g-4,width:r.width()}),r.css("cursor","pointer"),this.context.emit("onDropOver",{before:c,after:p},e),t.put("dropOver",{before:c,after:p},i),t.put("dropContext",this,i),t.put("dropMoving",!0,i),o.bind("mouseup",this.dropHandler)}else this.dropRuleLine.hide(),r.css("cursor",""),t.put("dropOver",null,i),t.put("dropContext",null,i),t.put("dropMoving",!1,i)}},s.prototype.makeDrop=function(e){var i="DragAndDropSpace";if(t.get("dropMoving",i)){t.put("dropMoving",!1,i),this.stopDropPropagation=!1;var s,n,o,r,a,l,d,h,u,c,p,f=t.get("dropContext",i),m=t.get("dragContext",i),g=t.get("dragTarget",i),v=this.context;if("DataGrid"==g&&f==this){if(this.dropRuleLine.hide(),t.put("dropContext",null,i),t.put("dragContext",null,i),$(document).unbind("mouseup",this.dropHandler),$(document.getElementById(this.uuid)).parent().css("cursor",""),h=t.get("dragData",i),t.utils.some(v.emitHelper("onDrop",h,e),!1))return;for(s=this.list.slice(),n=h.slice(),r=function(t){return u.id==t.id},a=t.get("dropOver",i),l=a.before,d=a.after,c=0;c<s.length;c++)if(u=s[c]){if(h)if(l){if(l.id==u.id){for(p=0;p<h.length;p++)s.splice(c++,0,h[p]);h=null}}else if(d&&d.id==u.id){if(c==s.length-1)s=s.concat(h),c+=h.length;else for(p=0;p<h.length;p++)s.splice(c+1,0,h[p]),c++;h=null}t.utils.some(n,r)&&s.splice(c--,1)}else s.splice(c--,1);h&&(s=s.concat(h)),f!=m&&m.emit("onDragDrop",n),v.options.checked=v.getCheckedRecords(!0),this.droppedRecords=n,o=v.getScrollPosition(),v.reload({data:s}).scroll(o,!0)}}},s.prototype.initDrag=function(e){var i=this,s=this.getSelection();if(!s.length)return this;var n,o=0,r=this.context,a=$(document),l=(document.documentElement,$(window)),d=$("#"+this.uuid).parent(),h=function(e){if(0==o){if(Math.abs(p.startLeft-e.clientX)>3||Math.abs(p.startTop-e.clientY)>3)if(t.utils.some(r.emitHelper("onDragStart",s,e),!1))u(e);else{var a="DragAndDropSpace";o=1,n=i.makeClonedTable(s,c,e.clientY),d.css("cursor","move"),p.startLeft=p.eventLeft=e.clientX,p.startTop=p.eventTop=e.clientY,p.tableStartLeft=n.positionLeft,p.tableStartTop=n.positionTop,t.put("dragMoving",!0,a),t.put("dragTarget","DataGrid",a),t.put("dragContext",i,a),t.put("dragData",s,a),t.put("dragRelatedTarget",c,a)}}else t.utils.clearSelection(),p.eventLeft=e.clientX,p.eventTop=e.clientY,p.left=p.tableStartLeft+p.eventLeft-p.startLeft,p.top=p.tableStartTop+p.eventTop-p.startTop,r.emit("onDragMove",s,p,e),c.css({left:p.left,top:p.top})},u=function(e){var i="DragAndDropSpace";a.unbind("mousemove",h).unbind("mouseup dblclick",u),l.unbind("blur",u),h=u=null,c.remove(),t.put("dragMoving",!1,i),t.remove("dragRelatedTarget",i),1==o&&(n.destroy(),d.css("cursor",""),r.emit("onDragEnd",s,e)),o=2},c=$('<div class="ut-grid-draggable-body" style="width:'+d.width()+'px">').appendTo(d),p={startLeft:e.clientX,startTop:e.clientY};return a.bind("mousemove",h).bind("mouseup dblclick",u),l.bind("blur",u),this},s.prototype.makeClonedTable=function(e,i,n){var o=new s(t.utils.extend({},this.options,{columns:this.columns,stretchColumns:this.stretchColumns,fillRows:!1,context:null,preventSelection:!0,showRowDetail:!1,mergeRows:!1,checkOnSelect:!1,multiple:!1,draggable:!1,droppable:!1,showFixedLeft:!1,showFixedRight:!1,showFixedBottom:!1,contentTitle:!1,list:null,dropLineStyle:null,checked:this.context.getCheckedRecords(!0)})),r=this.context.find(".r"+this.getRowByRecord(e[0]).uuid).offset(),a=$(document);return r.left-=a.scrollLeft(),r.top=n+10,i.append(o.render({list:e})).css(r),o.positionLeft=r.left,o.positionTop=r.top,o},s.prototype.getCellByElem=function(t){var e,i=this.cellsMap||{},s=t;return t&&!(e=i[t.data("id")])&&t.parents("td").each(function(){return!(e=i[(s=$(this)).data("id")])}),e&&(e.target=s),e||null},s.prototype.handleEditableCell=function(e,i){var s=this,n=this.editableCell,o=this.selectedCell,r=e.target||$(),a=function(){o&&o!=e&&(o.target.removeClass("ut-selected"),s.selectedCell=null),e&&e.editable&&(o!=e?(r.addClass("ut-selected"),s.selectedCell=e):n==e&&(e.editComponent?i?t.utils.clearSelection():s.showEditComponent(e.editComponent,e):r.children(".ut-cell-content").focus()),n!=e&&(i||/list|select|date/.test(e.contentType))&&(i||o==e)&&s.makeEditableCell(e))};return n&&n!=e?this.doneEditableCell(n,function(t){t&&a()}):(a(),this)},s.prototype.makeEditableCell=function(e){var i,s=this,n=e.target,o=t.utils.extend({},e.editorOptions||e.contentOptions,{"class":"ut-edit-cell"}),r=n.children(".ut-cell-wrap"),a=n.children(".ut-cell-content"),l=e.editComponent;if(n.addClass("ut-editing"),!l)switch(e.contentType){case"select":case"list":l="Select",o.value=e.value;break;case"datetime":o.time=o.time||!0;case"date":l="DatePicker",o.value=e.value;break;default:a.attr("contenteditable",!0).addClass("ut-edit-cell").keydown(function(i){if(e.editableCellChanged=!0,t.isEnterKey(i)){if(i.shiftKey||i.metaKey||i.altKey||i.ctrlKey)return;return s.doneEditableCell(e,null),!1}}).children(".ut-empty-holder").remove(),n.css("cursor","text"),t.utils.preventAppendHTML(a),t.utils.moveCursorToEnd(a)}return t.isString(l)&&(r.children(".cell-component").append(i=$("<i>")),o.el=i,o.onBeforeInit=this.proxy(o.onBeforeInit,{record:e.record,cell:e}),l=t.create(l,o),l.on("onChange",t.bind(this.doneEditableCell,this,e,null))),l instanceof t.Component&&this.showEditComponent(e.editComponent=l,e),this.editableCell=e,this},s.prototype.proxy=function(e){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return function(){for(var s=[],n=0;n<arguments.length;n++)s[n-0]=arguments[n];return t.isFunction(e)?e.apply(this,s.concat(i)):void 0}},s.prototype.showEditComponent=function(t,e){if(t&&!t.isDestroyed()){var i,s=this.emptyPreventEvent;t.isFetched()?t.isRendered()?t.off("onBeforeHide",s).once("onBeforeHide",s).click():t.off("onAfterRender",t.click).once("onAfterRender",t.click):((i=e.target||$()).addClass("ut-fetching"),t.once("onAfterFetch",function(){i.removeClass("ut-fetching"),t.off("onAfterRender",t.click).once("onAfterRender",t.click)}))}return this},s.prototype.emptyPreventEvent=function(){return!1},s.prototype.doneEditableCell=function(e,i){var s,n,o=this,r=e.target,a=(r.children(".ut-cell-wrap"),r.children(".ut-cell-content")),l=this.context,d=e.editComponent,h=e.record;switch(i=i||t.voidFunc,d&&d.off("onBeforeHide",this.emptyPreventEvent),e.contentType){case"select":case"list":n=d?d.getText():"";case"date":case"datetime":s=d?d.getValue():"";break;default:s=a.text()}return e.validate(s,h,function(d,h){d?(o.destroyValidateTips(e),e.editComponent||(a.removeAttr("contenteditable").removeClass("ut-edit-cell").unbind("keydown"),r.css("cursor","")),o.updateEditableCell(e,s,n)):(e.editableCellChanged&&(l.resize(),e.editableCellChanged=!1),o.initValidateTips(e,h,t.Validator.rule)),i(d)}),this},s.prototype.updateEditableCell=function(e,i,s){i=t.utils.trim(i);var n=e.target;return e.record[e.field]!=i&&this.setCellContentWithEvent(e,i,s),i!=e.original?(n.addClass("ut-edit-change"),e.dirtied=!0):(n.removeClass("ut-edit-change"),e.dirtied=!1),n.removeClass("ut-editing ut-selected"),this.selectedCell=null,this.editableCell=null,e.editableCellChanged&&(this.context.resize(),e.editableCellChanged=!1),this},s.prototype.getDirtiedRecord=function(){var e=[];return t.utils.forEach(this.cellsMap,function(t){t.dirtied&&e.push(t.record)}),e},s.prototype.setCellContentWithEvent=function(e,i,s){if(e.editable){var n=(e.column,e.record),o=e.field,r=n[o];this.setCellContent(e,i,s),this.context.emit("onRecordChange",n,o,i,r),t.isFunction(e.onChange)&&e.onChange(i,r,n)}return this},s.prototype.setCellContent=function(e,i,s){var n,o,r=e.column,a=e.record,l=e.field,d=(a[l],e.target||this.context.find("td[data-id='"+e.uuid+"']")),h=d.children(".ut-cell-content"),u=void 0!=s?s:i;return e.value=a[l]=void 0==i?s:i,t.isFunction(r.render)&&(u=r.render(i,a,e.isStats)),e.html=t.utils.trim(u),(h.length?h:d).html(t.isEmpty(u)?"<i class='ut-empty-holder ut-nowrap' style='visibility:hidden;'>NaN</i>":u),void 0==(n=r.contentTitle)&&(n=this.options.contentTitle),t.isFunction(n)?n=n(i,a,e.isStats):n===!0&&(n=i),e.contentTitle=n=t.utils.trim(n),(o=this.contentTitle)&&o.currentCell==e&&o.text(n),e.cellInnerHTML=void 0,this},s.prototype.restore=function(t){t&&(this.setCellContentWithEvent(t,t.original),t.target&&t.target.removeClass("ut-error ut-edit-change ut-editing ut-selected"))},s.prototype.clearMarks=function(){return t.utils.forEach(this.cellsMap,function(t){t.dirtied&&(t.original=t.value,t.dirtied=!1,t.target&&t.target.removeClass("ut-edit-change"))}),this},s.prototype.initValidateTips=function(e,i,s){var n,o=e.target;return t.isFunction(e.onInvalid)&&e.onInvalid(i,s,e.record)===!1?n=null:(n=e.validateTips,n&&!n.isDestroyed()||(n=t.create("Tips",{type:"error",elem:o})),t.isEmpty(i=t.utils.trim(i))?n.hide():n.show(i).setSide().getRootElement().css("zIndex",10)),o.addClass("ut-error"),e.validateTips=this.validateTips=n,this},s.prototype.destroyValidateTips=function(t){var e=t?t.validateTips:this.validateTips;return e&&(e.destroy(),this.validateTips=null),t&&(t.validateTips=null,t.target.removeClass("ut-error")),this},s.prototype.getSelection=function(t){var e=this.rowsMap,i=[];return this.context.find("tr.ut-selected."+this.rowClass,document.getElementById(this.uuid)).each(function(){var s,n=$(this);n.hasClass("ut-stats")||n.hasClass("ut-embed")||(s=e[n.data("id")].record,i.push(t?s.id:s))}),i},s.prototype.select=function(e,i){void 0===i&&(i=!0);var s,n,o=this.context,r="ut-selected",a=[];return t.isString(e)&&(e=e.split(",")),t.isArray(e)||(e=[e]),t.utils.each(e,function(t){if((s=this.getRowByRecord(t,!0))&&(n=o.find("tr.r"+s.uuid)).length&&!n.hasClass("ut-stats")&&!n.hasClass("ut-embed")&&(i&&!this.multiple&&o.find("tr."+this.rowClass+"."+r).not(".ut-stats,.ut-embed").removeClass(r),n.toggleClass(r,!!i),i&&a.push(s.record),i&&!this.multiple))return!1},this),a.length&&this.emit("onSelect",this.multiple?a:a[0]),this},s.prototype.clearSelection=function(){this.context.find("tr.ut-selected."+this.rowClass).removeClass("ut-selected")},s.prototype.getRowByRecord=function(e,i){return this.recordsMap[t.isObject(e)?e.id:e]||(i?null:{uuid:t.utils.uuid(10)})},s.prototype.makeCell=function(e){var i,s,n,o,r,a,l,d,h,u=this.columns,c=this.rows,p=this.mergeRows,f=this.showRowDetail;for(l=0;l<e.length;l++)if(t.isObject(a=e[l])){for(i=(c[l]=c[l]||this.initRow(l,a)).cols,d=0;d<u.length;d++)if(s=u[d],n=i[d]=i[d]||this.initCell(a,s,l),f||s.flag||(void 0==s.merge?!p:!s.merge))n.rowSpan=1;else if(!n.merged&&!t.isEmpty(n.html)){for(h=l+1;h<e.length;h++)if(t.isObject(o=e[h])){if(r=(c[h]=c[h]||this.initRow(h,o)).cols[d]=this.initCell(o,s,h),r.html!==n.html)break;r.merged=!0}else e.splice(h--,1);n.rowSpan=h-l}}else e.splice(l--,1);return this},s.prototype.makeStatsRowGroup=function(e){var i,s,n,o=this.statsRows;return t.utils.each(this.columns,function(r){t.isArray(i=r.stats)||(i=[i]);for(var a=0;a<i.length;a++)(s=this.getStatsHandler(i[a]))?(n=(o[a]=o[a]||this.initRow(a,{})).cols,n[r.colIndex]=this.initCell(this.execStats(e,r.field,s),r,a,!0)):i.splice(a--,1)},this),t.utils.each(this.columns,function(t){for(var e,i,s,n=0,r=t.colIndex,a="";n<o.length;n++)(e=o[n].cols)[r]||((s={isStats:!0,value:a,result:a})[i=t.field]=a,e[r]=this.initCell(s,t,n,!0))},this),this},s.prototype.getStatsHandler=function(e){var i;return t.isFunction(e)?e:(i=s.STATS[t.utils.trim(e+"").toLowerCase()])?i:null},s.prototype.execStats=function(e,i,s){var n={isStats:!0,result:s(t.utils.map(e,function(t){return t[i]}),e),value:""};return n[i]=n.value=n.result,n},s.prototype.initRow=function(e,i){var s=t.utils.uuid(12).toLowerCase(),n=t.utils.uuid(12).toLowerCase();return this.rowsMap[s]=this.rowsMap[n]=this.recordsMap[i.id]={uuid:s,embedUUID:n,isEmpty:!t.utils.keys(i).length,index:e,record:i,cols:[],checked:t.utils.some(this.checked,function(e){return(t.isObject(e)?e.id:e)===i.id})}},s.prototype.getRowByIndex=function(e){var i=null;return t.utils.forEach(this.rowsMap,function(t,s,n){var o=t.cols[0]||{};if(!o.isStats&&t.index==e)return i=t,!1}),i},s.prototype.getCellByIndex=function(e,i){var s=null;return t.utils.forEach(this.cellsMap,function(t,n,o){if(!t.isStats&&t.rowIndex==e&&t.colIndex==i)return s=t,!1}),s},s.prototype.getCellByRecordAndField=function(e,i){var s=this.getRowByRecord(e),n=null;if(s){var o=s.index;t.utils.forEach(this.cellsMap,function(t,e,s){if(!t.isStats&&t.rowIndex==o&&t.column.field==i)return n=t,!1})}return n},s.prototype.initCell=function(e,i,s,n){var o,r,a,l,d=i.field,h=(n?this.statsRows:this.rows)[s],u=e[d],c={},p=u;return h.isEmpty||(t.isFunction(i.render)&&(p=i.render(u,e,!!n)),void 0==(r=i.contentTitle)&&(r=this.options.contentTitle),t.isFunction(r)?r=r(u,e,!!n):r===!0&&(r=u),n||(t.isFunction(o=i.editable)&&(o=!!o(p,e)),o&&(t.isFunction(l=i.contentType)&&(l=l(p,e)),t.isFunction(a=i.validate)||(t.isString(a)&&(a=a.replace(/\s+/g," ").split(" ")),a=this.initValidate(c,a))))),c=t.utils.extend(c,i,{row:h,uuid:t.utils.uuid(6).toLowerCase(),value:u,original:u,record:e,colSpan:1,dirtied:!1,merged:!1,isStats:!!n,rowSpan:n?1:0,rowIndex:s,html:t.utils.trim(p),column:i,contentTitle:r,contentType:l,editable:!!o,validate:a,restore:t.bind(this.restore,this,c)}),o&&(this.cellEditable=!0),this.cellsMap[c.uuid]=c,c},s.prototype.initValidate=function(e,i){return e.validateRules=[],t.utils.each(i,function(i){t.isString(i)&&(i={name:i}),e.validateRules.push(t.Validator.makeRule(i))}),function(e,i,s){t.Validator.validate(e,this.validateRules,s)}},s.prototype.destroy=function(){if(!this.destroyed){if(this.context){var e="."+this.space,i="."+this.rowClass;this.context.unbind("click",e+".ut-trigger").unbind("mousedown",i).unbind("click",i).unbind("dblclick",i).unbind("contextmenu",i).unbind("hover",i).unbind("hover",i+">td").unbind("hover","tr"+i+",."+this.contextClass)}this.off(),t.utils.forEach(this,function(t,e){this[e]=null},this),this.destroyed=!0}return this},s.template='<table id="{{uuid}}" class="{{uuid | getTableClass}} ut-grid-tbody" style="{{style}}" border="0" cellpadding="0"  cellspacing="0">  <tbody>  <tr class="ut-rule-wrap {{rule}}">  {{each columns as col}}  <td data-id="{{col.ruleClass}}" class="ut-rule ut-scale {{col.ruleClass}} {{col | getColumnClass}}"  style="height:0;width:{{col.width}}"></td>  {{/each}}  <td class="ut-rule" style="height:0;width:{{stretch ? 0 : \'\'}}"></td>  </tr>  {{each rows as row}}  <tr data-id="{{row.uuid}}" class="{{rowClass}} {{row | getRowClass}} r{{row.uuid}}">  {{each row.cols as cell}}  {{if (!cell.merged && (!fixed || fixed === cell.fixed))}}  <td data-id="{{cell.uuid}}" style="{{cell | getCellStyleRule}}" class="{{cell.column | getColumnClass : cell}}"  rowspan="{{cell.rowSpan}}">  {{if cell.editable}}  <span class="ut-cell-wrap">  <span class="cell-border-n"></span>  <span class="cell-border-s"></span>  <span class="cell-border-w"></span>  <span class="cell-border-e"></span>  <span class="cell-content-icon"></span>  <span class="cell-component"></span>  </span>  <span class="cell-icon-change"></span>  <span class="ut-cell-content">{{#cell | getContent}}</span>  {{else}}  {{#cell | getContent}}  {{/if}}  </td>  {{/if}}  {{/each}}  <td class="ut-rule" style="width:{{stretch ? 0 : \'\'}}">  <div class="ut-scale {{row.uuid}}"></div>  </td>  </tr>  {{if showRowDetail}}  <tr data-id="{{row.embedUUID}}" class="{{rowClass}} ut-embed ut-hidden {{row | getRowClass : true}} r{{row.uuid}}">  <td colspan="{{colLength}}">  {{if !fixed}}  <div id="{{row.embedUUID}}"></div>  {{/if}}  </td>  <td class="ut-rule" style="width:{{stretch ? 0 : \'\'}}">  <div class="ut-scale {{row.embedUUID}}"></div>  </td>  </tr>  {{/if}}  {{/each}}  {{each statsRows as row}}  <tr data-id="{{row.uuid}}" data-stats="stats"  class="{{rowClass}} ut-stats {{row | getRowClass : false,true}} r{{row.uuid}}">  {{each row.cols as cell}}  {{if (!fixed || fixed === cell.fixed)}}  <td class="{{cell.column | getColumnClass : cell}}" style="{{cell | getCellStyleRule}}">  {{if cell.html===""}}  <i style="visibility:hidden">NaN</i>  {{else}}  {{#cell.html}}  {{/else}}  </td>  {{/if}}  {{/each}}  <td class="ut-rule" style="width:{{stretch ? 0 : \'\'}}">  <div class="ut-scale {{row.uuid}}"></div>  </td>  </tr>  {{/each}}  </tbody> </table>',s.tplTitle='<span class="ut-grid-tips ut-shadow" style="display:none"></span>',s.STATS={average:function(e){for(var i=0,s=0;i<e.length;i++)s+=+t.utils.trim(e[i])||0;return(s/(i||1)).toFixed(2)},sum:function(e){for(var i=0,s=0;i<e.length;i++)s+=+t.utils.trim(e[i])||0;return s}},s}(t.EventEmitter),s=function(e){function i(i){e.call(this),this.context=i.context,this.space=t.utils.uuid(12).toLowerCase(),this.init(i).makeColumnGroup(this.columns).makeRowGroup(this.columns)}return __extends(i,e),i.prototype.getTableClass=function(t){return t+(this.nowrap?" ut-grid-nowrap":"")},i.prototype.getRuleClassName=function(e){if(void 0!=e.headRuleClass)return e.headRuleClass;var i=e.headClassName;return t.isEmpty(i)&&(i=e.className),e.headRuleClass=t.isEmpty(i)||t.isFunction(i)?"":i+""},i.prototype.getColumnClass=function(e){if(void 0!=e.headColumnClass)return e.headColumnClass;var i=e.headClassName,s=e.headAlign||e.align;return t.isEmpty(i)&&(i=e.className),e.headColumnClass=t.utils.trim((t.isEmpty(i)||t.isFunction(i)?"":i)+(e.colSpan?"":" ut-hidden")+(/(left|right|center)/i.test(s)?" ut-align-"+{left:"lt",right:"rt",center:"ct"}[RegExp.$1]:"")+(e.headNoWrap?" ut-nowrap":"")+(!e.fixed&&e.resizable?" ut-resize":"")+(e.effective&&e.sortable?" ut-sort":""))},i.prototype.getStyle=function(e){if(void 0!=e.headStyleRule)return e.headStyleRule;var i,s=((e.group||"").length?t.utils.trim(e.headGroupStyle):null)||e.headStyle;return t.isEmpty(s)&&(s=t.utils.trim(e.style)),t.isObject(s)&&(i=[],t.utils.forEach(s,function(t,e){i.push(e.replace(/[A-Z]/,"-$&").toLowerCase()+":"+t)}),s=i.join(";")),e.headStyleRule=t.isEmpty(s)||t.isFunction(s)?"":s},i.prototype.getTitle=function(e){if(!e.flag&&void 0!=e.headInnerHTML)return e.headInnerHTML;var i=t.utils.trim(e.htmlTitle);return t.isEmpty(i)&&t.isString(i=t.utils.trim(e.title))&&(i=t.utils.escapeHTML(i)),e.field==="CK"+e.flag||e.field==="RD"+e.flag?"CK"+e.flag===e.field&&(i="<input type='checkbox' class='ut-check-all "+this.space+"'>"):(e.effective&&e.sortable&&(i="<div class='ut-sort-wrap'>"+i+"</div>"),e.fixed||!e.resizable||t.isEmpty(i)||(i="<div class='ut-resize-wrap'>"+i+"<span class='ut-adjuster'></span></div>")),e.headInnerHTML=t.isEmpty(i)?"":i},i.prototype.init=function(e){var s,n,o,r,a=this,l="@"+(this.uuid=t.utils.uuid(12).toLowerCase());return this.rule="rule"+this.uuid,this.adjusterLineSelector=e.adjusterLineSelector,this.nowrap=!!e.headNoWrap,this.stretchColumns=!!e.stretchColumns,this.layout=e.layout,this.columns=s=t.utils.copy(e.columns)||[],this.colsMap={},this.effectiveColumns=[],this.rows=[],this.depth=0,s.length&&(e.showRowDetail&&s.unshift({field:"EP"+l,flag:l,fixed:!0,className:"ut-expander"}),(e.checkbox||e.radio)&&s.unshift({field:(e.radio?"RD":"CK")+l,flag:l,fixed:!0,className:"ut-check"}),e.showRowIndex&&s.unshift({field:"RI"+l,flag:l,fixed:!0,nowrap:!0,className:"ut-index",title:e.rowIndexTitle}),this.leftFixedColumns=n=[],this.rightFixedColumns=o=[],this.fixedNoneColumns=r=[],t.utils.each(s,function(t){/right/i.test(t.fixed)?(t.fixed="right",o.push(t)):t.fixed?(t.fixed="left",n.push(t)):(t.fixed="",r.push(t))}),this.columns=n.concat(r,o)),this.template=new t.Template({source:i.template,filterContext:this,filters:this}),this.context.on("onCheckAll",function(t,e){!a.destroyed&&a.check(e)}).on("onCheck",function(t,e){!e&&!a.destroyed&&a.check(!1)}),this},i.prototype.render=function(e){e=t.utils.object(e);var i=e.fixed||"";return this.template.render({rulesRow:this.effectiveColumns,rows:this.rows,uuid:i?"":this.uuid,rule:i?"":this.rule,style:!i&&this.stretchColumns?"width:100%":"",stretch:!!this.stretchColumns,fixed:i})},i.prototype.ready=function(){var e=this,i="."+this.space;this.context.bind("click",i+".ut-check-all",function(t){e.emit("onCheck",!!t.currentTarget.checked)}).bind("mousedown","."+this.uuid+" .ut-adjuster",function(i){var s=e.context,n=s.getRootElement(),o=$(i.currentTarget).parents("th:first"),r=e.colsMap[o.data("id")].resizeIndex,a=e.effectiveColumns;if(!a[r].fixed){var l,d,h=s.find("."+e.rule).children(),u=h.eq(r),c=h.eq(r+1),p=s.find(e.adjusterLineSelector),f=s.bodyScrollLeft,m=c.position().left-f,g=u.width(),v=c.width(),y=Math.min(m-(g-60),m),b=Math.max(m+(v-60),m),x=i.clientX;t.utils.clearSelection(),n.addClass("ut-txt-select-none").css("cursor","col-resize"),p.css("left",m).removeClass("ut-hidden"),$(document).one("mouseup",function(){$(document).off("mousemove",l),d=p.position().left-m,p.addClass("ut-hidden"),n.removeClass("ut-txt-select-none").css("cursor",""),g=(u=a[r]).width=g+d+"px",v=(c=a[r+1]).width=v-d+"px",a={},a[u.ruleClass]=g,a[c.ruleClass]=v,e.emit("onColumnResize",a),l=null}).on("mousemove",l=function(t){p.css("left",Math.min(Math.max(m+t.clientX-x,y),b))})}}).bind("click","."+this.uuid+" .ut-sort",function(t){var i=$(t.currentTarget),s=e.colsMap[i.data("id")],n=i.hasClass("ut-sort-desc");i.removeClass("ut-sort-asc ut-sort-desc").addClass(n?"ut-sort-asc":"ut-sort-desc"),e.emit("onSort",{field:s.field,sorter:s.sorter,order:n?"asc":"desc"})})},i.prototype.check=function(t){return this.context.find("."+this.space+".ut-check-all").attr("checked",!!t),this},i.prototype.makeColumnGroup=function(e){return t.utils.treeWalker(e,function(e,i,s,n){var o,r,a,l=e.group||[];if(e.uuid=t.utils.uuid(6).toLowerCase(),this.colsMap[e.uuid]=e,(e.parentGroup=i)&&i.hidden&&(e.hidden=!0),i&&(e.fixed=i.fixed),e.hidden?e.colSpan=0:l.length||isNaN(r=+e.span)?e.colSpan=1:e.colSpan=r?Math.max(r,1):0,e.rowIndex=i?i.rowIndex+1:0,e.level=i?i.level+1:0,e.colIndex=-1,e.resizeIndex=-1,e.groupIndex=s,e.ruleClass="",e.className=t.utils.trim(e.className),i?(void 0==e.resizable&&(e.resizable=!!i.resizable),void 0==e.merge&&void 0!=i.merge&&(e.merge=!!i.merge),void 0==e.sortable&&(e.sortable=!!i.sortable),e.headNoWrap=void 0==e.headNoWrap?i.headNoWrap:!!e.headNoWrap,e.nowrap=void 0==e.nowrap?i.nowrap:!!e.nowrap,e.align=void 0==e.align?i.align:t.utils.trim(e.align)||"",e.headAlign=void 0==e.headAlign?i.headAlign:t.utils.trim(e.headAlign||e.align)||"",e.className=void 0==e.className?i.className:t.utils.trim(e.className),e.headClassName=void 0==e.headClassName?i.headClassName:t.utils.trim(e.headClassName)||"",e.style=void 0==e.style?i.style:t.utils.trim(e.style),e.headStyle=void 0==e.headStyle?i.headStyle:t.utils.trim(e.headStyle)||""):i||(e.resizable=!!e.resizable,e.sortable=!!e.sortable,e.headNoWrap=!!e.headNoWrap,e.nowrap=!!e.nowrap,e.align=t.utils.trim(e.align),e.headAlign=t.utils.trim(e.headAlign||e.align)||"",e.className=t.utils.trim(e.className),e.headClassName=t.utils.trim(e.headClassName)||"",e.style=t.utils.trim(e.style),e.headStyle=t.utils.trim(e.headStyle)),s==n.length-1)for(i&&(i.length=n.length),this.depth=Math.max(e.level,this.depth);e&&(i=e.parentGroup);){for(i.colSpan=0,l=i.group,o=l.length,a=0;a<o;a++)i.colSpan+=void 0==(r=l[a].colSpan)?1:r;e=i}},!1,"group",this,null),this},i.prototype.makeRowGroup=function(e){var i,s;if(t.utils.treeWalker(e,function(e){var i,s=this.rows,n=this.effectiveColumns,o=e.group||[],r=e.parentGroup,a=e.rowIndex,l=(s[a]=s[a]||{uuid:t.utils.uuid(12).toLowerCase(),index:a,cols:[]}).cols;if(l.push(e),e.rowSpan=(o.length?0:this.depth-e.level)+1,e.colSpan&&!o.length){if(e.effective=!0,e.colIndex=e.resizeIndex=n.length,e.ruleClass=t.utils.uuid(12).toLowerCase(),i=e.width=/^\s*([1-9]\d?|100)\s*%\s*$/.test(i=e.width)?RegExp.$1+"%":/^\s*([1-9]\d*)\s*(?:px)?\s*$/i.test(i)?RegExp.$1+"px":"",""!==i&&(this.stretchColumns=!0),n.push(e),r)do r.resizeIndex=e.resizeIndex;while(r=r.parentGroup)}else e.width="",e.colSpan>1&&(e.headAlign="center")},!1,"group",this,null),e=this.effectiveColumns,(s=e.length)>1?((i=e[s-1]).resizable&&!i.fixed&&(e[s-2].resizable=!0),t.utils.each(e.slice().reverse(),function(t){if(!t.fixed)return t.resizable=!1})):i=e[0],i)do i.resizable=!1;while(i=i.parentGroup);return this.multiple=this.rows.length>1,this},i.prototype.destroy=function(){if(!this.destroyed){if(this.context){var e="."+this.space;this.context.unbind("click",e+".ut-check-all").unbind("mousedown","."+this.uuid+" .ut-adjuster").unbind("click","."+this.uuid+" .ut-sort")}this.off(),t.utils.forEach(this,function(t,e){this[e]=null},this),this.destroyed=!0}return this},i.template='<table id="{{uuid}}" class="{{uuid | getTableClass}} ut-grid-thead" style="{{style}}" border="0" cellpadding="0"  cellspacing="0">  <thead>  <tr class="ut-rule-wrap {{rule}}">  {{each rulesRow as col}}  {{if (!fixed || col.fixed===fixed)}}  <th data-id="{{col.ruleClass}}" data-fixed="{{col.fixed}}"  class="ut-rule ut-scale {{col.ruleClass}} {{col | getRuleClassName}}" style="width:{{col.width}}"></th>  {{/if}}  {{/each}}  <th class="ut-rule" style="height:0;width:{{stretch ? 0 : \'\'}}"></th>  </tr>  {{each rows as row}}  <tr data-id="{{row.uuid}}">  {{each row.cols as col}}  {{if (!fixed || col.fixed===fixed)}}  <th data-id="{{col.uuid}}" class="{{col | getColumnClass : uuid}}" style="{{col | getStyle}}"  rowspan="{{col.rowSpan}}" colspan="{{col.colSpan}}">  {{#col | getTitle}}  </th>  {{/if}}  {{/each}}  <th class="ut-rule" style="width:{{stretch ? 0 : \'\'}}">  <div class="ut-scale {{row.uuid}}"></div>  </th>  </tr>  {{/each}}  </thead> </table>',i}(t.EventEmitter)}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.setCurrentlyObj=function(t,e,i){this.currentlyObj={obj:this.find(t),max:e,step:i}},i.prototype.getDefaultDate=function(){var t=new Date,e=this.minDate,i=this.maxDate;return this._isDisabled(t)?i&&+t>+i?i:e&&+t<+e?e:t:t},i.prototype.setTimeToHidden=function(){this.find(".ut-hdTime").val(this.find(".ut-time-hour").val()+":"+this.find(".ut-time-minute").val()+":"+this.find(".ut-time-second").val())},i.prototype.getTime=function(){return this.getState("time")?this.find(".ut-hdTime").val():""},i.prototype.init=function(e){var i;i=/today|now/.test(e.value)?this.date=new Date:this.date=t.utils.dateParser(t.utils.trim(e.value)||""),e.time&&(this.time=t.utils.parseTime(t.utils.dateFormat(i||new Date,"HH:mm:ss"))),(this.format=t.utils.trim(e.format))||(this.format="yyyy-MM-dd",this.time&&(this.format+=" HH:mm:ss")),this.value=i?t.utils.dateFormat(i,this.format):"",e.popupWidth=200,t.isFunction(e.onChange)&&this.on("onChange",e.onChange)},i.prototype.click=function(){return this.readonly||this.disabled||this._isFocused||(this._refreshPicker(this.date||this.getDefaultDate(),!0).emit("focus"),this._isFocused=!0),this.emit("click")},i.prototype.initState=function(e,i){return{date:this.date||new Date,id:this.id,name:this.name,value:this.value,time:this.time,yearList:null,menuYear:null,calender:this._getCalender(this.date,this._choiceDate||this.date),row:0,column:10,timeButtonCls:this.time?"ut-button-time":"",style:t.utils.getStyle({width:i.width,height:i.height})}},i.prototype.ready=function(e){this.listenTo("date",function(t){this.setState("calender",this._getCalender(t,this._choiceDate||this.date))}).listenTo("value",function(s,n){var o;this.emit("onChange",s,n),(o=t.get(e.before,"COMPONENT"))instanceof i&&!o.destroyed&&o.setMinDate(s),(o=t.get(e.after,"COMPONENT"))instanceof i&&!o.destroyed&&o.setMaxDate(s),s||(this.date=null,this.getState("time")&&(this.time=""))});var s=function(t,e,i){var s=$(i.target),n=s.val(),o=0;o=/\d+/.test(n)?parseInt(n):0,o>t&&(o=t),s.val(o),this.setTimeToHidden()};this.bindTimeBoxChangeEvent("::popup .ut-time-hour",t.bind(s,this,23,0)).bindTimeBoxChangeEvent("::popup .ut-time-minute",t.bind(s,this,59,0)).bindTimeBoxChangeEvent("::popup .ut-time-second",t.bind(s,this,59,0)),this.setMaxDate(e.maxDate).setMinDate(e.minDate)},i.prototype.bindTimeBoxChangeEvent=function(e,i){var s=t.browserVersion;return t.isIE&&s<=9&&(s<9?this.bind("propertychange",e,i):9==s&&this.bind("keyup blur",e,i)),this.bind("input",e,i),this},i.prototype.setMaxDate=function(e){return e="today"===e?new Date:t.utils.dateParser(e),e&&this.minDate&&+this.minDate>+e?void t.print("The max date can not before the min date.","error"):(this.maxDate=e,this.setValue(this.getState("value")))},i.prototype.setMinDate=function(e){return e="today"===e?new Date:t.utils.dateParser(e),e&&this.maxDate&&+this.maxDate<+e?void t.print("The min date can not after the max date.","error"):(this.minDate=e,this.setValue(this.getState("value")))},i.prototype.setValue=function(i){var i=t.utils.trim(i);return t.isEmpty(i)||!(i=t.utils.dateParser(i))||this._isDisabled(i)?e.prototype.setValue.call(this,""):e.prototype.setValue.call(this,t.utils.dateFormat(i,this.format)),this},i.prototype._hidePanel=function(){this._isFocused&&!t.utils.some(this.emitHelper("onBeforeHide"),!1)&&(this.hide(this.tplDatePanel,"fadeout"),this._isFocused=!1,this.emit("blur"))},i.prototype._refreshYearMenu=function(t){for(var e=t-5,i=[];e<t+5;e++)i.push(e);return this.setState({yearList:i,menuYear:t})},i.prototype._refreshPicker=function(e,i){
return this.getState("time")&&(this.time=t.utils.dateFormat(e,"HH:mm:ss")),this.setState("date",e,i).hide([this.tplYearMenu,this.tplMonthMenu]).showPopup(this.tplDatePanel,null,"fadein")},i.prototype._getCalender=function(t,e){var i,s,n=new Date,t=t||n,o=t.getFullYear(),r=t.getMonth(),a=t.getHours(),l=t.getMinutes(),d=t.getSeconds(),h=n.getFullYear(),u=n.getMonth(),c=n.getDate(),p=new Date(o,r,1).getDay(),f=new Date(o,r,0).getDate(),m=new Date(o,r+1,0).getDate(),g=0,v=p-g,y=[],b=[];v=0===v?7:v<0?v+7:v,y.push(b);for(var x,w=0;w<42;w++)i={date:new Date(o,r,1,a,l,d)},w>0&&w%7===0&&y.push(b=[]),0!==(x=(g+w)%7)&&6!==x||(i.isWeekend=!0),w<v?(i.isOther=!0,s=f-v+w+1,i.date.setMonth(r-1)):(s=w-v+1)>m?(i.isOther=!0,i.date.setMonth(r+1),s-=m):s===c&&r===u&&o===h&&(i.isToday=!0),i.day=s,i.date.setDate(s),e&&(t=i.date,e.getDate()==s&&e.getMonth()==t.getMonth()&&e.getFullYear()==t.getFullYear()&&(i.isSelected=!0)),this._isDisabled(i.date)&&(i.isDisabled=!0),b.push(i);return y},i.prototype._isDisabled=function(t){if(this.maxDate||this.minDate){var e,i=t;if(i=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),(e=this.maxDate)&&+new Date(e.getFullYear(),e.getMonth(),e.getDate())<i)return!0;if((e=this.minDate)&&+new Date(e.getFullYear(),e.getMonth(),e.getDate())>i)return!0}return!1},i.initRenderDelay=0,i.template=["<div class='ut-box ut-date' style='{{style}}'>","    <div class='ut-wrap'>","       {{include tplDateInput}}","    </div>","   {{include tplDatePanel}}","</div>"],i.tplDateInput=["<input id='{{id}}' readonly='readonly' unselectable='on' name='{{name}}' value='{{value}}' autocomplete='off'>"],i.tplDatePanel=["<div data-pseudo='popup' class='ut-date ut-popup ut-shadow ut-hidden'>","{{include tplTitle}}","{{include tplBody}}","</div>"],i.tplTitle=["<div class='ut-title ut-txt-select-none'>","   <span class='ut-ico ut-prev-y' data-year='-1' data-month='0'></span>","   <span class='ut-ico ut-prev-m' data-year='0' data-month='-1'></span>","   <span class='ut-ico ut-next-m' data-year='0' data-month='1'></span>","   <span class='ut-ico ut-next-y' data-year='1' data-month='0'></span>","   {{include tplHeader}}","   {{include tplYearMenu}}","   {{include tplMonthMenu}}","</div>"],i.tplHeader=["<div>","   <span class='ut-text' data-role='year' title='点击选择年份'>{{date | dateFormat : 'yyyy 年'}}</span>","   <span class='ut-text' data-role='month' title='点击选择月份'>{{date | dateFormat : 'MM 月'}}</span>","</div>"],i.tplYearMenu=["<div data-role='year' data-year='{{menuYear}}' class='ut-shadow ut-menu ut-txt-select-none ut-date-y'>","{{each yearList as year}}","   <a name='{{year}}'>{{year}}</a>","{{/each}}","   <span class='ut-clear'></span>","   <div class='ut-date-page'>","       <a name='prev'>&nbsp;«&nbsp;</a>","       <a class='ut-page-line'>-----</a>","       <a name='next'>&nbsp;»&nbsp;</a>","   </div>","</div>"],i.tplMonthMenu=["<div data-role='month' class='ut-shadow ut-menu ut-date-m'>","    <a name='0'>一月</a><a name='1'>二月</a><a name='2'>三月</a><a name='3'>四月</a><a name='4'>五月</a>","    <a name='5'>六月</a><a name='6'>七月</a><a name='7'>八月</a><a name='8'>九月</a>","    <a name='9'>十月</a><a name='10'>十一</a><a name='11'>十二</a>","</div>"],i.tplBody=["<div class='ut-wrap'>","   {{include tplCalender}}","   {{include tplBtnBar}}","</div>"],i.tplCalender=["<table class='ut-main ut-txt-select-none' cellspacing='0' cellpadding='0' border='0'>","   <thead class='ut-head'>","       <tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr>","   </thead>","   <tbody class='ut-body'>","   {{for week in calender}}","       <tr>","       {{for day in week}}","           <td class='{{day | getDayClassName}}' data-time='{{+day.date}}'>{{day.day}}</td>","       {{/for}}","       </tr>","   {{/for}}","   </tbody>","</table>"],i.tplTimeBar=["<div class='ut-time'>","{{include tplTimeSelectBody}}","</div>"],i.tplTimeSelectBody=["<div class='ut-time-timeBody ut-txt-select-none'>","<input type='hidden' class='ut-hdTime' value='{{time}}' />","<ul>","   <li><input class='ut-time-hour ut-tc' maxlength='2' value='{{date.getHours()}}'>:</li>","   <li><input class='ut-time-minute ut-tc' maxlength='2' value='{{date.getMinutes()}}'>:</li>","   <li><input class='ut-time-second ut-tc' maxlength='2' value='{{date.getSeconds()}}'></li>","</ul>","<div class='ut-time-step'><input type='button' class='ut-time-step-btnAdd' > <input type='button' class='ut-time-step-btnMinus'></div>","<div class='ut-time-select'>","   <div class='ut-time-select-hour ut-shadow'>","       <table cellspacing='0' cellpadding='0' border='0<tr' class='ut-time-tabel' >","          {{for row in 4 RIndex}}","             <tr>","                  {{for column in 6 CIndex}}","                      <td>{{RIndex*6+CIndex }}</td>","                  {{/for}}","              </tr>","          {{/for}}","       </table>","   </div>","   <div class='ut-time-select-minute ut-shadow'>","       <table cellspacing='0' cellpadding='0' class='ut-time-tabel' >","          {{for row in 2 RIndex}}","             <tr>","                  {{for column in 6 CIndex}}","                      <td>{{RIndex*30+CIndex*5}}</td>","                  {{/for}}","              </tr>","          {{/for}}","       </table>","   </div>","   <div class='ut-time-select-second ut-shadow'>","       <table cellspacing='0' cellpadding='0' border='0<tr' class='ut-time-tabel' >","             <tr>","                  {{for column in 4 CIndex}}","                      <td>{{CIndex*15}}</td>","                  {{/for}}","              </tr>","       </table>","   </div>","</div>","</div>"],i.tplBtnBar=["<div class='ut-foot'>","{{if time}}","   {{include tplTimeSelectBody}}","{{/if}}","{{if time}}","   <span class='ut-button {{timeButtonCls}}' data-role='confirm'>确定</span>","{{else}}","   <span class='ut-button {{timeButtonCls}}' data-role='today'>今天</span>","{{/else}}","   <span class='ut-button {{timeButtonCls}}' data-role='clear'>清除</span>","</div>"],i.filters={dateFormat:t.utils.dateFormat,getDayClassName:function(t){var e="";return t.isOther&&(e+="ut-date-other "),t.isWeekend&&(e+="ut-date-weekend "),t.isToday&&(e+="ut-date-today "),t.isSelected&&(e+="ut-selected "),t.isDisabled&&(e+="ut-disabled "),e},getYear:function(t){return t.getFullYear()},getMonth:function(t){return t.getMonth()+1}},i.events={"click .ut-date":function(){this.click()},"click document":function(t){this._isFocused&&t.srcComponent!==this&&this._hidePanel()},"'click dblclick' ::popup .ut-title .ut-ico":function(t){var e=$(t.currentTarget),i=this.getState("date");i.setFullYear(i.getFullYear()+ +e.data("year")),i.setMonth(i.getMonth()+ +e.data("month")),this._refreshPicker(i)},"click ::popup .ut-title .ut-text":function(t){var e=$(t.currentTarget),i=e.data("role"),s=this.tplYearMenu,n=this.tplMonthMenu;"month"==i?this.hide(s).show(n):"year"==i&&this.hide(n)._refreshYearMenu((this.getState("date")||new Date).getFullYear()).show(s)},"'click dblclick' ::popup .ut-menu":function(t){var e,i=$(t.currentTarget),s=$(t.target),n=i.data("role"),o=s.attr("name"),r=parseInt(o,10),a=this.getState("date")||new Date;if("year"==n){if(e=i.data("year"),"prev"==o)return void this._refreshYearMenu(e-10);if("next"==o)return void this._refreshYearMenu(e+10);if(isNaN(r))return;a.setFullYear(r)}else if("month"==n){if(isNaN(r))return;a.setMonth(r)}this._refreshPicker(a)},"click ::popup .ut-body td:not(.ut-disabled)":function(e){var i=$(e.currentTarget),s=new Date((+i.data("time")));this.getState("time")?(this._choiceDate=s=t.utils.dateParser(t.utils.dateFormat(s,"yyyy-MM-dd")+" "+this.time),this.setState("date",s).hide([this.tplYearMenu,this.tplMonthMenu])):(this.date=s,this.setState("value",this.value=t.utils.dateFormat(this.date,this.format)),this._hidePanel())},"click ::popup .ut-foot .ut-button":function(e){if(!this.readonly){var i,s,n,o=$(e.currentTarget).data("role"),r=t.utils.dateFormat;switch(o){case"confirm":this._isDisabled(s=this._choiceDate||this.getState("date"))?n=!0:(i=this.find(".ut-hdTime"),this.date=t.utils.dateParser(r(s,"yyyy-MM-dd")+" "+t.utils.parseTime(i.val())),i.val(this.time=r(this.date,"HH:mm:ss")),this.value=r(this.date,this.format)),this._choiceDate=null;break;case"today":this._isDisabled(s=new Date)?n=!0:this.value=r(this.date=s,this.format);break;case"clear":this.date=this.getDefaultDate(),this.value=""}!n&&this.setState({value:this.value,time:this.time,date:this.date})}this._hidePanel()},"mouseover ::popup .ut-time-timeBody td":function(t){this.find(".ut-time-timeBody td").removeClass("ut-time-timeBody-background"),$(t.currentTarget).addClass("ut-time-timeBody-background")},"mouseover ::popup .ut-clock":function(t){this.find(".ut-clock").removeClass("ut-time-timeBody-background"),$(t.currentTarget).addClass("ut-time-timeBody-background")},"click ::popup .ut-time-hour":function(t){"block"==this.find(".ut-time-select-hour").css("display")?this.find(".ut-time-select div").hide():(this.find(".ut-time-select div").hide(),this.find(".ut-time-select-hour").show(),this.find(".ut-time-select").css("top","122px").css("left","2px"),$(t.currentTarget).select()),this.setCurrentlyObj(".ut-time-hour",23,1)},"click ::popup .ut-time-minute":function(t){"block"==this.find(".ut-time-select-minute").css("display")?this.find(".ut-time-select div").hide():(this.find(".ut-time-select div").hide(),this.find(".ut-time-select-minute").show(),this.find(".ut-time-select").css("top","157px").css("left","2px"),$(t.currentTarget).select()),this.setCurrentlyObj(".ut-time-minute",59,5)},"click ::popup .ut-time-second":function(t){"block"==this.find(".ut-time-select-second").css("display")?this.find(".ut-time-select div").hide():(this.find(".ut-time-select div").hide(),this.find(".ut-time-select-second").show(),this.find(".ut-time-select").css("top","172px").css("left","2px"),$(t.currentTarget).select()),this.setCurrentlyObj(".ut-time-second",59,15)},"click ::popup .ut-time-select-hour td":function(t){this.find(".ut-time-select div").hide(),this.find(".ut-time-hour").val($(t.currentTarget).text()),this.setTimeToHidden()},"click ::popup .ut-time-select-minute td":function(t){this.find(".ut-time-select div").hide(),this.find(".ut-time-minute").val($(t.currentTarget).text()),this.setTimeToHidden()},"click ::popup .ut-time-select-second td":function(t){this.find(".ut-time-select div").hide(),this.find(".ut-time-second").val($(t.currentTarget).text()),this.setTimeToHidden()},"click ::popup .ut-time-step-btnAdd":function(t){null==this.currentlyObj&&this.setCurrentlyObj(".ut-time-hour",23,1);var e=this.currentlyObj.obj.val(),i=parseInt(e)+this.currentlyObj.step;i>=this.currentlyObj.max&&(i=this.currentlyObj.max),this.currentlyObj.obj.val(i),this.setTimeToHidden()},"click ::popup .ut-time-step-btnMinus":function(t){null==this.currentlyObj&&this.setCurrentlyObj(".ut-time-hour",23,1);var e=this.currentlyObj.obj.val(),i=parseInt(e)-this.currentlyObj.step;i<=0&&(i=0),this.currentlyObj.obj.val(i),this.setTimeToHidden()}},i}(t.TextBox);t.DatePicker=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments),this.fileUpload=this,this.aLoneFromParent=null,this.divID=this.divID?this.divID:this.getState("uploadDivID"),this.fileId=this.fileId?this.fileId:"ut_file_"+t.utils.uuid(8),this.isPostback=null!=this.isPostback&&this.isPostback}return __extends(i,e),i.prototype.init=function(e){this.aLoneFromParent=null,this.fileList=[],this.options=t.utils.extend({txtCls:"",data:null,btnCls:"",allow:"",notAllow:"",size:0,direct:!1,btn:"",fileName:"",fileUrl:"",showName:!0,readOnly:!1,showList:!0,showUpload:!0,action:"localhost",multiple:!1,isCheck:!0,isDownload:!1,isDelete:!0,dropElement:null,isDrop:!1,onUploadComplete:null,onSelect:null,beforeDelete:null,clickText:!1,showSelectBtn:!0,showUploadBtn:!0,deleteFile:null,onDownload:null,name:""},e),e.onUploadComplete&&this.on("onUploadComplete",e.onUploadComplete),e.deleteFile&&this.on("deleteFile",e.deleteFile),e.onSelect&&this.on("onSelect",e.onSelect),e.beforeDelete&&this.on("beforeDelete",e.beforeDelete),e.onDownload&&this.on("onDownload",e.onDownload),e.fileName},i.prototype.setKey=function(t,e){this.fileItem=this.getFile(t),this.fileList[this.fileItem.fileIndex].key=e},i.prototype.getFile=function(t){for(var e=0;e<this.fileList.length;e++)if(this.fileList[e].fileIndex=e,this.fileList[e].id.toString()==t)return this.fileList[e];return null},i.prototype.deleteFile=function(e){var i=this.getFile(e);if(!t.utils.some(this.emitHelper("beforeDelete",i),!1)&&null!=i){var s=e;""!=s&&null!=s||(s=i.id);var n=this.find("[name='hdUpdateFileID'][value='"+s+"']");if(n.length>0){var o=this.getFile($(n).val());if(t.utils.some(this.emitHelper("beforeDelete",o),!1))return;this.fileList.splice(o.fileIndex,1),$(n).parent().remove(),this.emit("deleteFile",o)}else if(this.options.multiple){var o=this.getFile(e);this.fileList.splice(o.fileIndex,1),$("#"+e).parent().parent().parent().remove()}else{this.find("[name='DeleteChangeFile']").parent().remove();var r=$("#"+this.fileId),a=$(r)[0].outerHTML,l=$(r).parent();$(r).remove(),$(a).insertBefore($(l).find("span"))}}},i.prototype.setFileCheckInfo=function(t,e){this.fileList[this.fileItem.fileIndex].key=t,this.fileList[this.fileItem.fileIndex].fileUrl=e;this.find("[type='hidden'][value='"+this.fileList[this.fileItem.fileIndex].id+"']")},i.prototype.initState=function(e,i){var s=i.btnCls,n="",o="";return t.isString(s)?(n=s,o=s):(n=null==s.uploadBtnCLs?"":s.uploadBtnCLs,o=null==s.deleteBtnCls?"":s.deleteBtnCls),this.list=e,this.fileUrl=i.fileUrl,{uploadBtnCLs:n,deleteBtnCls:o,txtCls:i.txtCls,selectTxt:i.text&&null!=i.text.selectTxt?i.text.selectTxt:"浏览...",uploadTxt:i.text&&null!=i.text.uploadTxt?i.text.uploadTxt:"上传",multipleUploadTxt:i.text&&null!=i.text.multipleUploadTxt?i.text.multipleUploadTxt:"全部上传",multipleDeleteTxt:i.text&&null!=i.text.multipleDeleteTxt?i.text.multipleDeleteTxt:"全部删除",txtSelectTxt:i.text&&null!=i.text.txtSelectTxt?i.text.txtSelectTxt:"选择",options:this.options,multiple:this.options.multiple,showName:this.options.showName,labID:t.utils.uuid(8),uploadDivID:t.utils.uuid(8),hiddenIframeID:t.utils.uuid(8),fileName:i.fileName,fileUrl:i.fileUrl,list:e,deleteTxt:i.deleteTxt,name:i.name}},i.prototype.createFileItem=function(t,e,i,s,n,o,r,a,l,d,h,u){return{id:t,fileName:e,key:i,name:s,size:n,action:o,suffix:r,fileUrl:a,success:l,isUpload:d,fileIndex:h,attributes:u}},i.prototype.hideMultipleControl=function(t){this.find("[name='ut_btnUploadAll']").hide(),this.find("[name='ut_btnDeleteAll']").hide(),t.readOnly&&(this.find(".ut-upload-btn").hide(),this.find("[name='ut_btnUpload']").hide())},i.prototype.hideSingleControl=function(t){this.find("[type='text']").hide(),this.find("[name='ut_btnUpload']").hide(),this.options.readOnly&&(this.find("[name='ut_btnUploadAll']").hide(),this.find("[name='ut_btnDeleteAll']").hide(),this.find(".ut-upload-btn").hide())},i.prototype.loadList=function(e,i){if(1==e.multiple&&null!=this.list&&this.list.length>0){for(var s=this.list,n=0;n<s.length;n++){this.fileItem=this.createFileItem(s[n].id,s[n].fileName,s[n].key,s[n].name,s[n].size,e.action,s[n].suffix,s[n].fileUrl,!0,!0,n,s[n].attributes),this.fileList.push(this.fileItem);var o="<div style='display: inline-block'>"+this.ReplaceFileOInput.call(this,this.cutName(this.fileItem.fileName),this.fileItem.fileName,this.fileItem.fileUrl,this.fileItem.id)+"</div>";$("#upload_"+i).append(o)}t.print(this.list)}},i.prototype.loadDefault=function(t){if(!t.multiple&&t.fileName&&t.fileUrl){this.fileItem=this.createFileItem(t.fileKey?t.fileKey:0,t.fileName,t.fileKey,"",0,t.action,"",t.fileUrl,!1,!1,0,[]),this.fileList[0]=this.fileItem;var e=this.ReplaceFileOInput.call(this,this.cutName(this.fileItem.fileName),this.fileItem.fileName,this.fileItem.fileUrl,this.fileItem.id),i="<div name='ut-file-alone' style='display: inline-block'>";i+=e,i+="</div>";var s=this.find("form");$(i).insertBefore($(s).parent())}},i.prototype.testAllow=function(e,i){return!(null!=i.allow&&i.allow.length>0)||(","+i.allow.toLocaleLowerCase()+",").indexOf(","+e.toLocaleLowerCase()+",")>=0||(this.tips=new t.Tips({elem:".ut-form-row-fileupload",type:"error",side:1,msg:i.tip&&i.tip.allowMsg?i.tip.allowMsg:"只允许上传"+i.allow+"文件"}),this.setChildComponents(this.tips),!1)},i.prototype.testNoAllow=function(e,i){return!(null!=i.notAllow&&i.notAllow.length>0&&(","+i.notAllow+",").indexOf(","+e+",")>=0)||(this.tips=new t.Tips({elem:".ut-form-row-fileupload",type:"error",side:1,msg:i.tip&&i.tip.noAllowMsg?i.tip.noAllowMsg:"不允许"+i.notAllow+"文件"}),this.setChildComponents(this.tips),!1)},i.prototype.testSize=function(e,i){try{return!(0!=i.size&&null!=e[0].files&&e[0].files.item(0).size/1024>i.size)||(this.tips=new t.Tips({elem:".ut-form-row-fileupload",type:"error",side:1,msg:i.tip&&i.tip.sizeMsg?i.tip.sizeMsg:"文件过大,不能超过"+i.size+"KB"}),this.setChildComponents(this.tips),!1)}catch(s){return!0}},i.prototype.cutName=function(t){if(null==t||""==t)return"";var e=t.substring(0,t.lastIndexOf(".")),i=t.substring(t.lastIndexOf(".")+1),s=this.GetLength(e);return e.length>s&&(e=e.substring(0,s)+".."),e=e+"."+i},i.prototype.GetLength=function(t){for(var e=0,i=t.length,s=-1,n=0,o=0;o<i&&20!=e;o++)s=t.charCodeAt(o),e+=s>=0&&s<=128?1:2,n++;return n},i.prototype.ReplaceFileOInput=function(e,i,s,n){var o=this;return t.render({source:["<label title='{{title}}'>{{name}}</label>","<input type='hidden' name='hdUpdateFileID' value='{{id}}' />","{{if isCheck}}","&nbsp;&nbsp;<a href='javascript:void(0);' onclick= '{{ showFile(id) }}' name='multipleDownload' >查看</a>","{{/if}}","{{if isDownload}}","&nbsp;&nbsp;<a href='javascript:void(0);'  name='OnDownload' >下载</a>","{{/if}}","{{if !readonly}}","{{if isDelete}}","&nbsp;&nbsp;<a href='javascript:void(0);'  name='DeleteFile'>删除</a>","{{/if}}","{{/if}}"],data:{title:i,name:e,id:n,readonly:this.options.readonly,isCheck:this.options.isCheck,isDownload:this.options.isDownload,isDelete:this.options.isDelete},insert:function(e,i){var s=t.utils.uuid(10);return window[s]=t.bind(o[e],o,i),s+"()"}})},i.prototype.AddFileInput=function(t,e,i){var s="";return s+="<div>",s+="<form name='utyr_formFile' style='display: inline-block' method='post' action='"+e+"' enctype='multipart/form-data' target='"+i+"'>",s+="<input type='file' name='ut_fileUpload' style='position:absolute;left:-99999999px' id='"+t+"' />",s+="<span style='display:none;'><label></label>",s+="&nbsp;&nbsp;<a href='javascript:void(0);' name='multipleUpload' >上传</a>&nbsp;&nbsp;<a href='javascript:void(0);'  name='multipleDelete'>删除</a></span>",s+="</form></div>"},i.prototype.uploadFileToSubmit=function(){this.fileList[0]=this.fileItem;var t=this.find("form");t.submit(function(e){t.unbind("submit"),e.stopPropagation()}),t.submit(),this.aLoneFromParent=$(t).parent()},i.prototype.ReplaceContent=function(){var t=this.ReplaceFileOInput.call(this,this.cutName(this.fileItem.fileName),this.fileItem.fileName,this.fileItem.fileUrl,this.fileItem.id),e=this.find("[name='ut-file-alone']");if(null!=e&&e.length>0)e.html(t);else{var i="<div name='ut-file-alone' style='display: inline-block'>";i+=t,i+="</div>",$(i).insertBefore(this.aLoneFromParent)}this.find("[type='text']").val("")},i.prototype.ReplaceChange=function(t,e,i){var s="<label title='"+t+"'>"+e+"</label>&nbsp;&nbsp;<a href='javascript:void(0);'  name='ut_btnUpload'>上传</a>&nbsp;&nbsp;<a href='javascript:void(0);'  name='DeleteChangeFile'>删除</a>",n=this.find("[name='ut-file-alone']");if(null!=n&&n.length>0)n.html(s);else{var o="<div name='ut-file-alone' style='display: inline-block'>";o+=s,o+="</div>",$(o).insertBefore(this.find("[name='utyr_formFile']").parent())}},i.prototype.AddtoContent=function(){var t=this.ReplaceFileOInput.call(this,this.cutName(this.fileItem.fileName),this.fileItem.fileName,this.fileItem.fileUrl,this.fileItem.id);this.aLoneFromParent.children().remove(),this.aLoneFromParent.append(t)},i.prototype.resetFile=function(t){var e=$("#"+t),i=$(e)[0].outerHTML,s=$(e).parent();$(e).remove(),$(i).insertBefore($(s).find("span"))},i.prototype.clickSelect=function(){$("[name='ut_hiddenLabel']").click(),this.options.multiple},i.prototype.clickUpload=function(){if(this.options.multiple){var e=$(this.find("form")[0]);e.length&&""!=e.find("[type='file']").val()&&(this.fileItem=this.getFile(e.find("[type='file']").attr("id")),this.aLoneFromParent=e.parent(),e.submit(function(t){e.unbind("submit"),t.stopPropagation()}),e.submit(),this.once("onUploadComplete",arguments.callee))}else{var i=$("#"+this.fileId);if(""==$(i).val())return void t.infomsg("请选择文件");this.uploadFileToSubmit.call(this);var s=$(i)[0].outerHTML,n=$(i).parent();$(i).remove(),$(s).insertBefore($(n).find("span"))}},i.prototype.ready=function(e){function i(){this.find("#ut_checkFile_"+o).attr("for",this.fileId),this.find("#ut_hiddenFile_"+o).attr("for",this.fileId),this.find("#upload_"+this.divID).find("[type='file']:last").attr("id",this.fileId)}function s(i){var n=e.multiple,o=i[0];if(null!=o){var r=o.name,a=(e.direct,r.substring(r.lastIndexOf(".")+1));if(v.testAllow(a,e)&&v.testNoAllow(a,e)){if(0!=e.size&&null!=o&&o.size/1024>e.size)return t.infomsg(e.tip&&e.tip.sizeMsg?e.tip.sizeMsg:"文件过大,不能超过"+e.size+"KB"),!1;var l=Math.max(r.lastIndexOf("/"),r.lastIndexOf("\\"));if(f=r.substring(l+1),p=e.action,v.fileItem=v.createFileItem("ut_file_"+t.utils.uuid(8),f,"","",null==o?0:o.size,p,a,"#",!1,!1,0,[]),!t.utils.some(v.emitHelper("onSelect",v.fileItem),!1)){var d=new XMLHttpRequest,h=new FormData;d.open("POST",e.action,!0),d.onload=function(){t.print("上传完成")},null==n||0==n?v.fileList[0]=v.fileItem:1==n&&(v.fileItem.fileIndex=v.fileList.length,v.fileList.push(v.fileItem)),h.append("file",o),d.send(h);d.onreadystatechange=function(){if(4==d.readyState){if(null==n||0==n){var e=v.ReplaceFileOInput.call(v,v.cutName(v.fileItem.fileName),v.fileItem.fileName,v.fileItem.fileUrl,v.fileItem.id),o=v.find("[name='ut-file-alone']");if(null!=o&&o.length>0)o.html(e);else{var r="<div name='ut-file-alone'>";r+=e,r+="</div>",$(r).insertBefore(v.find("form").parent())}v.find("[type='text']").val("")}else{var e=v.ReplaceFileOInput.call(v,v.cutName(v.fileItem.fileName),v.fileItem.fileName,v.fileItem.fileUrl,v.fileItem.id),r="<div>";r+=e,r+="</div>",$(r).insertBefore(v.find("form").parent())}i.shift(),s(i)}else t.print("上传失败")}}}}}var n=this;this.isPostback=!1;var o=this.getState("labID");this.divID=this.getState("uploadDivID"),this.fileId="ut_file_"+t.utils.uuid(8);var r=this.getState("hiddenIframeID");i.call(this);var a=e.multiple;e.showUploadBtn||(1==a?this.find("[name='ut_btnUploadAll']").hide():this.find("[name='ut_btnUpload']").hide());var l=e.showSelectBtn;l||this.find("#ut_checkFile_"+o).hide();var d=e.clickText;d&&this.bind("click","[type='text']",function(){$("#"+this.fileId).click()});var h=e.showName;0==h&&(this.find("[type='text']").hide(),e.readOnly);var u=e.showList;0==u&&this.find("#upload_"+this.divID).hide();var c=e.showUpload;0==c&&this.find(".ut-form-row-fileupload").hide(),1==a?this.hideSingleControl(e):this.hideMultipleControl(e),this.loadList(e,this.divID),$("#upload_"+this.divID).append(this.AddFileInput(this.fileId,e.action,this.find("iframe").attr("name"))),this.loadDefault(e);var p="",f="";if(this.bind("change","[name='ut_fileUpload']:last",function(){this.tips&&!this.tips.destroyed&&this.tips.destroy();var s=this.find("#"+this.fileId),n=$(s).val();if(n.length){var o=e.direct,r=n.substring(n.lastIndexOf(".")+1);if(!this.testAllow(r,e))return void this.resetFile(this.fileId);if(!this.testNoAllow(r,e))return void this.resetFile(this.fileId);if(!this.testSize(s,e))return void this.resetFile(this.fileId);var l=Math.max(n.lastIndexOf("/"),n.lastIndexOf("\\"));if(f=n.substring(l+1),p=e.action,this.fileItem=this.createFileItem(this.fileId,f,"","",null==s[0].files?0:s[0].files.item(0).size,e.action,r,"#",!1,!1,0,[]),t.utils.some(this.emitHelper("onSelect",this.fileItem),!1))return void this.resetFile(this.fileId);if(null==a||0==a){if(e.showName){var d=this.find("[type='text']");$(d).val(f)}else this.ReplaceChange(f,this.cutName(f));if(null!=o&&1==o){this.uploadFileToSubmit.call(this);var h=$("#"+this.fileId),u=$(h)[0].outerHTML,c=$(h).parent();$(h).remove(),$(u).insertBefore($(c).find("span"))}}else if(1==a){var m=this.find("#upload_"+this.divID)[0];$(m).find("label:last").attr("title",f);var g=this.cutName(f);$(m).find("label:last").text(g),$(m).find("span").show();var v=this.fileId;if(this.fileId="ut_file_"+t.utils.uuid(8),$("#upload_"+this.divID).append(this.AddFileInput(this.fileId,e.action,this.find("iframe").attr("name"))),i.call(this),this.fileList.push(this.fileItem),null!=o&&1==o){var y=$("#"+v).parents("form");y.submit(function(t){y.unbind("submit"),t.stopPropagation()}),y.submit(),this.fileItem=this.getFile($(y).find("[type='file']").attr("id")),this.aLoneFromParent=y.parent()}}}}),$("#ut_hiddenIframe_"+r).load(function(){if(!n.isPostback&&$.browser.msie)return void(n.isPostback=!0);if(null!=n.fileItem){var t=document.getElementById("ut_hiddenIframe_"+r).contentWindow;n.fileList[n.fileItem.fileIndex].isUpload=!0;var i="";try{i=t.document.body.innerText}catch(s){i=""}try{var o=JSON.parse(i);null!=o&&(null!=o.key&&(n.fileList[n.fileItem.fileIndex].key=o.key),null!=o.fileUrl&&(n.fileList[n.fileItem.fileIndex].fileUrl=o.fileUrl),null!=o.name&&(n.fileList[n.fileItem.fileIndex].name=o.name),null!=o.fileName&&(n.fileList[n.fileItem.fileIndex].fileName=o.fileName),null!=o.size&&(n.fileList[n.fileItem.fileIndex].size=o.size),null!=o.attributes&&(n.fileList[n.fileItem.fileIndex].attributes=o.attributes),null!=o.success&&(n.fileList[n.fileItem.fileIndex].success=o.success)),e.multiple?n.AddtoContent():n.ReplaceContent(),n.emit("onUploadComplete",n.fileList[n.fileItem.fileIndex],i)}catch(s){e.multiple?n.AddtoContent():n.ReplaceContent(),n.emit("onUploadComplete",n.fileList[n.fileItem.fileIndex],i)}}}),null!=e.direct&&1==e.direct){this.find("[name='ut_btnUpload']").hide(),this.find("[name='ut_btnUploadAll']").hide()}var m=m||{};m=function(t){return{attach:function(e,i){return t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,i),function(){m(t).detach(e,i)}},detach:function(e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.attachEvent&&t.detachEvent("on"+e,i)},_isValidFileDrag:function(t){if(m.ie()&&!m.ie10())return!1;var e=t.dataTransfer,i=m.safari(),s=!!m.ie10()||"none"!=e.effectAllowed;return e&&s&&(e.files||!i&&e.types.contains&&e.types.contains("Files"))}}},m.ie=function(){return navigator.userAgent.indexOf("MSIE")!=-1},m.ie10=function(){return navigator.userAgent.indexOf("MSIE 10")!=-1},m.safari=function(){return void 0!=navigator.vendor&&navigator.vendor.indexOf("Apple")!=-1},m.chrome=function(){return void 0!=navigator.vendor&&navigator.vendor.indexOf("Google")!=-1},m.firefox=function(){return navigator.userAgent.indexOf("Mozilla")!=-1&&void 0!=navigator.vendor&&""==navigator.vendor},m.windows=function(){return"Win32"==navigator.platform},m(document).attach("dragover",function(t){g._isValidFileDrag(t)&&(window.event.preventDefault(),t.returnValue=!1)});var g;g=m(e.dropElement?$("#"+e.dropElement)[0]:$(".ut-form-row-fileupload")[0]);var v=this;g.attach("drop",function(t){if(g._isValidFileDrag(t)&&(window.event.preventDefault(),t.returnValue=!1,t.stopPropagation(),t.preventDefault(),!e.readOnly)){var i=t.dataTransfer.files;if(null!=i&&i.length>0){var n=[];if(null==e.multiple||0==e.multiple)n[0]=i[i.length-1];else for(var o=0;o<i.length;o++)n[o]=i[o];s(n)}}})},i.prototype.showFile=function(e){var i=this.getFile(e),s=i.fileUrl,n=i.fileName,o="";if("#"!=s){var r=n.substring(n.lastIndexOf(".")+1),a={title:this.options.showWindow&&this.options.showWindow.title?this.options.showWindow.title:"文件预览",shadow:!(!this.options.showWindow||!this.options.showWindow.shadow)&&this.options.showWindow.shadow,width:this.options.showWindow&&this.options.showWindow.width?this.options.showWindow.width:405,height:this.options.showWindow&&this.options.showWindow.height?this.options.showWindow.height:470,draggable:!this.options.showWindow||!this.options.showWindow.draggable||this.options.showWindow.draggable,resizable:!this.options.showWindow||!this.options.showWindow.resizable||this.options.showWindow.resizable,minimizable:!(!this.options.showWindow||!this.options.showWindow.minimizable)&&this.options.showWindow.minimizable,maximizable:!this.options.showWindow||!this.options.showWindow.maximizable||this.options.showWindow.maximizable,collapsible:!(!this.options.showWindow||!this.options.showWindow.collapsible)&&this.options.showWindow.collapsible,closable:!this.options.showWindow||!this.options.showWindow.closable||this.options.showWindow.closable,html:"",content:""};if("jpg,jpeg,png,gif".indexOf(r.toLowerCase())>=0)o="<img style='max-width: 360px;' src='"+s+"' title='"+n+"' />",a.html=o,t.create("Window",a);else if("txt,js,sql,json,xml,jrxml,htm,html".indexOf(r.toLowerCase())>=0){$.ajax({url:s,dataType:"text",success:function(e){"htm,html".indexOf(r.toLowerCase())>=0?a.html=e:a.content=e,t.create("Window",a)}})}else window.open(s)}},i.prototype.setListFileName=function(t,e){var i=this.find("[name='hdUpdateFileID'][value='"+t+"']");$(i).parent().find("label").text(e)},i.template=["<div class='ut-form-row-fileupload' style='display: inline-block' name='{{name}}'>","   <input placeholder='{{txtSelectTxt}}' type='text' readonly='readonly' class='{{multiple||!showName?'ut-hidden':''}} utry-input {{txtCls}}' />","   <label class='ut-upload-btn {{uploadBtnCLs}}'  for='' id='ut_checkFile_{{labID}}'>{{selectTxt}}</label>","   <label class='ut-hidden' for='' name='ut_hiddenLabel' id='ut_hiddenFile_{{labID}}'></label>","   <div name='ut_btnUpload'  class='ut-upload-btn ut-upload-narrow-btn {{uploadBtnCLs}}'>{{uploadTxt}}</div>","   <div name='ut_btnUploadAll'  class='ut-upload-btn ut-upload-narrow-btn {{uploadBtnCLs}}'>{{multipleUploadTxt}}</div>","   <div name='ut_btnDeleteAll'  class='ut-upload-btn ut-upload-narrow-btn {{deleteBtnCls}}'>{{multipleDeleteTxt}}</div>","   <br /><div id='upload_{{uploadDivID}}' style='display: inline-block'>","   </div>","<iframe id='ut_hiddenIframe_{{hiddenIframeID}}'  src='about:blank' style='display:none' name='ut_hiddenIframe_{{hiddenIframeID}}' ></iframe>","<input type='hidden' name='hdUrl' value='{{options.action}}' />","</div>"],i.events={"click [name='ut_btnUploadAll']":function(t){var e=$(this.find("form")[0]);e.length&&""!=e.find("[type='file']").val()&&(this.fileItem=this.getFile(e.find("[type='file']").attr("id")),this.aLoneFromParent=e.parent(),e.submit(function(t){e.unbind("submit"),t.stopPropagation()}),e.submit(),this.once("onUploadComplete",arguments.callee))},"click [name='multipleUpload']":function(t){var e=$(t.currentTarget).parents("form");e.submit(function(t){e.unbind("submit"),t.stopPropagation()}),e.submit(),this.fileItem=this.getFile($(e).find("[type='file']").attr("id")),this.aLoneFromParent=e.parent()},"click [name='multipleDelete']":function(t){var e=this.getFile($(t.currentTarget).parents("form").find("[type='file']").attr("id"));this.fileList.splice(e.fileIndex,1),$(t.currentTarget).parent().parent().parent().remove()},"click [name='DeleteFile']":function(e){var i=$(e.currentTarget).parent().find("[name='hdUpdateFileID']").val(),s=this.getFile(i);t.utils.some(this.emitHelper("beforeDelete",s),!1)||(this.fileList.splice(s.fileIndex,1),$(e.currentTarget).parent().remove(),this.emit("deleteFile",s))},"click [name='OnDownload']":function(e){var i=$(e.currentTarget).parent().find("[name='hdUpdateFileID']").val(),s=this.getFile(i);t.utils.some(this.emitHelper("onDownload",s),!1)||window.open(s.fileUrl)},"click [name='ut_btnDeleteAll']":function(){for(var e=$("#upload_"+this.divID).find("div"),i=0;i<e.length;i++){var s=$(e[i]).find("form");if(null!=s&&s.length>0){if(null!=$(s).find("label").attr("title")&&""!=$(s).find("label").attr("title")){var n=this.getFile($(s).find("[type='file']").attr("id"));this.fileList.splice(n.fileIndex,1),$(s).parent().remove()}}else{var o=$(e[i]).find("[name='hdUpdateFileID']").val(),n=this.getFile(o);
if(t.utils.some(this.emitHelper("beforeDelete",n),!1))return;this.fileList.splice(n.fileIndex,1),$(e[i]).remove(),this.emit("deleteFile",n)}}},"click [name='ut_btnUpload']":function(){var e=$("#"+this.fileId);if(""==$(e).val())return void t.infomsg("请选择文件");this.uploadFileToSubmit.call(this);var i=$(e)[0].outerHTML,s=$(e).parent();$(e).remove(),$(i).insertBefore($(s).find("span"))},"click [name='DeleteChangeFile']":function(t){$(t.currentTarget).parent().remove();var e=$("#"+this.fileId),i=$(e)[0].outerHTML,s=$(e).parent();$(e).remove(),$(i).insertBefore($(s).find("span"))}},i}(t.Component);t.FileUpload=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){var i,s=e.el;t.utils.extend(e,{action:s.attr("action"),method:s.attr("method")}),void 0==(i=t.utils.trim(e.enctype))&&(e.enctype=s.attr("enctype")),t.utils.each("onInvalid onValid onBeforeSubmit onSuccess onsuccess onSubmitSuccess onError onerror onSubmitError "+"onComplete oncomplete onSubmitComplete onBeforeReset onReset onreset".split(" "),function(i){t.isFunction(e[i])&&(this.on(i,e[i]),e[i]=null)},this),this.on("onInvalid",function(){t.utils.each(this.childComponents,function(e){var i;if(!e.isDestroyed()&&(i=e.validationResult)&&!i.valid)return t.isFunction(e.focus)&&e.focus(),!1})})},i.prototype.initState=function(e,i){var s,n=i.el;return s=n.find(":file").length?"multipart/form-data":"application/x-www-form-urlencoded",t.utils.extend({enctype:s,method:"post"},{method:i.method,style:t.utils.getStyle({width:i.width,height:i.height}),id:this.id,name:this.name,formId:this.formId=t.utils.uuid(10).toLowerCase()})},i.prototype.render=function(t,i){var s=$(document.createDocumentFragment()).append(i.contents()),n=$(e.prototype.render.apply(this,arguments));n.replaceAll(i).append(s)},i.prototype.afterRender=function(){var e=this;this.setValue(this.model.data),this.find("form["+this.formId+"]").submit(function(t){return t.preventDefault(),e.submit(),!1}).get(0).onreset=function(i){var i=t.utils.getEventObject(i);if(e.hasEventListener("onBeforeReset")){if(t.utils.some(e.emitHelper("onBeforeReset"),!1))return i.preventDefault(),!1;if(e.childComponents.length)return i.preventDefault(),e.reset(),!1}else if(e.childComponents.length)return i.preventDefault(),e.reset(),!1}},i.prototype.setValue=function(e,i){var s=null;t.isString(e)?(s={},s[e]=i):t.isObject(e)?s=e:void 0==s&&(s={});var n=this.find("form["+this.formId+"]").get(0);return this.find("[name]").each(function(e,i){var o=$(i),r=t.utils.trim(o.attr("name")),a=s[r];r&&void 0!==a&&(o.is(":checkbox")||o.is(":radio")?i.checked=!!a:o.is("select")?o.find("option[value='"+a+"']").attr("selected","true"):i.form!==n||/\bundefined|submit|reset|button\b/i.test(i.type)||o.val(a))}),t.utils.forEach(this.childComponents,function(t){if(t.destroyed)this.removeChildComponents(t);else{var e=t.name;void 0!==s[e]&&t.setValue(s[e])}},this),this},i.prototype.getValue=function(e){var i,s=this.find("form["+this.formId+"]").get(0);if(!t.isString(e)||!(e=t.utils.trim(e))){var e,n,o={},r=this.options.preventEmpty;return t.utils.each($(s).serializeArray(),function(i){n=i.value,r&&t.isEmpty(n=t.utils.trim(n))||t.isEmpty(e=i.name)||(t.isArray(o[e])?o[e].push(n):e in o?(o[e]=[o[e]]).push(n):o[e]=n)}),o}return(i=s.elements[e])?$(i).val():(i=t.utils.filter(this.childComponents,function(t){return!t.destroyed&&t.name===e})).length?i[0].getValue():void 0},i.prototype.submit=function(e){return"submitted"===this.state?void t.print("Submitted already.","warn"):(e=t.utils.extend({},this.options,e),this.validate(function(i,s){i?(this.emit("onValid",s),t.utils.some(this.emitHelper("onBeforeSubmit"),!1)||this._doSubmit(e)):this.emit("onInvalid",s)}),this)},i.prototype.validate=function(e){var i=this,s=[];return!t.isFunction(e)&&(e=t.voidFunc),t.utils.each(this.childComponents,function(e){e.destroyed?this.removeChildComponents(e):t.isFunction(e.validate)&&s.push(new t.Promise(function(t,i){e.once("onValid",t).once("onInvalid",i).validate()}))},this),s.length?t.Promise.all(s).then(function(t){e.call(i,!0,t)}).fail(function(t){e.call(i,!1,t)}):e.call(this,!0,""),this},i.prototype.reset=function(e){return e||(this.childComponents.length?t.utils.each(this.childComponents,function(e){e.destroyed?this.removeChildComponents(e):("hidden"!=e.type&&e.setValue(""),t.isFunction(e.clearValidationTips)&&e.clearValidationTips())},this):this.find("form["+this.formId+"]").get(0).reset()),this.state="",this.find(":submit").attr("disabled",!1),this.emit("onReset").emit("onreset")},i.prototype._doSubmit=function(e){e=t.utils.extend({},this.options,e);var i=t.utils.trim(e.params),s=e.action=t.utils.trim(e.action);if(!s||!t.isString(s))throw"No action address for submit.";"form"!==e.submitMode&&(e.params=t.utils.deepExtend(t.utils.parseParams(i),this.getValue()),this._ajaxSubmit(e))},i.prototype._ajaxSubmit=function(e){this.find(":submit").attr("disabled",!0),this.model.ajax(t.utils.extend({},e,{context:this,url:e.action,contentType:e.contentType||e.enctype,method:e.method||"post",beforeSend:function(){this.state="submitted"},success:function(i){if(!this.isDestroyed()){var s=e.onSuccess||e.onsuccess||e.success;this.submitResponse=i,e.resetAfterSubmit&&this.reset(),t.isFunction(s)&&s.call(this,i),this.emit("onSubmitSuccess",i).emit("onSuccess",i).emit("onsuccess",i)}},error:function(i,s,n){if(!this.isDestroyed()){var o=e.onError||e.onerror||e.error;this.state="",this.submitResponse=s,t.isFunction(o)&&o.call(this,s,n),this.emit("onSubmitError",s,n).emit("onError",s,n).emit("onerror",s,n)}},complete:function(){if(!this.isDestroyed()){var i=e.onComplete||e.oncomplete||e.complete,s=this.state,n=this.submitResponse;t.isFunction(i)&&i.call(this,s,n),e=null,this.emit("onSubmitComplete",s,n).emit("onComplete",s,n).emit("oncomplete",s,n)}}}))},i.template=["<form {{formId}} class='ut-form' id='{{id}}' name='{{name}}' method='{{method}}' enctype='{{enctype}}' style='{{style}}'>","</form>"],i}(t.Component);t.Form=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(t){var i=e.call(this,t);if(i)return i}return __extends(i,e),i.prototype.init=function(e){void 0==e.value&&(e.value=""),e.el.is("textarea")?(e.type="textarea",this.value=t.utils.trim(e.value||e.el.val())):this.value=e.value;var i=e.type=String(t.utils.trim(e.type)||"").toLowerCase();this.type=e.elemClass="text",/^date|checkbox|radio/.test(i)&&(this.off().destroy(),$(e.el).removeAttr(t.Component.UUID));var s;switch(i){case"datetime":case"datetime-local":void 0===e.time&&(e.time=!0);case"date":return t.create("DatePicker",e);case"checkbox":var n=t.create("CheckGroup",e).on("onChange",s=function(){return this.checked=!!this.find("input:checkbox").attr("checked")});return n.checked=s.call(n),n;case"radio":var o=t.create("RadioGroup",e).on("onChange",s=function(){return this.checked=!!this.find("input:radio").attr("checked")});return o.checked=s.call(o),o;case"password":this.type=i;break;case"hidden":this.type=i,e.elemClass=i;break;case"textarea":this.type=e.elemClass=i;break;case"submit":case"reset":case"button":this.type=i,e.elemClass="button",e.readonly=!0;break;case"number":case"email":case"range":case"url":case"":break;case"file":}(e.placeholder=t.utils.trim(e.placeholder))&&("placeholder"in document.createElement("input")||(e.mockPlaceholder=!0,this.id||(this.id=t.utils.uuid(8))))},i.prototype.initState=function(e,i){return{id:this.id,name:this.name,type:this.type,value:i.value,elemClass:i.elemClass,placeholder:i.placeholder,mockPlaceholder:i.mockPlaceholder,style:t.utils.getStyle({width:i.width,height:i.height,resize:"textarea"===this.type?i.resize||"none":void 0}),rows:i.rows,cols:i.cols}},i.prototype.ready=function(t){this.catchChangeEvent(t.onChange);var e=".ut-input";if(t.mockPlaceholder){var i=function(){this[""===this.find(e).val()?"show":"hide"](".ut-placeholder")};this.on("onChange",i).bind("blur",e,i)}void 0!==t.autofocus&&this.find(e).focus()},i.prototype.getValue=function(){return this.find(this.inputElementSelector).val()},i.prototype.setValue=function(e){var i=this.value;if(!t.isEmpty(e)||"button"!=this.options.elemClass)return e=this.find(this.inputElementSelector).val(void 0===e?"":e+"").val(),i!==e&&this.emit("onChange",e,i),this},i.initRenderDelay=0,i.template=["{{if elemClass=='button'}}","<input class='ut-button ut-input' type='{{type}}' id='{{id}}' name='{{name}}' value='{{value}}'>","{{else}}","<div class='ut-box ut-{{elemClass}}' style='{{style}}'>","    <div class='ut-wrap'>","{{if mockPlaceholder}}","        <label class='ut-placeholder ut-txt-select-none {{value?'ut-hidden':''}}' for='{{id}}'>{{placeholder}}</label>","{{/if}}","{{if type=='textarea'}}","        <textarea style='{{style}}' class='ut-input' id='{{id}}' name='{{name}}' placeholder='{{placeholder}}' rows='{{rows || 5}}' cols='{{cols || 21}}'>{{#value}}</textarea>","{{else}}","        <input autocomplete='off' class='ut-input' type='{{type}}' placeholder='{{placeholder}}' id='{{id}}' name='{{name}}' value='{{value}}'>","{{/else}}","    </div>","</div>","{{/else}}"],i}(t.TextBox);t.Input=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){this.options=e=t.utils.extend({border:!0,scrollIncrement:100,scrollDuration:400},e),this.tabsMap={},this._opts=e;for(var i,s,n,o="contextMenu clickTab".split(" "),r="on";o.length;)s=t.utils.capitalize(o.pop()),(i=e[n=r+s])&&this.on(n,i);for(var a,l,d,h="add close maxTab Refresh".split(" "),u="onBefore onAfter".split(" ");h.length;)a=t.utils.capitalize(h.pop()),t.utils.each(u,function(t){(d=e[l=t+a])&&this.on(l,d)},this)},i.prototype.initState=function(e,i){var s,n,o=i.el,r=[];return s=t.utils.getStyle({width:i.width,height:i.height}),"0px"!=i.margin&&"0"!=i.margin&&i.margin?n=i.margin:0!=i.margin&&"0px"!=i.margin&&"0"!=i.margin||(n="-1px"),e&&t.utils.each(e,t.bind(function(e){var i={tabId:e.tabId||t.utils.uuid(12),title:e.title,content:e.content,selector:e.selector,html:e.html,url:e.url,closeable:e.closeable,style:e.style};r.push(i),this.tabsMap[i.tabId]=i},this)),t.utils.each(o.children().toArray(),t.bind(function(e){var i=t.Application.parseOptions(e),s={tabId:i.tabId||t.utils.uuid(12),title:i.title,content:i.content,selector:i.selector,html:i.html||i.el.innerHTML,url:i.url,closeable:i.closeable,style:i.style};r.push(s),this.tabsMap[s.tabId]=s},this)),this.options=i=t.utils.extend({tabs:r},i),{style:s,tabs:r,margin:n}},i.prototype.afterRender=function(e){var i=e.tabs;this._adjustHeight(),i&&i.length&&t.utils.forEach(i,t.bind(function(t){this._appendContent(t)},this)),this._defaultTab(!0)},i.prototype.ready=function(e){this.find(".ut-tabs-ul li:first").length&&this.showFirst(),this.bind("click contextmenu","li>a.ut-tabs-inner",t.bind(function(i){var s=($(i.target),i.type),n=$(i.currentTarget).parent("li"),o=n.data("tabid"),r=this._getTab(o);return"contextmenu"===s&&e.onContextMenu?!t.utils.some(this.emitHelper("onContextMenu",r,i.clientX,i.clientY),!1):void this.showTab(o)},this)),this.bind("click","li>a.ut-tabs-close",t.bind(function(t){var e=$(t.currentTarget).parent("li").data("tabid");this.closeTab(e)},this)),this._adjustHeader(),this._setBorder(),this.bind("click",".ut-tabs-scroller-left",t.bind(function(t){this._scrollBy(-this.options.scrollIncrement)},this)),this.bind("click",".ut-tabs-scroller-right",t.bind(function(t){this._scrollBy(this.options.scrollIncrement)},this)),this.bind("resize","window",t.utils.throttle(function(){this._adjustHeader(),this._adjustHeight()},100,this));var i=t.utils.catchKeyboardEvent,s=e.keyName?e.keyName:"esc";i({keyName:s,listener:function(){var t=document.getElementsByClassName("maxTabs");if(0==t.length){var e=document.getElementsByClassName("ut-tabs");$(e).addClass("maxTabs")}else $(t).removeClass("maxTabs"),$(".ut-tabs-fullScreen").addClass("tu-tabs-hide")},target:$(document)}),t.registerMessageListener("closeCurrentTab",this.closeCurrentTab)},i.prototype.showFirst=function(){var e=this.find(".ut-tabs-ul li:first"),i=e.data("tabid"),s=this.find("div[data-tabid='"+i+"']"),n=this.find(".ut-tabs-wrap"),o=e.position().left,r=o+e.outerWidth();if(e.addClass("ut-tabs-selected").siblings().removeClass("ut-tabs-selected"),this.show(s).hide(s.siblings()),o<0||r>n.width()){var a=o-(n.width()-e.width())/2;this._scrollBy(a)}else this._scrollBy(0);var l=t.LeftNav||{};l.hightMenu||"";return t.LeftNav.hightMenu=i,t.postMessage(window.top,"__closeMenuMsgListener"),this.emit("onClickTab",i),this},i.prototype.closeCurrentTab=function(e,i){var s=t.get(i),n=s.find("li.ut-tabs-selected"),o=n.data("tabid"),r=s.find("div[data-tabid='"+o+"']");if(t.utils.some(this.emitHelper("onBeforeClose",o),!1))return this;n.remove(),r.remove();var a=s.find(".ut-tabs-ul>li");return a.length||(s._defaultTab(!0),t.LeftNav.hightMenu="",t.postMessage(window.top,"__closeMenuMsgListener")),a.length&&s.showFirst(),s._adjustHeader(),this.emit("onAfterClose",o),s},i.prototype.closeTab=function(e){if(t.utils.some(this.emitHelper("onBeforeClose",e),!1))return this;var i=this.find("li[data-tabid='"+e+"']"),s=this.find("div[data-tabid='"+e+"']");i.remove(),s.remove();var n=this.find(".ut-tabs-ul>li");return n.length||(this._defaultTab(!0),t.LeftNav.hightMenu="",t.postMessage(window.top,"__closeMenuMsgListener")),n.length&&i.hasClass("ut-tabs-selected")&&this.showFirst(),this._adjustHeader(),this.emit("onAfterClose",e)},i.prototype.closeAllTab=function(){if(t.utils.some(this.emitHelper("onBeforeClose"),!1))return this;var e=this.find(".ut-tabs-ul>li"),i=this.find(".ut-tabs-main>div");e.remove(),i.remove(),this._adjustHeader(),this._defaultTab(!0);var s=t.LeftNav||{};s.hightMenu||"";return t.LeftNav.hightMenu="",t.postMessage(window.top,"__closeMenuMsgListener"),this.emit("onAfterClose")},i.prototype.closeOtherTab=function(e){if(t.utils.some(this.emitHelper("onBeforeClose",e),!1))return this;var i=this.find("li[data-tabid='"+e+"']"),s=this.find("div[data-tabid='"+e+"']");return i.siblings().remove(),s.siblings().remove(),i.hasClass("ut-tabs-selected")||this.showTab(e),this._adjustHeader(),this.emit("onAfterClose",e)},i.prototype.refreshTab=function(e){if(t.utils.some(this.emitHelper("onBeforeRefresh",e),!1))return this;var i=this.tabsMap[e];return i&&this._appendContent(i),t.utils.some(this.emitHelper("onAfterRefresh",e),!1)?this:this},i.prototype.showTab=function(e){var i=this.find("li[data-tabid='"+e+"']"),s=this.find("div[data-tabid='"+e+"']"),n=this.find(".ut-tabs-wrap"),o=i.position().left,r=o+i.outerWidth();if(i.addClass("ut-tabs-selected").siblings().removeClass("ut-tabs-selected"),this.show(s).hide(s.siblings()),o<0||r>n.width()){var a=o-(n.width()-i.width())/2;this._scrollBy(a)}else this._scrollBy(0);var l=t.LeftNav||{};l.hightMenu||"";return t.LeftNav.hightMenu=e,t.postMessage(window.top,"__closeMenuMsgListener"),this.emit("onClickTab",e),this},i.prototype.addTab=function(e){if(t.utils.some(this.emitHelper("onBeforeAdd",e),!1))return this;this._defaultTab(!1),e=t.utils.extend({closeable:!1},e);var s,n,o,r=e.tabId||t.utils.uuid(12),a={tab:e},l=this._opts;return this.find("li[data-tabid='"+r+"']").length?(this.showTab(r),this):(l.margin&&"0px"!=l.margin&&"0"!=l.margin?o=l.margin:0!=l.margin&&"0px"!=l.margin&&"0"!=l.margin||(o="-1px"),a=t.utils.extend({margin:o},a),this.tabsMap[e.tabId]=e,s=t.utils.extend({source:i.tplTabHeaderItem.join(" "),filters:i.filters},a),n=t.utils.extend({source:i.tplTabContentItem.join(" "),filters:i.filters},a),this.find(".ut-tabs-ul li:first").length?this.find(".ut-tabs-ul li:first").before($(new t.Template(s).render(s))):$(new t.Template(s).render(s)).appendTo(this.find(".ut-tabs-ul")),$(new t.Template(n).render(n)).appendTo(this.find(".ut-tabs-main")),this._appendContent(e),this._adjustHeader(),this.showTab(r),this.emit("onAfterAdd"))},i.prototype.getHref=function(t){var e=this.find("li[data-tabid='"+t+"']"),i=e.data("href");return i},i.prototype.onMaxTabs=function(){if(t.utils.some(this.emitHelper("onBeforeMaxTab"),!1))return this;var e=this.find(".ut-tabs");return e.addClass("maxTabs"),this._getMaxRemind(),this.emit("onAfterMaxTab")},i.prototype.onMaxTab=function(e){if(t.utils.some(this.emitHelper("onBeforeMaxTab"),!1))return this;var i=this.find("div[data-tabid='"+e+"']");return i.length>0?(i.addClass("maxTabs"),this._getMaxRemind()):i.content&&(e.addClass("maxTabs"),this._getMaxRemind()),this.emit("onAfterMaxTab")},i.prototype.updateTitle=function(t,e){var i=this.find("li[data-tabid='"+t+"']");i.length>0&&$(i).find("span").html(e)},i.prototype._adjustHeight=function(){var t=this.getRootElement(),e=this.find(".ut-tabs-header"),i=this.find(".ut-tabs-main");i.css("height",t.height()-e.outerHeight(!0))},i.prototype._adjustHeader=function(){var t,e=this.find(".ut-tabs-header"),i=this.find(".ut-tabs-ul"),s=e.children(".ut-tabs-scroller-left"),n=e.children(".ut-tabs-scroller-right"),o=e.children(".ut-tabs-wrap"),r=e.outerWidth(!0),a=this._getContentWidth(i),l=e.outerHeight();a>r?(this.show(s).show(n),s.outerHeight(l),n.outerHeight(l),t=r-s.outerWidth()-n.outerWidth(),o.css({marginLeft:s.outerWidth(),marginRight:n.outerWidth(),width:t})):(this.hide(s).hide(n),t=r,o.css({marginLeft:0,marginRight:"auto",width:t}));var d,h=this.find(".ut-tabs-ul li:last");h.length&&(d=t-h.position().left-h.outerWidth(!0),d>0&&this._scrollBy(d))},i.prototype._getContentWidth=function(t){var e=0;return $(t).children().each(function(){e+=$(this).outerWidth(!0)}),e},i.prototype._appendContent=function(e){var i=this.find("div[data-tabid='"+e.tabId+"'] .ut-tabs-panel-body");if((t.isEmpty(e.selector)||t.isEmpty(e.content))&&t.isEmpty(e.selector))if(t.isEmpty(e.url))t.isEmpty(e.html)?t.isEmpty(e.content)||(i.empty(),i.append($(document.createDocumentFragment()).append(e.content))):(i.empty(),i.append($(e.html)),this.appendChildComponents(new t.Application({context:i}).getComponents()));else{var s=$("<iframe frameborder='no' marginheight='0' marginwidth='0' style='width:100%;height:100%;' class='ut-scroll'  allowtransparency='true'></iframe>");s.attr("src",e.url),i.css({height:"100%",padding:"0px",overflow:"hidden"}),i.empty(),i.append(s)}else i.empty(),i.append($(e.selector).show())},i.prototype._scrollBy=function(t){var e=this.options,i=this.find(".ut-tabs-wrap"),s=Math.min(i[0].scrollLeft+t,this._getMaxScrollWidth(i));return i.animate({scrollLeft:s},e.scrollDuration),this},i.prototype._getMaxScrollWidth=function(t){var e=0,i=t.children("ul");return i.children("li").each(function(){e+=$(this).outerWidth(!0)}),e-t.width()+(i.outerWidth()-i.width())},i.prototype._setBorder=function(){var t=this.options,e=this.find(".ut-tabs-header"),i=this.find(".ut-tabs-main");t.border?(e.removeClass("ut-tabs-header-noborder"),i.removeClass("ut-tabs-panels-noborder")):(e.addClass("ut-tabs-header-noborder"),i.addClass("ut-tabs-panels-noborder"))},i.prototype._defaultTab=function(e){var s=this.options;if(!t.isEmpty(s.defaultTabUrl))if(e){var n=t.utils.extend({source:i.tplDefaultTab.join(" ")},s);$(new t.Template(n).render(n)).appendTo(this.find(".ut-tabs-container")),this.hide(".ut-tabs-header").hide(".ut-tabs-main")}else this.show(".ut-tabs-header").show(".ut-tabs-main"),this.find(".ut-tabs-default").remove()},i.prototype._getTab=function(t){return t instanceof $&&(t=t.data("tabid")),void 0!=t?this.tabsMap[void 0!=t.tabId?t.tabId:t]||null:null},i.prototype._getMaxRemind=function(){$(".ut-tabs-fullScreen").removeClass("tu-tabs-hide"),$(".ut-tabs-fullScreen").css("position","fixed").fadeOut(3e3,function(){$(".ut-tabs-fullScreen").removeAttr("style"),$(".ut-tabs-fullScreen").addClass("tu-tabs-hide")})},i.template=["<div class='ut-tabs ut-tabs-container' style='{{style}}'>","       {{include maxRemind}}","    <div class='ut-tabs-header'>","        <div class='ut-tabs-scroller-left ut-hidden'></div>","        <div class='ut-tabs-scroller-right ut-hidden'></div>","       {{include tplTabHeader}}","    </div>","   <div class='ut-tabs-main'>","       {{each tabs as tab}}","       {{include tplTabContentItem tab}}","       {{/each}}","   </div>","</div>"],i.maxRemind=['<div class="ut-tabs-fullScreen tu-tabs-hide">  <div>按  Esc 即可退出全屏模式</div>  </div>'],i.tplTabHeader=["<div class='ut-tabs-wrap'>","   <ul class='ut-tabs-ul'>","   {{each tabs as tab}}","       {{include tplTabHeaderItem tab}}","   {{/each}}","   </ul>","</div>"],i.tplTabHeaderItem=["<li data-tabid='{{tab.tabId}}' data-href='{{tab.url}}' style='margin-left: {{margin}};'>","   <a class='ut-tabs-inner' href='javascript:void(0)'>","       <span class='ut-tabs-title {{tab.closeable | setCloseClass}}'>{{tab.title}}</span>","   </a>","   {{if tab.closeable}}","   <a class='ut-tabs-close' href='javascript:void(0)'></a>","   {{/if}}","</li>"],i.tplTabContentItem=["<div class='ut-tabs-panel ut-hidden' data-tabid='{{tab.tabId}}' style='{{tab.style}}'>","   <div class='ut-tabs-panel-body'>","       {{tab.content}}","   </div>","</div>"],i.tplDefaultTab=["<div class='ut-tabs-panel ut-tabs-default'>","   <div class='ut-tabs-panel-body' style='font-size:0;'>","       <iframe src='{{defaultTabUrl}}' frameborder='no' marginheight='0' marginwidth='0' style='width:100%;height:100%;display:block;' class='ut-scroll' allowtransparency='true'>","       </iframe>","   </div>","</div>"],i.filters={setCloseClass:function(t){return t?"ut-tabs-closable":""}},i}(t.Component);t.Tabs=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments),this._index=0}return __extends(i,e),i.prototype.hideMenu=function(){return this._hidden||(this._hidden=!0,this.hide(this.tplNode)),this},i.prototype.init=function(e){e.dataKey="id",this.setModel(new t.TreeModel({dataType:e.dataType})),e.onClickMenu&&this.on("onClickMenu",e.onClickMenu)},i.prototype.initState=function(e,i){var s=t.utils.getStyle({width:i.width,height:i.height});return{nodeList:e,tabId:i.tabId,ellipsis:i.ellipsis,style:s}},i.prototype.showPopup=function(e,i){var s,n,o,r=this.options,a=this.find(e);if(!a.length)return this;if(a[0].parentNode!==(s=document.body)&&a.appendTo(s),s=i,this.show(a),r.ellipsis){var l=a.children(),d=[];t.utils.each(l.toArray(),t.bind(function(t){d.push($(t).children("div"))},this)),this._showTitle(d)}void 0==(n=r.zIndex)&&(o=t.Window||{},n=parseInt((o.zIndex||[]).slice(-1)[0])),this._locate(a.css(t.utils.extend({},{maxHeight:t.utils.setUnit(r.popupHeight)||void 0,position:"absolute",zIndex:n||void 0})),s,5,1),this._hidden=!1},i.prototype.afterRender=function(){this._adjustMenus(),this.options.ellipsis&&this._showTitle(this.find(".ut-menus-a-bg"))},i.prototype.ready=function(e){if(this.bind("resize","window",t.utils.throttle(function(){return this._adjustMenus()},100,this)),e.tabId||e.allowNewWinOpen){var s=function(s){var n,o=$(s.currentTarget),r=o.data("href");if(t.isEmpty(r))return n=this.model.getNode(o.parent("li").data("id")),!(n&&n.children&&n.children.length)&&this;s.preventDefault(),s.stopPropagation();var a,l,d=o.data("menuid"),h=o.data("menuname"),u=o.data("tabid"),c=t.get(u),p=r.lastIndexOf(e.newOpenFlag||"target='_blank'");if(e.allowNewWinOpen&&p>-1){var f=document.createElement("a");document.body.appendChild(f),f.href=r,f.target="_blank",f.click(),document.body.removeChild(f)}else c&&c.addTab({title:h,tabId:d,url:r,closeable:!0});a=o.hasClass("ut-menus-a-bg")?o.parent().parent("li").data("rootid"):o.parent("li").data("rootid"),t.isEmpty(a)&&(a=d),l=this.find("li[data-id='"+a+"']"),i.hightMenu=a,l.removeClass("ut-menus-hover").addClass("ut-menus-hover").siblings().removeClass("ut-menus-hover")};this.bind("click",".ut-menus-a-bg",s),this.bind("click","::popup div.ut-menus-totab",s),this.bind("click",".ut-menus-li",s)}},i.prototype._adjustMenus=function(){var e=this.find(".ut-menus-ul"),i=e.parent(),s=e.outerHeight(),n=t.utils.getBoundingRect(i),o=this.find(".ut-menus-pre-next");n.height<s?this.show(o):(this.hide(o),e.css("top",0)),this.unbind("click",".ut-menus-pre").bind("click",".ut-menus-pre",t.bind(function(s){var n=this.find(".ut-menus-li"),o=n.outerHeight(),r=n.length,a=t.utils.getBoundingRect(i),l=a.outerHeight/o;if(r-this._index<=l)return!1;this._index++;var d="-="+o+"px";e.animate({top:d},200)},this)),this.unbind("click",".ut-menus-next").bind("click",".ut-menus-next",t.bind(function(t){var i=this.find(".ut-menus-li"),s=i.outerHeight();if(this._index<=0)return!1;this._index--;var n="+="+s+"px";e.animate({top:n},200)},this))},i.prototype._locate=function(e,i,s,n){if(!(e=$(e)).length||!(i=$(i)).length)return e;e.get(0).parentNode||e.appendTo(document.body),n=parseInt(n,10)||0;var o=t.utils.getBoundingRect(i),r=o.top+o.outerHeight+n,a=e.outerWidth(!0),l=e.outerHeight(!0),d=$(window),h=$(document),u=d.height(),c=d.width(),p=h.scrollLeft(),f=h.scrollTop(),m=o.top-f-n,g=f+u-r,v=o.top+o.outerHeight-l-n,y={left:5==s?o.left+o.outerWidth+n:Math.max(p,Math.min(o.left,c-a+p)),top:g>l&&5==s?o.top:m>l&&5==s?v:r<l?0:r-l};return e.css(y)},i.prototype._showTitle=function(e){var i=this.options;if(i.ellipsis){var s=e;t.utils.each(t.isArray(s)?s:s.toArray(),t.bind(function(t){var e=$(t).outerWidth(),i=$(t).height(),s=$(t).parent(),n=$(s).outerWidth(),o=$(s).height(),r=$(t).data("menuname");(n<e||o<i)&&($(t).attr("title",r),$(t).addClass("ut-menus-li-ellipsis"))},this))}},i.template="<div class='ut-menus' style='{{style}}'>  {{include tplMenu}}  <div class='ut-hidden ut-menus-pre-next'>  <span class='ut-menus-pre'>向上</span>  <span class='ut-menus-next'>向下</span>  </div> </div>",i.tplMenu="<ul data-pseudo='popup' class='ut-menus-ul'>  {{each nodeList as node index}}  {{include tplRootNode node, index,0 as level}}  {{/each}} </ul>",i.tplRootNode="<li data-id='{{node.id}}' data-pid='{{node.pid}}' class='ut-menus-li ut-menus-node' data-level='{{level}}' data-menuid='{{node.id}}' data-tabid='{{tabId}}' data-menuname='{{node.name}}'  data-href='{{node.url}}'>  {{if node.icon}}  <img src='{{node.icon}}' class='ut-menus-li-bg'/>  {{else}}  <a class='ut-menus-li-bg ut-menus-li-img'></a>  {{/if}}  <div class='ut-menus-title'>  <div class='ut-menus-a-bg' data-menuid='{{node.id}}' data-menuname='{{node.name}}' data-tabid='{{tabId}}'  data-href='{{node.url}}'>{{node.name}}  </div>  </div>  {{if node.children && node.children.length}}  {{include tplNode node, index,(level+1) as level,node.id as rootid}}  {{/if}} </li>",i.tplNode="<ul data-pseudo='popup' data-root='{{node.id}}' class='ut-hidden ut-popup ut-menus'>  {{each node.children as node index obj}}  <li data-id='{{node.id}}' data-pid='{{node.pid}}' class='ut-menus-node' data-level='{{level}}'  data-rootid='{{rootid}}'>  <div class='ut-menus-totab' data-menuid='{{node.id}}' data-tabid='{{tabId}}' data-menuname='{{node.name}}'  data-href='{{node.url}}'>{{node.name}}  {{if node.children && node.children.length}}  <span class='ut-leftnav-arrowRight'></span>  {{/if}}  </div>  {{if node.children && node.children.length}}  {{include tplNode node, index,(level+1) as level,rootid}}  {{/if}}  </li>  {{/each}} </ul>",i.hightMenu="",i.initRenderDelay=50,i.events={"'mouseenter contextmenu' ::popup .ut-menus-node":function(e){clearTimeout(this.timer);var i=$(e.currentTarget),s=i.data("id"),n=i.data("level");t.utils.each(this.find("ul.ut-popup.ut-menus").toArray(),t.bind(function(e){$(e).hasClass("ut-hidden")||t.utils.each($(e).children("li").toArray(),t.bind(function(t){var e=$(t).data("level");e>n&&this.hide(t.parentNode)},this))},this)),this.showPopup("[data-root='"+s+"']",i)},"'mouseleave' ::popup .ut-menus-node":function(t){this.timer=setTimeout(function(){$(document.body).click()},50)},"click .ut-menus-li":function(t){var e=$(t.currentTarget).attr("data-id");this.emit("onClickMenu",e)},"click document":function(e){if(this._hidden||this.hideMenu(),t.isEmpty(i.hightMenu))this.find(".ut-menus-hover").removeClass("ut-menus-hover");else{var s=this.find("li[data-id='"+i.hightMenu+"']"),n=s.data("rootid");t.isEmpty(n)||(s=this.find("li[data-id='"+n+"']")),s.removeClass("ut-menus-hover").addClass("ut-menus-hover").siblings().removeClass("ut-menus-hover")}}},i}(t.Component);t.LeftNav=e,$(function(){window.top!=window&&$(document).bind("click",function(e){t.postMessage(window.top,"__closeMenuMsgListener")})}),t.registerMessageListener("__closeMenuMsgListener",function(){$(document.body).click()})}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.ready=function(i){e.prototype.ready.call(this,i),this.catchChangeEvent(function(e,s){/^(?:-|-?\d+\.|-?\d+(?:\.\d+|\d?))$/.test(e)||""==e?(""!=e&&null!=i.max&&e>i.max&&(new t.Tips({msg:"不能超出最大值："+i.max}),this.setValue(s)),""!=e&&null!=i.min&&e<i.min&&(new t.Tips({msg:"不能超出最小值："+i.min}),this.setValue(s)),1==i.integer&&(/^(?:-|-?\d+|-?\d+(?:\d+|\d?))$/.test(e)||""==e||this.setValue(s)),0==i.minus&&(/^(?:\d+\.|\d+(?:\.\d+|\d?))$/.test(e)||""==e||(new t.Tips({msg:"不能为负数"}),this.setValue(s)))):this.setValue(s)})},i}(t.Input);t.NumberBox=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.afterRender=function(e){var i=this.find(".ut-body");if((t.isEmpty(e.selector)||t.isEmpty(e.content))&&t.isEmpty(e.selector))if(t.isEmpty(e.html))if(t.isEmpty(e.content))if(t.isEmpty(e.src))i.append($(document.createDocumentFragment()).append(this.contents));else{var s=$("<iframe frameborder='0' marginheight='0' marginwidth='0' style='width:100%;height:100%;font-size:0px;' class='ut-scroll' allowtransparency='true'></iframe>");s.attr("src",e.src),i.css({height:"100%",padding:"0px"}),this.find(".ut-main").css({padding:"0px",overflow:"hidden"}),i.append(s)}else i.text(e.content);else i.append($(e.html)),this.appendChildComponents(new t.Application({context:i}).getComponents());else i.append($(e.selector).show());(e.shadow||e.modal)&&(this._shadowId=t.fullShadow({zIndex:e.zIndex,opacity:.4,context:e.isFullShadow?null:window}))},i.prototype.init=function(e){this.options=e=t.utils.extend({width:"auto",height:"auto",collapsible:!0,draggable:!1,resizable:!1,expand:!0,closable:!1,minimizable:!1,maximizable:!1,minimized:!1,maximized:!1,modal:!1,shadow:!1,cursor:null,selector:null,src:null,html:null,content:null,zIndex:2e3,buttons:null},e),e.el&&e.el.length>0?(this.fragment=e.el,this.contents=this.fragment.contents()):e.el="body",this.defaultOpts=e,this.eventsList=[],this.buttons=[];var i=!1;if(t.utils.each(e.buttons,function(e){t.isObject(e)&&(this._initButton(e),this.buttons.push(e),/\but-primary\b/.test(e.className)&&(i=!0))},this),!i&&this.buttons.length){var s=this.buttons[0],n=s.className||"";s.className=n+" ut-primary"}for(var o,r,a,l="open expand collapse close".split(" "),d="onBefore on".split(" ");l.length;)o=t.utils.capitalize(l.pop()),t.utils.each(d,function(t){(a=e[r=t+o])&&this.on(r,a)},this);for(var h,u,c,p="minimize maxnimize restore".split(" ");p.length;)h=t.utils.capitalize(p.pop()),(c=e[u="on"+h])&&this.on(u,c)},i.prototype._initButton=function(e){var i,s=t.utils.trim(e.style);return t.isObject(s)?(i=[],t.utils.forEach(s,function(t,e){i.push(e.replace(/[A-Z]/,"-$&").toLowerCase()+":"+t)}),s=i.join(";")):t.isString(s)||(s=""),e.style=s,t.isFunction(e.onClick=e.Click||e.click)&&this.eventsList.push({selector:"."+(e.eventSelector=t.utils.uuid(12).toLowerCase()),listener:e.onClick}),t.isFunction(e.onkeydown=e.keydown)&&this.eventsList.push({selector:"body",type:"keydown",listener:e.onkeydown}),e},i.prototype.initState=function(e,i){var s,n,o,r=i.type||"panel",a=t.utils.uuid(12);return this.uuid=a,s=i.collapsible?i.expand?i.height:"auto":i.height,n=t.utils.getStyle({width:i.width,height:s,top:i.top,left:i.left,minWidth:i.minWidth,minHeight:i.minHeight}),o=t.utils.getStyle({padding:i.padding}),{title:i.title,draggable:i.draggable,resizable:i.resizable,collapsible:i.collapsible,expand:i.expand,style:n,bodystyle:o,uuid:a,type:r,closable:i.closable,shadow:i.shadow,modal:i.modal,minimizable:i.minimizable,maximizable:i.maximizable,content:i.content,zIndex:i.zIndex,
buttons:this.buttons}},i.prototype.ready=function(e){t.utils.each(this.eventsList,function(e){t.isObject(e)&&t.isString(e.selector)&&t.isFunction(e.listener)&&this.bind(e.type||"click",e.selector,e.listener)},this),this.open(),this.bind("click",".ut-panel-tool",function(t){$(t.target).hasClass("ut-panel-tool-collapse")?this.collapse():$(t.target).hasClass("ut-panel-tool-expand")?this.expand():$(t.target).hasClass("ut-panel-tool-close")?this.close():$(t.target).hasClass("ut-panel-tool-min")?this.minimize():$(t.target).hasClass("ut-panel-tool-max")?this.maxnimize():$(t.target).hasClass("ut-panel-tool-restore")&&this.restore()}),this.options.maximizable&&this.bind("dblclick",".ut-title",function(t){this.find(".ut-title:first>.ut-panel-tool>span.ut-panel-tool-max").length?this.maxnimize():this.restore()})},i.prototype.open=function(){var e=this.options;if(t.utils.some(this.emitHelper("onBeforeOpen"),!1))return this;var i=this.find(".ut-panel"),s=this.find(".ut-title:first"),n=this.find(".ut-foot:last");if(this.show(i),"window"==e.type){var o=Math.ceil(($(window).width()-i.outerWidth(!0))/2+$(document).scrollLeft()),r=Math.ceil(.382*($(window).height()-i.outerHeight(!0))+$(document).scrollTop());i.css({top:r>0?r:"0",left:o>0?o:"0"})}else e.collapsible||s.removeClass("ut-border-bottom").addClass("ut-border-bottom");return""!=this.options.height&&"auto"!=this.options.height?this.find(".ut-main").css("height",i.height()-s.outerHeight(!0)-n.outerHeight(!0)+"px"):this.find(".ut-main").css({height:"auto","min-height":i.outerHeight(!0)-s.outerHeight(!0)-n.outerHeight(!0)}),this.emit("onOpen")},i.prototype.expand=function(){if(t.utils.some(this.emitHelper("onBeforeExpand"),!1))return this;var e=this.find(".ut-main"),i=this.find(".ut-panel"),s=this.find(".ut-title:first"),n=this.find(".ut-foot:last");return this.show(e),this.options.maximized?(i.css("height",$(window).height()+$(document).scrollTop()+"px"),e.css("height",i.height()-s.outerHeight(!0)-n.outerHeight(!0)+"px")):(i.css("height",this.defaultOpts.height),""!=this.options.height&&"auto"!=this.options.height?e.css("height",i.height()-s.outerHeight(!0)-n.outerHeight(!0)+"px"):e.css({height:"auto","min-height":i.outerHeight(!0)-s.outerHeight(!0)-n.outerHeight(!0)})),"window"==this.options.type?(s.removeClass("ut-border-bottom"),this.options.buttons&&n.removeClass("ut-border-top")):(s.removeClass("ut-border-bottom").addClass("ut-border-bottom"),this.options.buttons&&n.removeClass("ut-border-top").addClass("ut-border-top")),this.find(".ut-panel-tool-expand").removeClass("ut-panel-tool-expand").addClass("ut-panel-tool-collapse"),this.emit("onExpand")},i.prototype.collapse=function(){if(t.utils.some(this.emitHelper("onBeforeCollapse"),!1))return this;var e=this.find(".ut-main"),i=this.find(".ut-panel"),s=this.find(".ut-title:first"),n=this.find(".ut-foot:last"),o=i.attr("style");return this.hide(e),t.utils.endsWith(o,";")||(o+=";"),i.css("cssText",o+"height:auto!important"),"window"==this.options.type?(s.removeClass("ut-border-bottom").addClass("ut-border-bottom"),this.options.buttons&&n.removeClass("ut-border-top")):(s.removeClass("ut-border-bottom"),this.options.buttons&&n.removeClass("ut-border-top").addClass("ut-border-top")),this.find(".ut-panel-tool-collapse").removeClass("ut-panel-tool-collapse").addClass("ut-panel-tool-expand"),this.emit("onCollapse")},i.prototype.close=function(){var e=this.options;return t.utils.some(this.emitHelper("onBeforeClose"),!1)?this:(t.fullShadow({enabled:!1,id:this._shadowId,context:e.isFullShadow?null:window}),t.fullscreen({target:this.find(".ut-panel"),enabled:!1}),this.emit("onClose"),this.destroy())},i.prototype.minimize=function(){return this.hide(this.template),this.options.minimized=!0,this.options.maximized=!1,this.emit("onMinimize")},i.prototype.maxnimize=function(){var e=this.find(".ut-panel"),i=this.options;return t.fullscreen({target:e,zIndex:this.options.zIndex,onChange:function(s){var n=s.element,o=n.find(".ut-title:first"),r=n.find(".ut-foot:last");if(n.find(".ut-panel-tool-expand").length){var a=e.attr("style");t.utils.endsWith(a,";")||(a+=";"),n.css("cssText",a+"height:auto!important;")}else n.find(".ut-main").css("height",n.height()-o.outerHeight(!0)-r.outerHeight(!0)+"px");i.minimized=!1,i.maximized=!0}}),e.find(".ut-panel-tool-max").removeClass("ut-panel-tool-max").addClass("ut-panel-tool-restore"),this.emit("onMaxnimize")},i.prototype.restore=function(){var e=this.find(".ut-panel"),i=this.options,s=this.defaultOpts;return t.fullscreen({target:e,enabled:!1,onChange:function(t){var n=t.element,o=n.find(".ut-title:first"),r=n.find(".ut-foot:last"),a="auto";n.find(".ut-panel-tool-expand").length||(a=s.height||"auto"),e.css({width:s.width||"auto",height:a,minHeight:s.minHeight,minWidth:s.minWidth}),"auto"==a?n.find(".ut-main").css({height:"auto","min-height":n.outerHeight(!0)-o.outerHeight(!0)-r.outerHeight(!0)}):n.find(".ut-main").css("height",n.height()-o.outerHeight(!0)-r.outerHeight(!0)+"px"),i.minimized=!0,i.maximized=!1}}),e.find(".ut-panel-tool-restore").removeClass("ut-panel-tool-restore").addClass("ut-panel-tool-max"),this.emit("onRestore")},i.prototype.html=function(e){t.utils.each(this.childComponents,function(e,i){e instanceof t.Component&&!e.destroyed&&(e.destroy(),this.childComponents[i]=null,t.utils.remove(this._childComponents,e))},this),t.utils.remove(this.childComponents,null);var i=this.find(".ut-body").empty().append($(e));this.setChildComponents(new t.Application({context:i}).getComponents())},i.initRenderDelay=0,i.template=["<div class='ut-panel ut-{{type}} ut-box {{uuid}} ut-hidden' style='{{style}};z-index:{{zIndex}};'>","    <div class='ut-title {{if collapsible}}{{ expand | setTitleClass : type}}{{/if}}'>","        <div class='ut-panel-title'>{{title}}</div>","        <div class='ut-panel-tool'>","           {{if minimizable}}","            <span class='ut-panel-tool-min'></span>","           {{/if}}","           {{if maximizable}}","            <span class='ut-panel-tool-max'></span>","           {{/if}}","           {{if collapsible}}","            <span class='{{if collapsible}}{{expand | setClass}}{{/if}}'></span>","           {{/if}}","           {{if closable}}","            <span class='ut-panel-tool-close'></span>","           {{/if}}","        </div>","    </div>","    <div class='ut-main {{if collapsible}}{{expand | setHiddenClass}}{{/if}}'>","        <div class='ut-body' style='{{bodystyle}}'>","        </div>","    </div>","    {{if buttons.length}}","    <div class='ut-foot {{type | setFootClass}}'>","       <div class='ut-float-rt' style='line-height:0px;'>","       {{each buttons as btn}}","           <button type='button' id='{{btn.id}}' name='{{btn.name}}' {{btn.customs | getCustom}} class='ut-button {{btn.eventSelector}} {{btn.className}} ' style='{{btn.style}}'>{{btn.text}}</button>","       {{/each}}","       </div>","    </div>","    {{/if}}","</div>"],i.filters={setTitleClass:function(t,e){return"window"==e?t?"":"ut-border-bottom":t?"ut-border-bottom":""},setClass:function(t){return t?"ut-panel-tool-collapse":"ut-panel-tool-expand"},setHiddenClass:function(t){return t?"":"ut-hidden"},getCustom:function(t){var e="";for(var i in t)e+=i+"= "+t[i]+"  ";return e},setFootClass:function(t){return"window"==t?"":"ut-border-top"}},i}(t.Component);t.Panel=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(t){t.type="radio",e.prototype.init.apply(this,arguments)},i.prototype.setValue=function(e){if(void 0!=(e=t.utils.trim(e))){e=(t.isArray(e)?e[0]:e)+"";var i=this.model,s=i.select({value:e})[0];s&&(i.forEach(function(t){t&&(t.checked=t.key===s.key)}),i.changed(),this.value=e)}return this},i.events={"click .ut-wrap":function(t){var e=$(t.currentTarget),i=this.model,s=i.select("key",e.data("id"))[0];!s||s.readonly||s.disabled||(i.forEach(function(t){t.checked=t.key===s.key}),i.changed(),this.value=this.getValue())}},i}(t.CheckGroup);t.RadioGroup=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){this._parseSelectElement(e),this.options=e=t.utils.extend({fields:[{field:"text",type:"string"},{field:"value",type:"string"}],dataKey:"id"},e),this.multiple=e.multiple,this.disabled=e.disabled,this.readonly=e.readonly,this.editable=!1,void 0==e.value&&(e.value=""),e.onChange&&this.on("onChange",e.onChange),e.onBeforeSelect&&this.on("onBeforeSelect",e.onBeforeSelect)},i.prototype.click=function(){return this.readonly||this.disabled||(this._setMaxHeight(),this.showPopup(this.tplList,null,"fadein"),this._isFocused=!0,this.emit("focus")),this.emit("click","",null),this},i.prototype.dataFilter=function(t){return t},i.prototype.afterFetch=function(e){t.isArray(e)&&(this.model.data=t.utils.filter(e,function(e){return!t.isEmpty(t.utils.trim(e.text))}))},i.prototype._setMaxHeight=function(){var t,e,i,s,n,o,r,a=this.options,l=a.popupHeight;return void 0!=l&&"auto"!=a._popupHeight||(a._popupHeight="auto",t=this.getRootElement(),e=$(window),i=$(document),s=i.scrollTop(),o=t.offset()||{top:s},n=e.height(),r=t.outerHeight(),l=Math.max(Math.max(s+n-o.top-r,o.top-s)-10,50)),a.popupHeight=l,this},i.prototype.initState=function(e,i){this.value=this.getValue();var s=this.getText();return{id:i.id,list:t.isArray(e)?e:[],value:this.value,name:this.name,style:t.utils.getStyle({width:i.width,height:i.height,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:i.minHeight,color:i.color})+";"+(i.style||""),text:this.multiple?s.join(","):s,multiple:this.multiple,editable:this.editable,disabled:this.disabled,iconFontClass:i.iconFontClass,iconDir:i.iconDir}},i.prototype.ready=function(t){void 0!=t.value?this.model.size()?this._initValue():this.once("onAfterRender",this._initValue):this._initValue()},i.prototype._initValue=function(){this.setValue(this.options.value),this.listenTo("value",function(t,e){this.emit("change",this.value=t,e,this.getSelectedItems())})},i.prototype.getText=function(){return this._getItem("text")},i.prototype.getValue=function(){return this._getItem("value")},i.prototype.getSelectedItems=function(){return this.model.select({selected:!0})},i.prototype.getItem=function(e){var i=this.model.select({value:e})[0];return t.isObject(i)?i:null},i.prototype.setValue=function(e){if(void 0!=(e=t.utils.trim(e))){this.value=e+="";var i=this.multiple?t.isArray(e)?e:e.split(","):t.isArray(e)?e:[e];this.model.forEach(function(e){e.selected=t.utils.some(i,function(t){return t==e.value})}),this.model.changed(),this.getSelectedItems().length||this.find("input").val(this.value="")}return this},i.prototype._getItem=function(e){var i=this,s=this.model.select({selected:!0}),n=t.utils.map(s,function(t){return t[e]});return this.multiple||(n=n[0]),"value"==e&&this.model.forEach(function(e){var s=e.value;s=void 0==s?"":s+"",i.multiple?t.utils.some(n,s)&&(e.selected=!0):s==(void 0==n?"":n+"")&&(e.selected=!0)}),void 0!=n?n:""},i.prototype._hideList=function(){this._isFocused&&!t.utils.some(this.emitHelper("onBeforeHide"),!1)&&(this.hide(this.tplList),this._isFocused=!1,this.emit("blur"))},i.prototype._parseSelectElement=function(e){var i,s,n,o=e.el;o.is("select")&&(i=[],s=[],o.find("option").each(function(e,o){var r=$(o),a=!!r.attr("selected");i.push({text:t.utils.trim(r.text()),value:n=t.utils.trim(o.value),selected:a}),a&&!t.isEmpty(n)&&s.push(n)}),!i.length&&(i=void 0),t.utils.extend(e,{data:i}),void 0===e.value&&s.length&&(e.value=e.multiple?s.join(","):s[0]))},i.initRenderDelay=0,i.template=["<div style='{{style}}' class='ut-box ut-select'>","   {{include tplSelect}}","   <div class='ut-wrap'>","<i class='iconfont {{iconFontClass}} {{iconDir}}' aria-hidden=true></i>","       {{include tplInput}}","   </div>","  {{include tplList}}","</div>"],i.tplSelect=["<select {{multiple}} name='{{name}}' id='{{id}}' {{disabled}} style='display:none;'>","   {{each list as item}}","       <option value='{{item.value}}' {{item.selected ? 'selected' : ''}}>{{item.text}}</option>","   {{/each}}","</select>"],i.tplInput=["<input readonly value='{{text}}'>"],i.tplList=["<ul data-pseudo='popup' class='ut-select ut-list ut-shadow ut-hidden ut-popup'>","   {{each [list]}}","       {{include tplItem $value as item}} ","   {{/each}}","</ul>"],i.tplItem=["<li data-id='{{item.id}}' title='{{item.text}}' class='{{item.selected | setClass}}'>{{item.text}}</li>"],i.filters={setClass:function(t){return t?"ut-selected":""}},i.events={"click .ut-wrap":function(){this.click()},"click ::popup li":function(e){var i=$(e.currentTarget).data("id"),s=this.model,n=s.select("id",i)[0]||{},o=n.selected;t.utils.some(this.emitHelper("onBeforeSelect",n,this.getSelectedItems()),!1)||(!this.multiple||t.isEmpty(n.value)?(s.forEach(function(t){t.selected=!1}),n.selected=!0):(s.forEach(function(e){t.isEmpty(e.value)&&(e.selected=!1)}),n.selected=!o),s.update(n),!this.multiple||t.isEmpty(n.value)?this._hideList():(this._setMaxHeight(),this.showPopup(this.tplList)),n&&!t.isEmpty(t.utils.trim(n.text))&&this.emit("onSelect",n.value,n),this.emit("click",n?n.value:"",n||null))},"click document":function(t){this._isFocused&&t.srcComponent!==this&&this._hideList()}},i}(t.TextBox);t.Select=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){e.dataKey="id";var i=e.dataType;void 0==i&&(e.dataType="tree"),void 0==e.strictCheck&&e.async&&(e.strictCheck=!0),this.setModel(new t.TreeModel({dataType:e.dataType,rootPid:e.rootPid,preventChangeEvent:!0,preventDataClone:!0,preventDataMerge:!0,async:!!e.async})),this.preventStateClone=!0,this.root=this._tree={id:t.utils.uuid(10),pid:t.utils.uuid(10),name:"/",_isLeaf:!1,_level:-1,_fetched:!0};for(var s,n,o,r="click dblClick expand collapse hover hoverOut check select contextMenu remove append change search edit".split(" "),a="onBefore on onAfter".split(" ");r.length;)s=t.utils.capitalize(r.pop()),t.utils.each(a,function(t){(o=e[n=t+s])&&this.on(n,o)},this);this.initOptions(e)},i.prototype.getRepaintDynamicLinesHandler=function(){return function(){clearTimeout(this._dynamicLinesTimer);var t=arguments,e=this;this._dynamicLinesTimer=setTimeout(function(){e.repaintDynamicLines.apply(e,t)},350)}},i.prototype.initOptions=function(e){return t.isIE&&t.browserVersion<10&&(e.animationSpeed=0),e.expandLevel=Math.max(parseInt(e.expandLevel)||0,0),e.radio&&(e.checkbox=!1),void 0!==e.border&&!e.border&&(e.border="none"),t.isEmpty(t.utils.trim(e.url))||(e.data=null),e.classicStyle&&(e.lines=e.dynamicLines=!1),this.off("onHover",this._dynamicLinesHoverHandler||t.voidFunc).off("onHoverOut",this._dynamicLinesOutHandler||t.voidFunc),e.dynamicLines&&this.on("onHover",this._dynamicLinesHoverHandler=this.getRepaintDynamicLinesHandler()).on("onHoverOut",this._dynamicLinesOutHandler=t.bind(this.repaintDynamicLines,this,!1)),this},i.prototype.afterFetch=function(e){!this.root._rendered&&t.isArray(e)&&e.length&&this.repaint(null,!0)},i.prototype.render=function(t){return this.initTree(t.node,t.expandLevel)},i.prototype.afterRender=function(t){this.makeStripes();var e=t.expanded;e&&(t.expanded=null,this.expand(e))},i.prototype.ready=function(t){this._hoverTargetClass&&this.unbind("hover",this._hoverTargetClass,this._hoverHandler),(t.onHover||t.onHoverOut||t.dynamicLines)&&this.bind("hover",this._hoverTargetClass=t.classicStyle?".ut-tree-ttl":".ut-tree-node",this._hoverHandler=function(t){var e=t.type,i=$(t.currentTarget).parents(".ut-tree-root:first"),s=this.getNode(i.data("id"));this.emit(/(?:enter|over)$/.test(e)?"onHover":"onHoverOut",s,i)})},i.prototype.initTree=function(e,i){var s=e||this.root||this._tree,n=s.children||this.model.data;if(!t.isArray(n)&&t.isObject(n)&&(n=[n]),!t.isArray(n))return $();var o,r,a,l,d=this.options,h=d.checked,u=d.checkedNodes,c=n;if(d.checked=d.checkedNodes=null,d.rootVisible===!1){for(c=[],r=0;r<n.length;r++)for(a=0,l=this.getChildren(n[r],1);a<l.length;a++)c.push(o=l[a]),o._parent=e,o.parent=o.parents=null;d.rootVisible=0}return this.setChildren(s,c),t.isString(h)&&(h=h.split(",")),t.isString(u)&&(u=u.split(",")),h?this.mergeCheckNodes(h,!0,!0,!0):u&&this.setCheckedState(u),this.makeNodeElement(this.makeTree(s,i))},i.prototype.makeTree=function(e,s){var n,o=this.options,r={node:e};return this.tplTree||(n=this.makeNode,this.tplTree=this.makeTemplate(i.tplTree,"tree",n),this.tplRoot=this.makeTemplate(i.tplRoot,"root",n),this.tplNode=this.makeTemplate(i.tplNode,"node",n),this.tplIndent=this.makeTemplate(i.tplIndent,"indent",t.voidFunc)),r.style=t.utils.getStyle({width:o.width,height:o.height,border:o.border}),r.expandLevel=void 0==s?o.expandLevel:+s||0,this.root=e,this.tplTree.render(r)},i.prototype.makeNode=function(e,i){if("tplIndent"===e)return this.tplIndent.render(i);if("tplRoot"===e)return this.root._rendered=!0,this.tplRoot.render(i);var s,n,o,r,a,l=this.options,d=i.node,h=l.icons;if(i=t.utils.extend({lines:l.lines,checkbox:l.checkbox,radio:l.radio,leftSideCheck:l.leftSideCheck,useImageIcon:t.isObject(h)&&!!h.useImage},i),"tplNode"===e)if(a=this._xPathMap){if(!(d.id in a))return i.expandLevel=0,d._rendered=!1,"";3===a[d.id]&&(i.expandLevel=0,this.setXPathMap(d))}else d._xPathMap=null,this.isFetched(d)?(a=this._xPath)&&(t.utils.startsWith(a,r=this.getXPath(d),!0)?r.join()===a.join()?(o=(this.getParent(d)||this.root).children,this._xPathMatched=o[o.length-1],this._xPathMatched||(this._xPath=null)):this._xPathMatched===d&&(this._xPath=this._xPathMatched=null):i.expandLevel=0):i.expandLevel=0;else"expand"===e&&(this._isLast=[],n=0,t.utils.each(this.getParents(d),function(t){this._isLast[n++]=+(this._xPathMap?this.isXPathLast(t):this.isLast(t))},this),s=(this.getParent(d)||this.root).children||[],d._xPathMap||this.resetExpandedLevel(d),t.utils.extend(i,{expandLevel:n+(i.expandLevel||1),level:n,expanded:i.expanded||!1,length:s.length,isLeaf:this.isLeaf(d),index:t.utils.indexOf(s,d)}));return d._rendered=!0,this.tplNode.render(i)},i.prototype.getXPath=function(e,i){if(!(e=this.getNode(e)))return[];if(!i&&e._xPath)return e._xPath.slice();var s,n=this.getParents(e,!0);return(i=this.getNode(i))?s=n.slice(t.utils.indexOf(n,i.id)):(s=n.concat(e.id),e._xPath=s.slice()),s},i.prototype.getCheckState=function(e,i,s){if(s=s||{},s[e.id])return e._checked;s[e.id]=1;var n,o=this.options;return i?+e.checked||0:o.strictCheck||o.radio?o.onlyLeafCheckable?0:+e._checked||0:(n="",t.utils.treeWalker(e.children,function(t){return void 0===t._checked&&(t._checked=this.getCheckState(t,this.isLeaf(t),s)),n+=String(t._checked),!1},!1,"children",this),""===n?+e._checked||0:/^0*$/.test(n)?0:/^1+$/.test(n)?1:2)},i.prototype.setNodeCheckState=function(e,i,s,n,o){void 0==n&&(n=this.isLeaf(e));var r=this.options,a=r.checkbox,l=r.radio;l?((t.isFunction(l)||t.isFunction(l=l[n?"leaf":"root"]))&&(l=l.call(this,e)),l=l!==!1,a=!1):a&&((t.isFunction(a)||t.isFunction(a=a[n?"leaf":"root"]))&&(a=a.call(this,e)),a=a!==!1);var d=!!e.checked,h=!!r.onlyLeafCheckable,u=!!e.disabled,c=u?d:!(!n&&h)&&1==i,p=!!e._checkDisabled||!n&&h;if(e._checked=u?+c:i,c!==d&&(o?(p=e._checkDisabled=t.utils.some(this.emitHelper("onBeforeCheck",e,c),!1))||this.emit("onCheck",e,e.checked=c):p||this.emit("onCheck",e,e.checked=c)),s!==!0){c=u?d:n?!!e.checked:1==i,p=!n&&p;var f=!!r.strictCheck,m=!!r.preventCheckStyle,g=!n&&2==i,v="ut-checked",y="ut-disabled",b="ut-check-disabled",x="ut-checked-some",w="ut-check-hdn",C="ut-check-tsp",_=[];return(!a&&!l||h&&!n&&(l||f))&&_.push(w),m&&_.push(C),g?_.push(x):c&&_.push(v),u?_.push(y):p&&_.push(b),_=_.join(" "),s?void((s=this.getNodeElement(s,s,"node")).length&&s.removeClass([v,y,b,x,w,C].join(" ")).addClass(_)):_}},i.prototype.setChildren=function(e,i,s){if(s&&e||(e=this.getNode(e))){t.isArray(i)||(i=e.children||[]);var n,o,r,a,l=i.length,d=null,h=null,u=this.root;if((s||!e._sorted)&&(e._sorted=!0,e.roots=o=[],e.leaves=n=[],l||!this.isLeaf(e))){if(l){for(e!==this.root&&(e._isLeaf=void 0),r=this.getParents(e).concat(e);l--;)(a=i[l])&&t.utils.indexOf(r,a)===-1&&(a.parent=e===u?null:e,a.parents=null,this.isLeaf(a)?(a.nextSibling=h,n.unshift(a),(h||{}).prevSibling=h=a):(a.nextSibling=d,o.unshift(a),(d||{}).prevSibling=d=a));a=(n[0]||{}).prevSibling=o[o.length-1]||null,(a||{}).nextSibling=n[0]||null}i=e.children=o.concat(n),((e.firstChild=i[0]||null)||{}).prevSibling=((e.lastChild=i[i.length-1]||null)||{}).nextSibling=null}}return this},i.prototype.freshAncestorCheckState=function(e,i,s){var n=this.options;if(n.strictCheck||n.radio)return this;var o=this.getParents(e),r=s||this.getNodeElement(o[0]);return i&&e&&o.push(e),t.utils.each(o.reverse(),function(t){this.setNodeCheckState(t,this.getCheckState(t),s||this.getNodeElement(t,r),void 0,1)},this),this},i.prototype.toggleCheck=function(e,i,s,n,o,r,a,l){if(void 0==i&&(i=1!=e._checked),i=!!i,!(e=this.getNode(e)))return this;var d=this.options,h=!!d.radio,u=!!d.onlyLeafCheckable,c=!!d.strictCheck,p=this.isLeaf(e),f=this.root;if(l=!c&&!a&&(void 0==l?d.autoExpand:!!l),r=!a&&(void 0==r?!!d.autoScroll:!!r),p||!u||!h)if(l=void 0==l||!!l,s=a||this.getNodeElement(e,s),h)t.utils.each(this.getCheckedNodes(),function(t){this.setNodeCheckState(t,0,a||this.getNodeElement(t),void 0,1)},this),i&&this.setNodeCheckState(e,1,s,p,1);else if((d.checkbox||d.checkOnSelect)&&(c?this.setNodeCheckState(e,+i,s,p,1):((e!==f&&!e._rendered||e===f&&(i||1e6===e._expandedLevel))&&(a=!0),t.utils.treeWalker(e,function(t){this.setNodeCheckState(t,+i,a||!t._rendered||this.getNodeElement(t,s),void 0,1)},!1,"children",this),this.freshAncestorCheckState(e)),i&&(e===f||!p&&l&&this.isFetched(e))||!i&&e===f&&1e6===e._expandedLevel))return this.setXPathMap(e).expand(e,!0,o,n,r);return r?this.scrollIntoView(e,n,o):o&&o.call(this,e),this},i.prototype.check=function(e,i,s,n,o,r){void 0===i&&(i=!0);var a;return 1===arguments.length&&e!==this.root&&t.isObject(e)&&!this.isExist(e)&&(a=e,e=a.nodes||a.node,i=void 0===a.checked||!!a.checked,s=a.callback,n=a.silence,o=a.scroll,r=a.expand),t.isArray(e)&&e.length>1?(t.utils.each(this.mergeCheckNodes(e,!!i),function(t){this.toggleCheck(t,!!i,null,!0,null,!1,!1,!1)},this),s&&s.call(this)):(e=this.getNode(t.isArray(e)?e[0]:e))?(e===this.root&&(n=!0,o=!1),this.toggleCheck(e,!!i,null,n,s,o,!1,r),!(void 0!=o?o:this.options.autoScroll)&&this.toggleClass(e,null,"select",!0)):s&&s.call(this),this},i.prototype.setCheckedState=function(e,i){void 0===i&&(i=!0);var s,n;for(t.isArray(e)||(e=[e]),n=0;n<e.length;n++)(s=this.getNode(e[n]))&&(s._checked=+(s.checked=!!i));return this},i.prototype.mergeCheckNodes=function(e,i,s,n){var o,r=this.options;if(t.isArray(e)||(e=t.isEmpty(e)?[]:[e]),!(e=this.toNodes(e)).length)return e;if((i=!!i)&&s&&t.utils.each(this.getCheckedNodes(),function(i){t.utils.some(e,i)||e.push(i)}),r.radio)e=i?[e[0]]:[];else if(!r.strictCheck)for(o=0;o<e.length;o++)t.utils.intersection(this.getParents(e[o]),e,!0)&&e.splice(o--,1);return n&&t.utils.each(e,function(t){this.toggleCheck(t,i,null,!0,null,!1,!0)},this),e},i.prototype.mergeXPaths=function(e,i){var s,n,o,r,a,l,d,h,u={},c={};for(a=0,d=e.length;a<d;a++)if((n=this.getXPath(e[a])).length){for(s=u[n[0]]||[],l=0;l<s.length;l++){if(t.utils.startsWith(o=s[l],n,!0)){n=null;break}if(t.utils.startsWith(n,o,!0)){s.splice(l--,1);break}}n&&(s.push(n),u[n[0]]=s)}if(i)return u;for(r in u)if(s=u[r],1===s.length&&1===s[0].length)c[s[0][0]]=3;else for(a=0,d=s.length;a<d;a++)for(n=s[a],l=0,h=n.length-1;l<=h;l++)c[n[l]]=0===l?1:l===h?3:2;return c},i.prototype.setXPathMap=function(e,i){var s,n=this._xPathMap,o=this.root;if(!n||e._xPathMap&&e!==o)n||(e._xPathMap=null);else{if(e===o)return t.utils.each(i,function(t){n[t.id]=2}),this;s=function(t){for(var e=0,i=t.children||[],s=i.length;e<s;e++)if(!(i[e].id in n))return t._expandedLevel=0},2===(n[e.id]=this.isLeaf(e)?3:2)&&t.utils.treeWalker(e,function(t,e){s(t),n[t.id]=(e._xPathMap=e._xPathMap||{})[t.id]=2},!1,"children",this,e),t.utils.each(this.getParents(e),function(t){s(t)})}return this},i.prototype.getCheckedNodes=function(e){var i=t.utils.filter(this.model.getNodeMap(),function(t){return t.checked&&!t._removed});return e?t.utils.map(i,function(t){return t.id}):i},i.prototype.setAsyncCheckedNodes=function(t){},i.prototype.getAsyncCheckedNodes=function(e){for(var i,s,n,o=this._checked=this._checked||[],r=o.length;r--;)!this.isExist(n=(s=o[r]).id)||!s._removed&&this.isChecked(n)||o.splice(r,1);return i=t.utils.map(o,function(t){return t.id}),t.utils.each(this.getCheckedNodes(!0),function(e){t.utils.some(i,e)||o.push(this.getNode(e))},this),e?t.utils.map(o,function(t){return t.id}):o.slice()},i.prototype.getIndeterminateCheckNodes=function(e){var i=t.utils.filter(this.model.getNodeMap(),function(t){return!t._removed&&2===t._checked});return e?t.utils.map(i,function(t){return t.id}):i},i.prototype.getSelectedNodes=function(t){var e,i=this,s=[];return!this.options.preventSelection&&this.find(".ut-selected").each(function(n,o){e=$(o).parent().data("id"),s.push(t?e:i.getNode(e))}),s},i.prototype.clearSelection=function(){if(!this.options.preventSelection){var t="ut-selected";this.find("."+t).removeClass(t)}return this._selected=this._focused=null,this},i.prototype.getParent=function(t){return this.getParents(t).pop()||null},i.prototype.getParents=function(e,i){var s,n,o,r,a;if(e=s=this.getNode(e)){if(t.isArray(e.parents))n=e.parents;else for(r={},n=[];o=this.getNode(e.parent);){if(e===o||e.id===o.id||r[o.id]){e.parent=null,t.utils.remove(n,o);break}r[e.id]=r[o.id]=1,n.unshift(o),e=o}s.parents=n}return a=n&&n.slice()||[],i?t.utils.map(a,function(t){return t.id}):a},i.prototype.getChildren=function(t,e){if(t===this.root||(t=this.getNode(t))){var i=t.children||[];return e?i:i.slice()}return[]},i.prototype.getAllChildren=function(e){var i=[];return t.utils.treeWalker(this.getChildren(e,1),function(t){i.push(t)},!1,"children",this),i},i.prototype.getSiblings=function(e,i){var s=[],n=0;return(e=this.getNode(e))&&(t.utils.each((this.getParent(e)||this.root).children,function(t,o){e===t?n=o:s.push(i?t.id:t)}),s.length&&s.splice(n,1)),s},i.prototype.toggleExpand=function(e,i,s,n,o,r){function a(t,e,i){u?this.toggleExpand(u.shift(),u,i,n,o,r):r?this.scrollIntoView(t,n,o):o&&o.call(this,t,e,i)}if(!(e=this.getNode(e))||e===this.root)return this;var l,d,h,u,c,p,f=this.getNodeElement(e,s),m=this.isExpanded(f),g=1,v=null,y=e;if(r=!!(void 0==r?this.options.autoScroll:r),void 0==i?i=!m:t.isNumber(i)?g=Math.max(Math.min(i,1e6),1):t.isArray(i)&&i.length&&(u=i),t.utils.some(this.emitHelper("onBefore"+((i=!!i)?"Expand":"Collapse"),e),!1))return this;if(this.isFetched(e)){if(!f.length)return t.utils.each(this.getParents(e),function(t){if(!t._rendered)return!(v=t.parent)},this),!v&&(v=this.getParent(e)),v?(c=(p=this.getRootElement()).scrollTop(),this._xPath=this.getXPath(e),f=this.replaceNodeElement(this.makeNode("expand",{node:v,expandLevel:this.getNodeLevel(e)-this.getNodeLevel(v)+g}),this.getNodeElement(v)),this._xPath=null,c&&p.scrollTop(c),e=v,t.utils.each(this.getParents(v).reverse(),function(t){if(!this.isExpanded(t))return!(v=t)},this),this.toggleExpand(v,this.getXPath(e,v),e===v?f:this.getNodeElement(v),n,function(){r?this.scrollIntoView(y,n,o):o&&o.call(this,y,!0)},!1)):this;if(!this.isLeaf(e)&&(e._expandedLevel||0)<g&&(!n&&m&&e._expandedLevel||(c=(p=this.getRootElement()).scrollTop(),f=this.replaceNodeElement(this.makeNode("expand",{node:e,expandLevel:g}),f),c&&p.scrollTop(c),h=!0)),"force"!==n&&!this.isVisible(e))return t.utils.each(this.getParents(e),function(t){if(!this.isVisible(t))return!(v=t.parent)},this),!v&&(v=this.getParent(e)),this.toggleExpand(v,this.getXPath(e,v),f=this.getNodeElement(v),n,function(){this.toggleExpand(e,g,this.getNodeElement(e,f),n,o,r)},!1);if(1==g&&(h=!0),!h&&e.roots&&(d=e.roots.length))return l=0,g=1e6==g?g:g-1,m?t.utils.each(e.roots,function(t){l++,d--,this.toggleExpand(t,g,f,n,function(){--l||d||a.call(this,e,!0,f)},!1)},this):t.utils.each(e.roots,function(t){l++,d--,this.toggleExpand(t,g,f,"force",function(){--l||d||this.toggleExpand(e,1,f,n,o,r)},!1)},this),this}return!u||n&&!t.isNumber(n)||(n=Math.ceil((n?n:Math.abs(parseInt(this.options.animationSpeed))||200)/Math.sqrt(u.length))),this.toggleAnimate(e,f,i,n,a)},i.prototype.toggleAnimate=function(e,i,s,n,o){function r(){this.toggleClass(e,i,"expand",s,a),e._expanded=s,this.emit(s?"onExpand":"onCollapse",e),o&&o.call(this,e,s,i),this.repaintDynamicLines(e,i)}var a,l=this.options,d=l.animationSpeed;return s=!!s,this.isLeaf(e)||!this.isFetched(e)||s===this.isExpanded(i=i||this.getNodeElement(e))?(o&&o.call(this,e,s,i),this):(!this.getChildren(e,1).length||n&&!t.isNumber(n)||void 0!=d&&!d?r.call(this):(d=Math.abs(parseInt(d))||200,(a=this.getChildrenElement(i)).length&&a[s?"slideDown":"slideUp"](t.isNumber(n)?n:d,t.bind(r,this))),this)},i.prototype.toggleClass=function(e,i,s,n,o){if(!(e=this.getNode(e)))return this;var r,a,l,d,h,u=" ut-animation",c=" ut-focus";switch(s){case"expand":r="ut-expanded",i=i||this.getNodeElement(e),i.toggleClass(r,!!n),(o||this.getChildrenElement(i)).css("display",""),this.makeStripes();break;case"select":if(this._selected=!0,this.options.preventSelection||e.disabled)break;r="ut-selected ",i=i||this.getNodeElement(e,null,"node"),l="ctrl"!==o&&this.find("."+r).removeClass(r+u),"shift"!==o?this._focused=e:(l=this.getNodeElement(this._focused,null,"node"),l.length&&((l=l.get(0))!==(i=i.get(0))&&(d=[],this.find(".ut-tree-node:visible").each(function(){return(this===l||this===i)&&(a=!a),void 0!=a&&d.push(this),a})),i=$(d||i))),"ctrl"===o?i.toggleClass(r):i.addClass(r+(n&&u||"")),this.getRootElement().addClass(c),this.emit("onSelect");break;case"loading":r="ut-loading","fetch"===n&&this.getNodeElement(e).toggleClass(r,void 0==o?void 0:!!o);break;case"edit":if(e.disabled)break;a="contenteditable",r="ut-editing",i=i||this.getNodeElement(e),i=i.toggleClass(r,!!n).children(".ut-tree-node").removeClass("ut-selected").removeAttr("title").find(".ut-tree-name"),h=o?null:t.bind(function(e,i,s){s=this.getNodeElement(e,null,"name"),this.once("onChange",i=function(){this.toggleClass(e,null,"edit",!1,!0),s=e=i=null}).setNodeProps(e,{name:t.utils.trim(s.text())},!0),e&&i.call(this.off("onChange",i))},this,e),n?(i.attr(a,!0).css("max-width",this.getRootElement().width()-90).keydown(function(t){13===t.keyCode&&h()}).focus(),t.utils.preventAppendHTML(i),t.utils.moveCursorToEnd(i),this._editing=e):o?(i.removeAttr(a).css("max-width","").unbind("keydown").clone(!1).replaceAll(i).text(e.name),this._editing=null,this.emit("onAfterEdit",e).toggleClass(e,null,"select",!0)):h()}return this._highlighting&&("expand"===s||"edit"===s&&!n)&&t.utils.highlight(this.getNodeElement(e).get(0),this._filtered,"span",this._highlighting),this},i.prototype.makeStripes=function(){var t=this.options;return t.radio||t.checkbox||!t.stripes||this.find(".ut-tree-node:visible").each(function(t){$(this).toggleClass("ut-tree-stripe",!!(t%2))}),this},i.prototype.repaint=function(i,s){var n=this.options;return this.initOptions(t.utils.extend(n,i,{data:null})),this.isReady()&&this.ready(n),e.prototype.repaint.call(this,n,s)},i.prototype.redraw=function(t){return this.repaint(t,!0)},i.prototype.empty=function(){var e=this.root||this._tree||{};return this.find(".ut-tree-tree").remove(),this.model.drop(),e._expandedLevel=0,e.children=e._xPath=e._xPathMap=null,e._rendered=e._isLeaf=e._removed=e._sorted=e._expanded=!1,e._fetched=!0,e._level=-1,e.name="/",e.id=e.id||t.utils.uuid(10),e.pid=e.pid||t.utils.uuid(10),this._focused=this._selected=this._filtered=this._editing=this._highlighting=this._async=this._checked=this._xPath=this._xPathMap=null,this.root=this._tree=e,this},i.prototype.reload=function(i){return this.empty().initOptions(t.utils.object(i)),e.prototype.reload.call(this,i),this},i.prototype.reloadTree=function(t){return e.prototype.reload.call(this,t),this},i.prototype.repaintNodeLines=function(e){if(void 0==e||!this.options.lines)return this;var i,s="ut-last";
if(e===this.root)return i=e.children||[],this.repaintNodeLines(i[i.length-1]);var n,o,r=this._isLast=[],a=0,l=this._xPathMap;return t.utils.each(this.getParents(e),function(t){r[a++]=+(l?this.isXPathLast(t):this.isLast(t))},this),n=this.getNodeElement(e),t.utils.treeWalker(e,function(t){return!(!(t=this.getNode(t))||!t._rendered)&&(r[a=this.getNodeLevel(t)]=+(l?this.isXPathLast(parent):this.isLast(parent)),(o=this.getNodeElement(t,n)).toggleClass(s,!!r[a]),void(a&&this.replaceNodeElement(this.tplIndent.render({node:t,level:a}),this.getNodeElement(o,n,"indent"))))},!1,"children",this),this},i.prototype.repaintDynamicLines=function(t,e){if(!this.options.dynamicLines||!this.isReady())return this;clearTimeout(this._dynamicLinesTimer);var i,s,n,o,r,a,l,d,h=!0,u=[];if(t===!1&&(t=e,e=arguments[2],h=!1),!(t=this.getNode(t))||t===this.root||!h&&!t._linking||(this._xPathMap?this.isXPathFirst(t)&&this.isXPathLast(t):this.isFirst(t)&&this.isLast(t)))return this;if(e=(e||this.getNodeElement(t)).parent(),s=(l=this.getParent(t)||this.root).leaves||[],n=l.roots||[],i=this._xPathMap){for(d=0;d<s.length&&!((a=s[d]).id in i);d++)a=null;if(!h){for(d=0;(r=n[d++])&&!this.isXPathLast(r);)r=null;r&&r._linking&&(a=r)}}else a=s[0],!h&&(r=n[n.length])&&r._linking&&(a=r);return a||(e=e.children(".ut-tree-root:not(:last)")),o=this.getNodeLevel(t),e.find(".ut-tree-node").each(function(){u.push($(this).children(":eq("+o+")")[0])}),$(u).toggleClass("ut-tree-line",t._linking=h),this},i.prototype.setExpandedLevel=function(e,i,s){var n=1e6;return i=+i||0,e._expandedLevel=i=i>=n?n:Math.max(i-s,0),t.utils.each([this.root].concat(this.getParents(e)).reverse(),function(t){t._expandedLevel=i==n?n:++i}),this},i.prototype.resetExpandedLevel=function(e){return t.utils.forEach(e===this.root?this.model.getNodeMap():this.getAllChildren(e).concat(e),function(t){t._expandedLevel=0,t._rendered=!1,t._xPathMap=null}),this.isVisible(e)?this.setExpandedLevel(e,0,this.getNodeLevel(e)):e===this.root&&(e._expandedLevel=0),this},i.prototype.getNodeElement=function(t,e,i){var s,n=".ut-tree-node:first ";if(t===this.root?s=this.find(".ut-tree-tree"):t instanceof $&&t.length?s=t:t?(t=void 0!=t.id?t.id:t,s=e instanceof $&&e.data("id")==t?e:this.find(".ut-tree-root[data-id='"+t+"']:first",e)):s=$(),i&&s.length)switch(i){case"parent":s=s.parents(".ut-tree-root:first");break;case"children":s=s.children(".ut-tree-nodes");break;case"node":s=s.children(n);break;case"title":s=s.find(n+".ut-tree-ttl");break;case"name":s=s.find(n+".ut-tree-name");break;case"check":s=s.find(n+".ut-tree-chk");break;case"icon":s=s.find(n+".ut-tree-ico");break;case"switch":s=s.find(n+".ut-tree-swc");break;case"indent":s=s.find(n+".ut-tree-indent");break;case"parents":s=s.parents(".ut-tree-root")}return s},i.prototype.getChildrenElement=function(t,e){return this.getNodeElement(t,e,"children")},i.prototype.setNodeProps=function(e,i,s){if((e=this.getNode(e))&&t.isObject(i)){var n,o,r=!1;t.utils.forEach(t.utils.copy(i),function(i,a){if(!t.isEqual(e[a],i)&&!t.utils.some(this.emitHelper("onBeforeChange",e,a,i,e[a]),!1)){if("id"==a){if(this.getNode(i))return void t.print("Node id already exists.["+i+"]");t.utils.each(this.getChildren(e,!0),function(t){t.pid=i},this),t.utils.treeWalker([e],function(t){t._xPath=null,t._xPathMap=null},!1,"children",this),o=e.id,t.utils.each(this._checked,function(t){if(t.id==o)return t.id=i,!1}),this.getNodeElement(e).attr("data-id",i).data("id",i),(n=this.model.getNodeMap())[i]=e,delete n[o]}else if("name"==a)!s&&this.getNodeElement(e,null,"name").html(i);else{if("checked"==a)return void(!s&&this.check(e,!!i,null,!0,!1,!1));if(/isLeaf|roots|leaves|children/.test(a))return void t.print("Can not set the property by this method. ["+a+"]");r=/disabled|icon|hidden/.test(a)}this.emit("onChange",e,a,e[a]=i)}},this),r&&!s&&this.replaceNodeElement(this.makeNode("expand",{node:e}),this.getNodeElement(e))}return this},i.prototype.scrollIntoView=function(t,e,i){var s,n,o,r,a,l,d,h,u,c,p,f,m,g,v,y,b,x,w,C,_,k,S,T,E,L,I,M=this,N=60,R=this.options.animationSpeed,D=!1,F=!1,P=this.getNodeElement(t);if(P.length&&P.is(":visible")&&(a=this.getRootElement()).length&&a.is(":visible")){if(o=a.get(0),o.scrollHeight>o.clientHeight&&(h=a.offset(),l=$(window),d=$(document),F=h.top,c=a.height(),m=l.height(),_=d.scrollTop(),(y=F+c-_)>N&&(g=F-m-_)<-N&&(w=Math.min(y,-g),s=w===-g?F:_,E=s+.168*w,n=s+w,k=n-.168*w,u=P.offset(),F=u.top,F=F<s?E:F>n&&k,F!==!1&&(F=u.top-F+a.scrollTop()))),o.scrollWidth>o.clientWidth&&(h=h||a.offset(),l=l||$(window),d=d||$(document),D=h.left,p=a.width(),f=l.width(),C=d.scrollLeft(),(v=D+p-C)>N&&(b=D-f-C)<-N&&(x=Math.min(v,-b),L=x===-b?D:C,S=L+.2*x,I=L+x,T=S,u=this.getNodeElement(P,null,"name").offset(),D=u.left,D=D<L?S:D>I&&T,D!==!1&&(D=u.left-D+a.scrollLeft()))),D!==!1||F!==!1){if($.easing.easeInOutQuint||($.easing.easeInOutQuint=function(t,e,i,s,n){return(e/=n/2)<1?s/2*e*e*e*e*e:s/2*((e-=2)*e*e*e*e+2)}),!e&&(void 0==R||R))return r={},D!==!1&&(r.scrollLeft=D),F!==!1&&(r.scrollTop=F),a.animate(r,900,"easeInOutQuint",function(){M.toggleClass(t,null,"select",!0),i&&i.call(M,t)}),this;D!==!1&&a.scrollLeft(D),F!==!1&&a.scrollTop(F)}this.toggleClass(t,null,"select",!0),i&&i.call(this,t)}return this},i.prototype.expand=function(e,i,s,n,o){var r,a,l=this.options,d=this.root,h=l.asyncCheckAssociation;if(1===arguments.length&&e!==d&&t.isObject(e)&&!this.isExist(e)&&(a=e,e=a.nodes||a.node,i=a.ajaxSetup||a.level,s=a.callback,n=a.silence,o=a.scroll),!t.isArray(e)&&e!==d&&!(e=this.getNode(e)))return s&&s.call(this),this;if(l.async){if(t.isArray(e))return s&&s.call(this),this;if(!this.isLeaf(e)&&!this.isFetched(e))return(void 0==h||h)&&(r=this.isChecked(e)),this.fetchChild(e,i,function(t,e){e&&(r&&this.toggleCheck(t,!0,null,!0,null,!1,!1,!1),this.setXPathMap(t,t.children).expand(t,1,s,n,o))})}var u,c,p,f,m=1e6;if(i===!0?i=m:t.isInt(i)?i=Math.max(+i,0):(void 0==i||(i=parseInt(i+"")||1)<1||i>m)&&(i=1),e===d)this.resetExpandedLevel(e).repaint({expandLevel:i},!0).emit("onExpand",e),s&&s.call(this,e);else if(t.isArray(e)&&e.length)for(u=[],t.utils.forEach(this.mergeXPaths(e,!0),function(t){for(var e=0,i=t.length;e<i;e++)u.push(t[e].pop())},this),c=u.length,p=0,f=function(){--p||c||s&&s.call(this)};u.length;)p++,c--,this.toggleExpand(u.shift(),i,null,!0,f,!1);else this.toggleExpand(e,i,null,n,function(){!(void 0!=o?o:l.autoScroll)&&this.toggleClass(e,null,"select",!0),s&&s.call(this,e)},o);return this},i.prototype.collapse=function(e,i,s,n,o){return t.isArray(e)?(e=e.slice()).length?this.collapse(e.pop(),i,t.bind(this.collapse,this,e,i,s),!0,!1):s&&s.call(this):e===this.root?(this.resetExpandedLevel(e).repaint({expandLevel:0},!0).emit("onCollapse",e),s&&s.call(this,e)):this.isLeaf(e)?s&&s.call(this,e):this.toggleExpand(e,!1,null,n,function(t){i&&this.resetExpandedLevel(t).getChildrenElement(t).remove(),(void 0!=o?o:this.options.autoScroll)||this.toggleClass(t,null,"select",!0),s&&s.call(this,t)},o),this},i.prototype.setSearchAgent=function(e,i){i=t.isObject(i)?i:{delay:i};var s=t.utils.throttle(function(t,e){t!==e&&(i.keyword=t,this.search(i))},t.isInt(i.delay)?Math.max(i.delay,30):300,this);return e&&(e instanceof $||t.isElement(e)||t.isString(e))?t.utils.catchInputChangeEvent(e,s):e instanceof t.Component?e.on("onChange",s):t.print("The agent is invalid.","error"),this},i.prototype.search=function(e){e=t.isObject(e)||t.isEmpty(e=t.utils.trim(e))?t.utils.object(e,!0):{keyword:e,pattern:e,queryName:arguments[1]};var i,s,n,o=this.options,r=t.utils.trim(e.keyword),a=t.isRegExp(e.pattern)?e.pattern:null,l=/^\s*(root|leaf)\s*$/i.test(e.nodeType)?RegExp.$1:"all",d=t.utils.trim(e.highlight),h=e.asyncCheckAssociation,u={};if(t.isEmpty(r)&&(r=null),a||null!==r){if(i=t.utils.trim(e.queryName)||"name",(e.url=t.utils.trim(e.url))&&null!==r&&(u[i]=r,a=null,s=e.remote=!0),a=t.utils.makeRegExp(a||r,"i"),a.toString()===(this._filtered||"").toString()||t.utils.some(this.emitHelper("onBeforeSearch",e),!1))return this;n=function(r,l){r&&(s?(o.async&&!/tree/i.test(o.dataType)&&(l=t.utils.listToTree(l,{childField:"children",parentField:"parent",rootPidVal:o.rootPid})),this.setChildren(this.root,l||[],!0)):this._xPathMap=this.mergeXPaths(l||[]),this.expand(this.root,!0),this._filtered=a,"name"!==i||void 0!=d&&!d||(this._highlighting=t.isString(d)?d:"ut-highlight",t.utils.highlight(this.getRootElement().get(0),a,"span",this._highlighting))),this.emit("onAfterSearch",e,r),n=null},s?((void 0==h||h)&&(o.checked=this.getAsyncCheckedNodes(!0)),this._strictCheck=!!o.strictCheck,o.strictCheck=!0,this._tree=t.utils.extend({},this._tree),this._nodeMap=this._nodeMap||t.utils.extend({},this.model.getNodeMap()),this._modelOptions=this._modelOptions||t.utils.copy(this.model.getOptions()),this.model.drop(),this.once("onAfterUpdate",n).reloadTree(t.utils.deepExtend(e,{preserveData:!0,ajaxSetup:{data:u}})).emit("onSearch",e)):n.call(this,!0,t.utils.filter(this.model.getNodeMap(),function(t){return!t._removed&&("all"===l||(this.isLeaf(t)?"leaf"===l:"root"===l))&&a.test(t[i])},this))}else this._filtered&&(this._xPathMap=this._filtered=null,this.root=this._tree,this._nodeMap&&(this.model.setNodeMap(this._nodeMap).setAjaxOptions(this._modelOptions),this._nodeMap=this._modelOptions=null,o.strictCheck=this._strictCheck),this.collapse(this.root)._highlighting=!1);return this},i.prototype.fetchChild=function(e,i,s){if(!(e=this.getNode(e)))return this;var n,o={};return i=t.utils.deepExtend(t.utils.object(this.options.async,!0),i),o[i.queryName||"id"]=e.id,t.utils.extend(o,i.params),this.toggleClass(e,null,"loading","fetch",!0).once("onAfterUpdate",function(o,r){var a=this.options;this.toggleClass(e,null,"loading","fetch",!1),o&&(e._fetched=!0,i.clearChild&&(n=(e.children||[]).slice(),this.removeNodes(e.children,!0).model.removeNodes(n)),this._async=!0,a.async&&!/tree/.test(a.dataType)&&(r=t.utils.filter(t.utils.listToTree(r,{childField:"children",parentField:"parent",rootPidVal:e.id}),function(t){return t.pid==e.id})),this.appendChild(e,r,!1)),s&&s.call(this,e,o)}).reloadTree(t.utils.deepExtend(i,{preserveData:!0,ajaxSetup:{data:o}}))},i.prototype.appendChild=function(e,i,s){if(void 0===s&&(s=!0),void 0==i||!(e=this.getNode(e))||t.utils.some(this.emitHelper("onBeforeAppend",e,i),!1))return this;t.isArray(i)||(i=[i]);var n,o=this.options,r=this.model,a=this.root,l=e,d=[],h=this.getChildren(e,1),u=this.getParents(e).concat(e),c=[],p=[],f=null;if(this._async?(this._async=!1,c=i):(t.utils.each(i,function(e){(n=r.getNode(e))?t.utils.some(u,n)?t.print("Failed to execute 'appendChild' on 'Node "+n.name+"'.\n The new child node contains the parent.","error"):t.utils.some(h,n)||p.push(n):(e=r.makeNode(e))&&c.push(e)},this),p.length&&(this.removeNodes(p),t.utils.each(p,function(t){t._removed&&c.push(t)}))),!c.length)return this;for(;c.length;)e=c.shift(),e._removed=!1,t.utils.intersection(this.getParents(e),c,!0)||(t.utils.treeWalker(e,function(i,s){i._checked=0,i.checked=!1,i.parents=i._xPath=i._xPathMap=i._isLeaf=i._expanded=i._expandedLevel=i._level=i._rendered=i._removed=i._sorted=i._linking=void 0,i.parent=s,i!==e&&t.utils.remove(c,i),d.push(i),this.emit("onAppend",i)},!1,"children",this,l!==a?l:null),h.push(e));return this.setChildren(l,h,!0).resetExpandedLevel(l),s?this.setXPathMap(l,d).expand(l,+(l!==a),null,!0,void 0==o.autoScroll||!!o.autoScroll):this.repaintDynamicLines(l),l!==a&&this.freshAncestorCheckState(l,!0).getNodeElement(f||l,null,"node").removeClass("ut-tree-leaf"),this.emit("onAfterAppend",l,d)},i.prototype.toNodes=function(e){var i=[];if(void 0==e)return i;t.isArray(e)||(e=[e]);for(var s,n=0,o=e.length;n<o;n++)(s=this.getNode(e[n]))&&i.push(s);return i},i.prototype.toKeys=function(e){return t.utils.map(this.toNodes(e),function(t){return t.id})},i.prototype.show=function(i){return arguments.length&&i!==this.root?t.utils.each(t.isArray(i)?i:[i],function(t){(t=this.getNode(t))&&(t.hidden=!1,this.getNodeElement(t).removeClass("ut-hidden"))},this):e.prototype.show.call(this),this},i.prototype.hide=function(i){return arguments.length&&i!==this.root?t.utils.each(t.isArray(i)?i:[i],function(t){(t=this.getNode(t))&&(t.hidden=!0,this.getNodeElement(t).addClass("ut-hidden"))},this):e.prototype.hide.call(this),this},i.prototype.isHidden=function(t){return arguments.length&&t!==this.root?!!(t=this.getNode(t))&&(!!this.getNodeElement(t,null,"node").parents(".ut-node-root.ut-hidden").length||!this.isVisible(t)):e.prototype.isHidden.call(this)},i.prototype.edit=function(t){return(t=this.getNode(t))&&this.isEditable(t)&&(this._editing!==t&&(this._editing&&this.toggleClass(this._editing,null,"edit",!1),this.toggleClass(t,null,"edit",!0)),this._selected=t),this},i.prototype.removeNodes=function(e,i){if(void 0==e)return this;if(t.isArray(e)||(e=[e]),!(e=this.toNodes(e)).length)return this;var s,n,o,r,a={},l=this.root,d=[],h=this.options.lines;for(r=0;r<e.length;r++)t.utils.intersection(this.getParents(e[r]),e,!0)&&e.splice(r--,1);return t.utils.each(e,function(e){e===l||t.utils.some(this.emitHelper("onBeforeRemove",e),!1)||(s=this.getParent(e)||l,(a[s.id]=a[s.id]||[]).push(e),o=this.getChildren(s,1),s._flag||(s._flag=1,s._children=o.slice()),t.utils.remove(o,e),e.parent=null,t.utils.treeWalker(e,function(t){t.parents=null,t._xPath=null,t._removed=!0,t._rendered=!1,t._expandedLevel=0,t._level=0,d.push(t),this.emit("onRemove",t)},!1,"children",this))},this),(o=a[l.id])&&o.length===l._children.length?(l._flag=0,this.getNodeElement(l).empty()):(n=t.utils.keys(a),t.utils.forEach(a,function(e,i){o=(s=this.getNode(i)||l)===l?this.getNodeElement(l):this.getChildrenElement(s),o.length&&(s&&e.length===s._children.length?o.remove():(t.utils.each(e,function(t){this.getNodeElement(t,o).remove()},this),h&&!t.utils.intersection(this.getParents(s,!0),n,!0)&&this.repaintNodeLines(s||this.root))),s._flag=0,s!==l&&this.freshAncestorCheckState(s,!0),this.setChildren(s,s.children,!0)},this)),i&&this.model.removeNodes(d),this.makeStripes().emit("onAfterRemove",d)},i.prototype.getNodeLevel=function(t){var e=-1;return(t=this.getNode(t))&&t!==this.root&&(e=void 0!=t._level?t._level:t._level=this.getParents(t).length),e},i.prototype.isLast=function(t){return!!(t=this.getNode(t))&&(t._sorted?!t.nextSibling:t===this.getChildren(t.parent||this.root).pop())},i.prototype.isFirst=function(t){return!!(t=this.getNode(t))&&(t._sorted?!t.prevSibling:t===this.getChildren(t.parent||this.root,1)[0])},i.prototype.isXPathLast=function(t){var e=this._xPathMap;if(e&&t.id in e){for(;t=t.nextSibling;)if(t.id in e)return!1;return!0}return!1},i.prototype.isXPathFirst=function(t){var e=this._xPathMap;if(e&&t.id in e){for(;t=t.prevSibling;)if(t.id in e)return!1;return!0}return!1},i.prototype.isExist=function(t){return!!this.getNode(t)},i.prototype.isChecked=function(t){return!!(t=this.getNode(t))&&!!t.checked},i.prototype.isIndeterminateCheck=function(t){return!!(t=this.getNode(t))&&2===t._checked},i.prototype.isSelected=function(t){return this.getNodeElement(t,null,"node").hasClass("ut-selected")},i.prototype.isLeaf=function(e){if(!(e=this.getNode(e)))return!1;if(void 0!==e._isLeaf)return!!e._isLeaf;var i=!1;return e.isLeaf?i=!0:void 0==e.isLeaf&&(t.isArray(e.children)?/tree/i.test(this.options.dataType)||e.children.length||(i=!0):i=!0),e._isLeaf=i},i.prototype.isExpanded=function(t){return!!(t=this.getNode(t))&&(t._expanded=this.getNodeElement(t).hasClass("ut-expanded"))},i.prototype.isFetched=function(t){var i=e.prototype.isFetched.call(this);return i&&this.options.async&&(t=this.getNode(t))&&(i=t._fetched||t.children&&t.children.length),!!i},i.prototype.isFiltered=function(){return!!this._filtered},i.prototype.reset=function(){return this.isFiltered()?this.search(""):this.collapse(this.root,!0),this},i.prototype.isVisible=function(t){var e=!1;return t!==this.root&&(t=this.getNode(t))&&(e=this.getParents(t).length===this.getNodeElement(t).parents(".ut-expanded").length),e},i.prototype.isEditable=function(t){if((t=this.getNode(t))&&!t.disabled&&t.editable!==!1){var e=this.options.editable,i=this.isLeaf(t);return!(!e||"root"===e&&i||"leaf"===e&&!i)}return!1},i.prototype.isDescendantOf=function(e,i){return!(e!==this.root&&!(e=this.getNode(e))||!(i=this.getNode(i)))&&t.utils.some(this.getAllChildren(e),i)},i.prototype.isRoot=function(t){return t===this.root||this.isExist(t)&&!this.getParent(t)},i.prototype.getNode=function(t){return t instanceof $&&(t=t.data("id")),t=t===this.root?t:this.model.getNode(t),t&&t._removed?null:t},i.tplTree='<div class="ut-box ut-tree ut-txt-select-none" style="{{style}}">  <div class="ut-wrap">  {{include tplRoot node, expandLevel}}  </div> </div>',i.tplRoot='<ul class="ut-tree-tree {{ | getTreeClass }}">  {{exec sortNodes : node}}  {{each node.children as child index nodes}}  {{include tplNode 0 as level, (index>=node.roots.length) as isLeaf, child as node, nodes.length as length, index,  expandLevel}}  {{/each}} </ul>',i.tplNode='{{if lines}} {{exec setLastArray: node,index,length,level}} {{/if}} <li data-id="{{node.id}}"  class="ut-tree-root {{node | getStateClass : index,length,level,expandLevel,isLeaf,expanded}}">  <div title="{{node.name | customFilters : node, 0 }}" class="ut-tree-node {{node | getNodeClass : isLeaf}}">  {{include tplIndent node, level}}  <span class="ut-tree-swc"></span>  <span class="ut-tree-ttl">  {{if (radio || checkbox) && leftSideCheck}}  <span class="ut-tree-chk {{ | customFilters : node, 2 }}"></span>  {{/if}}  {{if useImageIcon}}  <img class="ut-tree-img {{ | customFilters : node, 3, isLeaf }}" src="{{node._icon}}">  {{else}}  <span class="ut-tree-ico {{ | customFilters : node, 3, isLeaf }}"></span>  {{/if}}  {{if (radio || checkbox) && !leftSideCheck}}  <span class="ut-tree-chk {{ | customFilters : node, 2 }}"></span>  {{/if}}  <span class="ut-tree-name">{{ #node.name | customFilters : node, 1 }}</span>  </span>  </div>  {{if level < expandLevel}}  <ul class="ut-tree-nodes">  {{exec sortNodes : node}}  {{each node.children as child index nodes}}  {{include tplNode (level+1) as level, (index>=node.roots.length) as isLeaf, child as node, nodes.length as  length, index , expandLevel}}  {{/each}}  </ul>  {{/if}} </li>',i.tplIndent='{{for level }} <span class="ut-tree-indent {{$index | getIndentClass}}"></span> {{/for}}',i.filters={customFilters:function(e,i,s,n){var o=this.options,r=o.icons,a=" ut-icon-none ";if(3===s&&(r===!1||(r&&r[n?"leaf":"root"])===!1))return a;var l,d,h=o.filters,u=["title","name","check","icon"],c=2===s&&i.disabled?" ut-disabled ":"";return"function"==typeof h&&(h={name:h}),h&&(l=h[u[s]])&&(d=l.call(this,e,i))||(3===s&&(d===!1?e=a:(r=t.utils.extend({},o.icons,{root:i.icon,leaf:i.icon}),(e=n?r.leaf:r.root)===!1?e=a:r.useImage&&(e=(i._icon=t.utils.trim(e))?"":a))),d=e||""),d+c},getIndentClass:function(t){return this._isLast&&this._isLast[t]?"ut-line-none":""},getTreeClass:function(){var t=this.options;return(t.radio?"ut-tree-radio ":"")+(t.icons===!1?"ut-icon-none ":"")+(t.collapseButton===!1?"ut-swc-none ":"")+(t.indents===!1?"ut-indent-none ":"")+(t.classicStyle?"ut-tree-classic ":t.lines?"ut-tree-line ":t.dynamicLines?"ut-dynamic-line ":"")+this.root.id},getStateClass:function(t,e,i,s,n,o,r){return this.setExpandedLevel(t,n,s),(r!==!1&&!o&&s<n?"ut-expanded ":"")+((this._xPathMap?this.isXPathLast(t):e===i-1)?"ut-last":"")+(t.disabled?" ut-disabled":"")+(t.hidden?" ut-hidden":"")},getNodeClass:function(t,e){return this.setNodeCheckState(t,this.getCheckState(t,e),null,e)+(e?" ut-tree-leaf":"")},setLastArray:function(t,e,i,s){var n=this._isLast||[];n[s]=+(this._xPathMap?this.isXPathLast(t):e===i-1),this._isLast=n},sortNodes:function(t){this.setChildren(t)}},i.events={"'click dblclick contextmenu' .ut-tree":function(e){var i=$(e.target),s=i.parents(".ut-tree-root:first"),n=s.children(".ut-tree-node"),o=n.find(".ut-tree-name").get(0),r=n.find(".ut-tree-ttl").get(0),a=n.find(".ut-tree-swc").get(0),l=this.getNode(s.data("id")),d=e.type,h=this.options,u=!!h.multiple,c=void 0;if(this._editing){if(this._editing===l&&(o===i.get(0)||$.contains(o,i.get(0))))return;this.toggleClass(this._editing,null,"edit",!1)}if(h.classicStyle&&!i.is(a)&&r&&!$.contains(r,i.get(0))&&(l=null),"contextmenu"===d)return!t.utils.some(this.emitHelper("onContextMenu",l,{x:e.clientX,y:e.clientY}),!1);if(l){if(!l.disabled&&i.is(".ut-tree-chk"))this.toggleCheck(l,c,s,c,function(t){this.repaintDynamicLines(t)},!1);else{if("dblclick"===d||i.is(a)){if("dblclick"===d){if(t.utils.some(this.emitHelper("onDblClick",l),!1))return;if(this.isEditable(l)&&(i=i.get(0),o===i||$.contains(o,i)))return void this.toggleClass(l,s,"edit",!0)}return void this[this.isExpanded(l)?"collapse":"expand"](l,c,function(t){this.repaintDynamicLines(t)},c,!1)}l.disabled||(u&&(e.shiftKey||void 0!=h.ctrlForMultiple&&!h.ctrlForMultiple||e.ctrlKey||e.metaKey)?(t.utils.clearSelection(),this.toggleClass(l,n,"select",!1,e.shiftKey?"shift":"ctrl")):this.toggleClass(l,n,"select",!0),h.checkOnSelect&&this.toggleCheck(l,c,s,c,function(t){this.repaintDynamicLines(t)},!1))}this.emit("onClick",l)}this.getRootElement().addClass("ut-focus")},"click document":function(t){t.srcComponent===this||this._selected||(this.getRootElement().removeClass("ut-focus"),this._editing&&this.toggleClass(this._editing,null,"edit",!1)),this._selected=!1}},i}(t.Component);t.Tree=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments),this.selectCount=0,this.maxCount=0}return __extends(i,e),i.prototype.init=function(t){t.dataKey="id",this.options=t,this.dataType=t.dataType?t.dataType:"list",t.onClick&&this.on("onClick",t.onClick),t.onOverstep&&this.on("onOverstep",t.onOverstep)},i.prototype.initState=function(e,i){return{list:e,isOtherList:i.isOtherList,otherList:[],type:i.dataType||"list",max:i.max?0:parseInt(i.max),style:t.utils.getStyle({width:i.width,height:i.height})}},i.prototype.ready=function(e){var i=e.treeOptions,s={};this._tree=new t.Tree(t.utils.extend(s,e,i,{el:this.find(".ut-tree-box"),width:"100%",height:"100%",checkOnSelect:!0,preventSelection:!0,id:t.utils.uuid(10)}))},i.prototype.getSelectedItems=function(e,i){var s,n=this.model;return s=e?this.find(".ut-select-list-lt .ut-selected"):this.find(".ut-select-list-rt li"),t.utils.map(s.get(),function(t){var e=$(t).data("id")+"";return i?e:n.select("id",e)[0]})},i.prototype.getClickItem=function(t){var e;return this.model.forEach(function(i){if(i.id==t)return e=i}),e},i.prototype._getSelectedElemItems=function(e,i){var s=this.find(e)||$(e),n=this.model;return t.utils.map(s.get(),function(t){var e=$(t).data("id")+"";return i?e:n.select("id",e)[0]})},i.prototype.changeData=function(e,i,s,n){var o=this._getSelectedElemItems(e,s),r=this.getState("list"),a=this.getState("otherList");"left"===i?t.utils.remove(r,function(e){if(t.utils.some(o,e.id))return a.unshift(e),!0}):t.utils.remove(a,function(e){if(t.utils.some(o,e.id))return r.unshift(e),!0});var l=[],d=[];this.model.forEach(function(e){t.utils.some(r,function(t){return t.id===e.id})&&l.push(e)}),this.model.forEach(function(e){t.utils.some(a,function(t){return t.id===e.id})&&d.push(e)}),n&&(r=l,a=d),this.setState({list:r,otherList:a})},i.prototype.leftToRight=function(){this.lefttoright()},i.prototype.lefttoright=function(){if("tree"==this.dataType){var e,i=this,s=this.selectedNodes=this.selectedNodes||[];t.utils.each(e=this._tree.getCheckedNodes(),function(e){if(i.selectCount++,t.utils.some(s,e))i.selectCount--;else{if(0!=i.options.max&&i.selectCount>i.options.max)return i.emit("onOverstep",i.options.max),i.selectCount--,!1;s.push(e)}}),this._tree.hide(s).check(e,!1),this.options.isOtherList&&this.setState("otherList",this.selectedNodes)}else"list"==this.dataType&&this.changeData(".ut-select-list-lt .ut-selected","left",!0)},i.prototype.leftAllToRight=function(){this._tree.check(this._tree.root),this.lefttoright()},i.prototype.rightToLeft=function(){if("tree"==this.dataType){for(var e,i=this.find(".ut-select-list-rt .ut-selected"),s=(this.find(".ut-select-list-rt"),[]),n=this.getState("otherList"),o=0;o<i.length;o++)e=this._tree.getNode(i.eq(o).data("id")),null!=e&&(this._tree.show(e),t.utils.remove(n,function(t){return t.id==e.id}),s.push(i.eq(o).data("id")),t.utils.remove(this.selectedNodes,e)),this.selectCount>0&&this.selectCount--;this.setState("otherList",n),this._tree&&this._tree.check(s,!1)}else this.changeData(".ut-select-list-rt .ut-selected","right",!0)},i.prototype.rightAllToLeft=function(){if("tree"==this.dataType){var t,e=this.find(".ut-select-list-rt .ut-list-item");if(0==e.length)return;this.selectedNodes=this._tree.model.data,this._tree&&this._tree.check(this.selectedNodes,!1);for(var i=0;i<e.length;i++)t=this._tree.getNode(e.eq(i).data("id")),null!=t&&(this._tree.show(t),e.eq(i).remove(),this.selectedNodes=[]);this.selectCount=0,this.setState("otherList",[])}else this.changeData(".ut-select-list-rt li","right",!0,!0)},i.prototype.setRight=function(t){if("tree"==this.dataType){var e;if("object"==typeof t)for(var i=0;i<t.length;i++){e="object"==typeof t[i]&&null!=t[i].id&&""!=t[i].id?this._tree.getNode(t[i].id):this._tree.getNode(t[i]);var s=this.setRightFun(e);if(!s)break}else"string"!=typeof t&&"number"!=typeof t||(e=this._tree.getNode(t),this.setRightFun(e))}},i.prototype.setRightFun=function(e){if(null==e)return!0;this.selectCount++,this._tree.hide(e);var i=this.selectedNodes=this.selectedNodes||[];if(t.utils.some(i,e))this.selectCount--;else{if(0!=this.options.max&&this.selectCount>this.options.max)return this.emit("onOverstep",this.options.max),this.selectCount--,!1;i.push(e)}return this._tree.check(this.selectedNodes,!1),this.options.isOtherList&&this.setState("otherList",this.selectedNodes),!0},i.template=["<div style='{{style}}' class='ut-wrap ut-select-list'>","   {{include tplSelectLeft list}}","   {{if isOtherList}}","       {{include tplBtn}}","       {{include tplSelectRight}}","   {{/if}}","</div>"],i.tplSelectLeft=["<div class='ut-float-lt ut-select-list-lt'>","   {{if type == 'tree'}}","       <div class='ut-tree-box'></div>","   {{/if}}","   {{if type == 'list'}}","       <ul class='ut-list-wrap'>","           {{for item in list}}","               <li class='ut-list-item' data-id='{{item.id}}'>{{item.name}}</li>","           {{/for}}","       </ul>","   {{/if}}","</div>"],i.tplSelectRight=["<div class='ut-float-rt ut-select-list-rt'>","   <ul class='ut-list-wrap'>","       {{for item in otherList}}","           <li class='ut-list-item' data-id='{{item.id}}'>{{item.name}}</li>","       {{/for}}","    </ul>","</div>"],i.tplBtn=['<div class="ut-btn">','   <input type="button" class="ltr-btn" value=">">','   <input type="button" class="ltr-all-btn" value=">>">','   <input type="button" class="rtl-btn" value="<">','   <input type="button" class="rtl-all-btn" value="<<">',"</div>"],i.filters={setClass:function(t){return t?"ut-selected":""}},i.events={"click li.ut-list-item":function(t){var e=$(t.currentTarget);e.toggleClass("ut-selected");var i=e.data("id");"list"==this.dataType&&this.emit("onClick",this.getClickItem(i))},"click .ltr-btn":function(){this.leftToRight()},"click .rtl-btn":function(){this.rightToLeft()},"click .ltr-all-btn":function(){this.leftAllToRight()},"click .rtl-all-btn":function(){this.rightAllToLeft()},"dblclick .ut-select-list-lt":function(t){"tree"!=this.dataTye&&this.changeData(t.target,"left",!0)},"dblclick .ut-select-list-rt":function(e){if(this.dataType="tree"){var i=$(e.target).data("id"),s=this._tree.getNode(i);null!=s&&(this._tree.show(s),$(e.target).remove(),t.utils.remove(this.selectedNodes,s),this.selectCount>0&&this.selectCount--);var n=this.getState("otherList");t.utils.remove(n,function(t){if(t.id==i)return!0}),this.setState("otherList",n)}else this.changeData(e.target,"right",!0)}},i}(t.Component);t.SelectList=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments),this.getMinWidth=this.getWidthByValue(this.options.min),this.getMaxWidth=this.getWidthByValue(this.options.max)}return __extends(i,e),i.prototype.init=function(e){this.options=t.utils.extend({range:"0-10",step:1,max:isNaN(e.range.split("-")[1])?10:e.range.split("-")[1],min:isNaN(e.range.split("-")[0])?0:e.range.split("-")[0],start:isNaN(e.range.split("-")[0])?0:e.range.split("-")[0],end:isNaN(e.range.split("-")[1])?10:e.range.split("-")[1],value:0},e),t.isFunction(e.SilderBoxChange)&&this.on("SilderBoxChange",e.SilderBoxChange),this.silderBoxitem=this.options},i.prototype.setPageOffset=function(t){var e=t,i=parseInt($(".ut-silderbox-strip").css("width")),s=$(".ut-silderbox-select");e<0&&(e=0),e>i?(e=i,s.css({"border-top-right-radius":"15px"}),s.css({"border-bottom-right-radius":"15px"})):(s.css({"border-top-right-radius":"0"}),s.css({"border-bottom-right-radius":"0"})),$(".ut-silderbox-slug").css({left:e}),s.css({width:e})},i.prototype.setSilderBoxValue=function(t){this.setPageOffset(this.judgeWidth(this.getWidthByValue(t)))},i.prototype.getWidthByValue=function(t){var e=this.options.end>this.options.max?this.options.max:this.options.end,i=this.options.start>this.options.min?this.options.start:this.options.min,s=t>e?e:t;s=t<i?i:s;var n=0,o=0;if(0==this.options.step){var r=1e-5;o=this.getWidth/((1e4*this.options.end-1e4*this.options.start)/(1e4*r)),n=(1e4*s-1e4*this.options.start)/(1e4*r)}else{o=this.getWidth/((1e4*this.options.end-1e4*this.options.start)/1e4/this.options.step),n=Math.floor((1e4*s-1e4*this.options.start)/1e4/this.options.step);var a=1e4*s/(1e4*this.options.step)/1e4*o-n*o;a>=o/2&&(n+=1)}return n*o},i.prototype.judgeWidth=function(t){var e=t;return t>this.getMaxWidth?e=this.getMaxWidth:t<this.getMinWidth&&(e=this.getMinWidth),e},i.prototype.ready=function(e){function i(t){if(s.find(".ut-silderbox").width(s.getWidth+20),s.find(".ut-silderbox-container").width(s.getWidth+8),null!=t.height&&""!=t.height){s.find(".ut-silderbox-strip").css("height",t.height),s.find(".ut-silderbox-select").css("height",t.height);var e=parseInt(t.height);s.find(".ut-silderbox").height(e+17),s.find(".ut-silderbox-slug").height(e+16),s.find(".ut-silderbox-container").height(e+16)}null!=t.color&&""!=t.color&&(s.find(".ut-silderbox-select").css("background-color",t.color),s.find(".ut-silderbox-select").css("border-color",t.color),s.find(".ut-silderbox-slug").css("background-color",t.color),s.find(".ut-silderbox-slug").css("border-color",t.color),s.find(".ut-silderbox-strip").css("border-color",t.color)),null!=t.borderColor&&""!=t.borderColor&&s.find(".ut-silderbox-strip").css("border-color",t.borderColor),null!=t.slugColor&&""!=t.slugColor&&s.find(".ut-silderbox-slug").css("background-color",t.slugColor)}null!=e.width&&""!=e.width&&(this.find(".ut-silderbox-strip").css("width",e.width),this.find(".ut-silderbox").css("width",e.width)),this.getWidth=parseInt($(".ut-silderbox-strip").css("width"));var s=this;i(e);var n=!1;e.end,e.step,e.max,e.min;this.silderBoxValue=e.value,this.setSilderBoxValue(this.silderBoxValue),$(".ut-silderbox-slug").click(function(){}).mousedown(function(){n=!0});var o=$(".ut-silderbox-strip").offset().left;$(document).mousemove(function(t){if(1==n)if(e.step>0){var i=s.judgeWidth(t.pageX-o),r=s.getWidth/((s.options.end-s.options.start)/s.options.step),a=Math.floor(i/r),l=i-a*r;l>=r/2&&(a+=1),s.silderBoxValue=(a*(1e4*s.options.step)+1e4*s.options.start)/1e4,s.silderBoxitem.value=s.silderBoxValue;var d=a*r;s.setPageOffset(s.judgeWidth(d))}else s.setPageOffset(s.judgeWidth(t.pageX-o))}).mouseup(function(i){n&&(0==s.options.step&&(s.silderBoxValue=(s.judgeWidth(i.pageX-o)/s.getWidth*(1e4*s.options.end-1e4*s.options.start)+1e4*s.options.start)/1e4,s.silderBoxValue>s.silderBoxitem.max?s.silderBoxValue=s.silderBoxitem.max:s.silderBoxValue<s.silderBoxitem.min&&(s.silderBoxValue=s.silderBoxitem.min),s.silderBoxitem.value=s.silderBoxValue),t.isFunction(e.SilderBoxChange)&&s.emit("SilderBoxChange",s.silderBoxitem)),n=!1}),this.bind("click",".ut-silderbox-strip",function(t){if(0!=e.step){var i=s.judgeWidth(t.pageX-o),n=this.getWidth/((this.options.end-this.options.start)/this.options.step),r=Math.floor(i/n),a=i-r*n;
a>=n/2&&(r+=1),this.silderBoxValue=(r*(1e4*s.options.step)+1e4*s.options.start)/1e4,s.silderBoxitem.value=this.silderBoxValue,s.setPageOffset(s.judgeWidth(r*n))}else this.silderBoxValue=(s.judgeWidth(t.pageX-o)/s.getWidth*(1e4*s.options.end-1e4*s.options.start)+1e4*s.options.start)/1e4,s.silderBoxitem.value=this.silderBoxValue,s.silderBoxValue>s.silderBoxitem.max?s.silderBoxValue=s.silderBoxitem.max:s.silderBoxValue<s.silderBoxitem.min&&(s.silderBoxValue=s.silderBoxitem.min),s.setPageOffset(s.judgeWidth(t.pageX-o));s.emit("SilderBoxChange",s.silderBoxitem)})},i.template=["<div class='ut-silderbox'><div class='ut-silderbox-container'><div class='ut-silderbox-strip'><div class='ut-silderbox-select'></div></div><div class='ut-silderbox-slug'></div></div></div>"],i}(t.Component);t.SliderBox=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e){this.isLoaded=!1,this.options=e=t.utils.extend({selectStyle:{width:"100%",height:300}},e),this._url=e.url,this._data=e.data,this.type=e.type,e.onClick&&this.on("onClick",e.onClick),e.onRemove&&this.on("onRemove",e.onRemove),e.onAfterShowList&&this.on("onAfterShowList",e.onAfterShowList),e.userDataKey=e.dataKey||"id",e.dataKey="___id",(e.placeholder=t.utils.trim(e.placeholder))&&("placeholder"in document.createElement("input")||(e.mockPlaceholder=!0))},i.prototype.initState=function(e,i){return{list:e,otherList:[],uuid:t.utils.uuid(8),type:i.type,text:"",icons:i.icons||"",style:t.utils.getStyle({width:i.width,height:i.height}),width:i.width,selectStyle:t.utils.getStyle({zIndex:i.selectStyle.zIndex,width:i.selectStyle.width,height:i.selectStyle.height}),placeholder:i.placeholder,mockPlaceholder:i.mockPlaceholder}},i.prototype.ready=function(e){var i=this;if(this.find(".ut-input").css("width","99%"),e.mockPlaceholder){var s=function(){this[""===this.find(".ut-smart-select-input").val()?"show":"hide"](".ut-placeholder")};this.on("onChange",s).bind("blur",".ut-smart-select-input",s)}if(this.listenTo("value",function(t,e){this.emit("onChange",this.value=t,e)}),this.listenTo("otherList",function(t,i){""!=t?e.mockPlaceholder?this.hide(".ut-placeholder"):this.find(".ut-smart-select-input").removeAttr("placeholder",""):e.mockPlaceholder?this.show(".ut-placeholder"):this.find(".ut-smart-select-input").attr("placeholder",e.placeholder)}),"tree"==this.type){var n=e.treeOptions;this._tree=new t.Tree(t.utils.extend({},e,n,{el:this.find(".ut-tree-box"),width:"100%",height:"100%",checkOnSelect:!0,preventSelection:!0,multiple:!1,id:t.utils.uuid(10)})).setSearchAgent(this.find("input")).on("onCheck",function(){i.selectedNodes=i._tree.getCheckedNodes(),i.setState("otherList",i.selectedNodes),i._adjustWidth(),i.setCss(),i._tree.search(""),i._tree.setSearchAgent(i.find("input"))}).on("onClick",t.bind(this.emit,this,"onClick"))}else this.bind("keyup","input",function(e){var i=$(e.currentTarget).val();if(t.isEmpty(i)){var s=(this.model.data||[]).slice(),n=this.getState("otherList")||[];t.utils.remove(s,function(e){if(t.utils.some(n,function(t){return t.___id===e.___id}))return!0}),this.setState({list:s})}else{var o=[],s=(this.model.data||[]).slice(),n=this.getState("otherList")||[];t.utils.remove(s,function(e){if(t.utils.some(n,function(t){return t.___id===e.___id}))return!0}),t.isEmpty(this.url)?(o=t.utils.filter(s,function(t){return t.name.indexOf(i)!==-1}),o.length||o.push({name:"未找到",id:""}),this.setState({list:o})):this.reload({url:this.url,preserveData:!1})}}),this.bind("keydown","input",function(e){if("none"!=this.find(".ut-smart-select-tips").get(0).style.display){var i=this.find("li"),s=this.find(".ut-hover");switch(e.keyCode){case 40:if(s.get(0)){var n=i.index(s),o=i.length;n==o-1?(s.removeClass("ut-hover"),i.eq(0).addClass("ut-hover")):s.removeClass("ut-hover").next("li").addClass("ut-hover")}else i.eq(0).addClass("ut-hover");break;case 38:if(s.get(0)){var n=i.index(s);0==n?(s.removeClass("ut-hover"),i.eq(-1).addClass("ut-hover")):s.removeClass("ut-hover").prev("li").addClass("ut-hover")}else i.eq(-1).addClass("ut-hover");break;case 13:var r,a=$(".ut-hover").attr("data-id");r=t.utils.filter(this.model.data,t.bind(function(t){return t.id==a},this))[0];var l=!0;this.changeData(r.___id,l),this.find(".ut-smart-select-tips").hide();break;case 8:var a,r,i=this.find(".ut-select").eq(-1);a=i.length>0?$(i).attr("data-id"):null,r=t.utils.filter(this.model.data,t.bind(function(t){return t.id==a},this))[0];var l=!1;"tree"==this.type?(this._tree&&this._tree.check(a,l),this.selectedNodes=this._tree.getCheckedNodes(),this._tree.getNodeElement(a,null,"node").removeClass("ut-selected ut-checked"),this.setState("otherList",this.selectedNodes),this._tree.setSearchAgent(this.find("input")),this.setCss()):this.changeData(r.___id,l),this.emit("onRemove",this.getClickItem(a))}return!1}})},i.prototype.changeData=function(e,i){var s=this.getState("list"),n=this.getState("otherList"),o=[e];i?t.utils.remove(s,function(e){if(t.utils.some(o,e.___id))return n.push(e),!0}):t.utils.remove(n,function(e){if(t.utils.some(o,e.___id))return s.push(e),!0}),this._data=s;var r=[];this.model.forEach(function(e){t.utils.some(s,function(t){return t.___id===e.___id})&&r.push(e)}),this.setState({list:r,otherList:n}),this.setState("text",t.utils.map(n,function(t){return t.text}).join(",")),this.find(".input-show").val(""),this._adjustWidth(),this.setCss()},i.prototype.setCss=function(){var e,i,s,n=this.find(".edit-box"),o=n.width(),r=this.find(".ut-input"),a=this.find(".ut-select").eq(-1);0!=a.length?(e=a&&a.position().left,i=a.width()+Math.ceil(parseFloat(a.css("marginLeft"))||0)):(e=0,i=0),!a||o-e-i-35<=20?s=o-10:(s=o-e-i-35,s=t.isIE?s-23:s),r.css({width:s});var l=this.getState("otherList");""!=l?this.options.mockPlaceholder?this.hide(".ut-placeholder"):this.find(".ut-smart-select-input").removeAttr("placeholder",""):this.options.mockPlaceholder?this.show(".ut-placeholder"):this.find(".ut-smart-select-input").attr("placeholder",this.options.placeholder),this.showPopup(this.tplSelectList)},i.prototype.getSelectedItems=function(t){var e;if("tree"==this.type)return this.selectedNodes=this._tree.getCheckedNodes(t);var i=[],s=this.getState("otherList");if(t){for(var n=0;n<s.length;n++)i.push(s[n][this.options.userDataKey]);e=i}else e=s;return e},i.prototype.setSelectedValue=function(e){var i=[];if(t.isArray(e)||(e=[e]),t.utils.each(e,t.bind(function(e){var s=t.utils.filter("tree"==this.type?this._tree.model.nodeMap:this.model.data,t.bind(function(t){return t[this.options.userDataKey]==e},this));i=i.concat(s)},this)),"tree"==this.type)this._tree.check(i),this.selectedNodes=this._tree.getCheckedNodes(),this.setState("otherList",this.selectedNodes),this._tree.setSearchAgent(this.find("input"));else{var s=this.getState("otherList"),n=this.getState("list");t.utils.forEach(i,t.bind(function(e){t.utils.remove(n,function(i){if(t.utils.some([e.___id],function(t){return t==i.___id}))return s.push(i),!0})},this)),this.setState({list:n,otherList:s})}this.setCss(),this.hide(this.tplSelectList)},i.prototype.clearSelection=function(){var t=[];if("tree"==this.type)this._tree.reload(t),this.selectedNodes=this._tree.getCheckedNodes(),this.setState("otherList",this.selectedNodes),this._tree.setSearchAgent(this.find("input"));else{var e=[],i=this.getState("list");this.setState({list:i,otherList:e})}this.setCss(),this.hide(this.tplSelectList)},i.prototype.getClickItem=function(t){var e;return this.model.forEach(function(i){if(i.___id==t)return e=i}),e},i.prototype.hideSelectList=function(){return this.hide(this.tplSelectList),this},i.prototype.removeAll=function(){for(var e=this.getSelectedItems(!0),i=0;i<e.length;i++){var s,n=e[i];s=t.utils.filter(this.model.data,t.bind(function(t){return t.id==n},this))[0];var o=!1;"tree"==this.type?(this._tree&&this._tree.check(n,o),this.selectedNodes=this._tree.getCheckedNodes(),this._tree.getNodeElement(n,null,"node").removeClass("ut-selected ut-checked"),this.setState("otherList",this.selectedNodes),this._tree.setSearchAgent(this.find("input")),this.setCss()):this.changeData(s.___id,o)}return!1},i.prototype._adjustWidth=function(){var e,i,s,n=this.find(".edit-box"),o=n.width(),r=this.find(".ut-select");t.utils.each(r.toArray(),t.bind(function(n){e=$(n).outerWidth(!0),i=$(n).position().left,s=Math.ceil(parseFloat($(n).css("marginLeft"))||0),o<e+58&&$(n).css({"max-width":t.isIE?o-73-i-s:o-58-i-s})},this))},i.initRenderDelay=50,i.template=["<div class='ut-smart-select' style='{{style}}'>","   <div class='edit-box'>","       {{include tplSelectedList}}","   </div>","   {{include tplSelectList}}","</div>"],i.tplSelectList=["   <div data-pseudo='popup' class='ut-smart-select-tips ut-shadow ut-hidden' style='{{selectStyle}}'>","       {{include tplList}}","   </div>"],i.tplList=["{{if type=='tree'}}","   <div class='ut-tree-box'></div>","{{/if}}","{{if type != 'tree'}}","   <ul class='tips-list'>","       {{for item in list}}","           <li data-id='{{item.id}}'>","               {{#icons | setIcon}}","               <span>{{item.name}}</span><em></em>","           </li>","       {{/for}}","   </ul>","{{/if}}"],i.tplSelectedList=["<div class='select-box'>","   {{for item in otherList}}","       <div class='ut-select item' data-id='{{item.id}}'>","           <span>{{item.text || item.name}}</span><em></em>","       </div>","   {{/for}}","   <div class='item ut-input'>","{{if mockPlaceholder}}","        <label class='ut-placeholder'>{{placeholder}}</label>","{{/if}}","       <input type='text' placeholder='{{placeholder}}' class='ut-smart-select-input'>","   </div>","</div>"],i.filters={setIcon:function(t){return t?"<img src='"+t+"'>":""}},i.events={"click input":function(e){if(e.preventDefault(),e.stopPropagation(),"tree"!=this.type){for(var i=(this.model.data||[]).slice(),s=this.getState("otherList")||[],n=[],o=0;o<s.length;o++)n.push(s[o].id);t.utils.remove(i,function(e){if(t.utils.some(n,e.id))return!0}),this.setState({list:i}),this.find("li").length>0&&this.showPopup(this.tplSelectList)}else this.showPopup(this.tplSelectList),this.emit("onAfterShowList")},"click document":function(){this.hide(this.tplSelectList)},"click ::popup .tips-list li":function(e){var i=$(e.currentTarget);if("未找到"!=i.find("span").text()){var s,n=i.attr("data-id");s=t.utils.filter(this.model.data,t.bind(function(t){return t.id==n},this))[0];var o=!0;this.changeData(s.___id,o),this.hide(this.tplSelectList),this.emit("onClick",this.getClickItem(n))}},"click .ut-select em":function(e){e.preventDefault();var i,s=$(e.currentTarget).parent().attr("data-id");i=t.utils.filter(this.model.data,t.bind(function(t){return t.id==s},this))[0];var n=!1;return"tree"==this.type?(this._tree&&this._tree.check(s,n),this.selectedNodes=this._tree.getCheckedNodes(),this._tree.getNodeElement(s,null,"node").removeClass("ut-selected ut-checked"),this.setState("otherList",this.selectedNodes),this._tree.setSearchAgent(this.find("input")),this.setCss()):this.changeData(i.___id,n),this.emit("onRemove",this.getClickItem(s)),!1},"click .ut-smart-select":function(t){return t.preventDefault(),t.stopPropagation(),!1},"click ::popup .ut-smart-select-tips":function(t){return t.preventDefault(),t.stopPropagation(),!1},"click .ut-select":function(t){$(t.currentTarget).toggleClass("cur")}},i}(t.TextBox);t.SmartSelect=e}(utry||(utry={}));var utry;!function(t){var e=function(e){function s(){e.apply(this,arguments),this.count=0}return __extends(s,e),s.prototype.init=function(e){e.el.parent();this.uuid=e._tableID=this._getId(6),this.hStyleId=this._getId(),this.wStyleId=this._getId(),this.headClass=this._getId(12),this.bodyClass=this._getId(12),this.headTable=this._getId(12),this.bodyTable=this._getId(12),e.dataKey="id",this.toolbar=new t.Toolbar(t.utils.extend(e.toolbar,{border:"bottom"}));for(var i,s,n,o="click dblClick contextMenu".split(" "),r="on";o.length;)i=t.utils.capitalize(o.pop()),(n=e[s=r+i])&&this.on(s,n);e.rowHeight=parseInt(e.rowHeight),this.options=e=t.utils.extend({border:!0},e),e.isTree?this.initTreeOptions(e):this.initOptions(e),t.isEmpty(t.utils.trim(e.url))||(e.data=null)},s.prototype.initOptions=function(e){e.pagination&&(this.pagination=new t.Pagination(t.utils.extend({async:!!t.utils.trim(e.url)},e.pagination,{border:"top"})).on("onChange",t.bind(this.reload,this))),this.options=e=t.utils.extend({checkbox:!0,multiple:!0,fields:[{field:"id",type:"string"}],sortType:"local"},e);var s;e.pagination&&(s=this.pagination).remote&&t.utils.trim(e.url)&&(this.options.ajaxSetup=e.ajaxSetup=t.utils.deepExtend({data:s.getPagingState(!0)},e.ajaxSetup)),this.dataMap={},this.setModel(new i)},s.prototype.initTreeOptions=function(e){this.options=e=t.utils.extend({checkbox:!1,multiple:!1,showCheckTrBg:!0,isCascade:!1,expand:!1,expandLevel:Math.max(parseInt(e.expandLevel)||0,0),fields:[{field:"id",type:"string"},{field:"pid",type:"string"},{field:"ico",type:"string"}]},e),this.setModel(new t.TreeModel({dataType:e.dataType,rootPid:e.rootPid})),this.root={id:t.utils.uuid(10),pid:t.utils.uuid(10),name:"/",children:[],ico:null}},s.prototype.afterFetch=function(e,i){t.isObject(e)?(this.count=e.count,this.model.setData(t.utils.filter(t.isArray(e=e.data)?e:[],function(e){return t.isObject(e)}),!0)):(e=this.model.data=t.isArray(e)?t.utils.filter(e,function(e){return t.isObject(e)}):[],this.count=e.length),this.pagination&&this.pagination.setRecordCount(this.count),i.isTree||t.utils.each(this.model.data,t.bind(function(e){t.isObject(e)&&(this.dataMap[e.id]=e)},this))},s.prototype.initState=function(e,i){r=t.utils.getStyle({width:i.width,height:i.height||"auto"});var s=this.model,n={},o=[];if(t.utils.forEach(i.headers,t.bind(function(e){e.clsClass=t.utils.uuid(12).toLowerCase(),o.push(e)},this)),i.isTree)n={uuid:i._tableID,borderClass:i.border,headClass:this.headClass,bodyClass:this.bodyClass,headTable:this.headTable,bodyTable:this.bodyTable,isTree:i.isTree,expand:i.expand,expandLevel:i.expandLevel,style:r,rows:e,toolbar:i.toolbar,columns:o,showRowIndex:i.showRowIndex,checkbox:i.checkbox,multiple:i.multiple,uncheckedCount:s.size()-s.select("checked",!0).length};else{var r;n={uuid:i._tableID,borderClass:i.border,headClass:this.headClass,bodyClass:this.bodyClass,headTable:this.headTable,bodyTable:this.bodyTable,isTree:i.isTree,style:r,rows:e,toolbar:i.toolbar,columns:o,showRowIndex:i.showRowIndex,checkbox:i.checkbox,radio:i.radio,multiple:i.multiple,pagination:i.pagination,uncheckedCount:s.size()-s.select("checked",!0).length}}return n},s.prototype.afterRender=function(e){this.setChildComponents(new t.Application({context:this.getRootElement()}).getComponents());var i=this.find(".ut-table-sort[data-field='"+this.sortField+"']"),s=this.sortBy;i.data("sort",s),"desc"==s?i.removeClass("ut-table-sort-pre").addClass("ut-table-sort-next"):"asc"==s&&i.removeClass("ut-table-sort-next").addClass("ut-table-sort-pre"),!e.isTree&&e.checkbox&&e.multiple&&(this.find("thead :checkbox").get(0).checked=!this.find("tbody :checkbox:not(:checked)").length),this._interlacedColor();var n=[];e.isTree?t.utils.forEach(this.model.nodeMap,function(t){t.selected&&n.push(t.id)}):t.utils.forEach(this.dataMap,function(t){t.selected&&n.push(t.id)}),this.setSelected(n.join(",")),this._adjustTable()},s.prototype.ready=function(e){this.isFetched()?e.afterLoad&&e.afterLoad(this.model.data):this.once("onAfterFetch",t.bind(function(){e.afterLoad&&e.afterLoad(this.model.data)},this)),/%/.test(e.height)&&this.bind("resize","window",t.utils.throttle(function(){this._adjustTable()},100,this)),this.on("onComponentRemount",function(){t.utils.each(this.childComponents,function(e,i){e instanceof t.Component&&!e.destroyed&&(e.destroy(),this.childComponents[i]=null,t.utils.remove(this._childComponents,e))},this),t.utils.remove(this.childComponents,null)})},s.prototype.getSelectData=function(){var e=this.options,i=[];if(e.isTree)if(e.multiple){var s=this.find(".checked_tr");t.utils.forEach(s.toArray(),t.bind(function(t,e){var s=$(t),n=s.data("id");i.push(this.getNode(n))},this))}else{var s=this.find(".checked_tr"),n=s.data("id")||null;i.push(this.getNode(n))}else i=t.utils.filter(this.dataMap,function(t){return 1==t.checked});return i},s.prototype.setSelected=function(e){if(t.isEmpty(e))return!1;var i=this.options,s=e.split(",");i.isTree?i.checkbox?t.utils.forEach(s,t.bind(function(t){this._toggleCheck(t,"selected")},this)):t.utils.forEach(s,t.bind(function(t){this._toggleBgClass(t,"selected")},this)):t.utils.forEach(s,t.bind(function(e){var s=this.find("tr[data-id='"+e+"']");if(i.checkbox||i.radio){var n=s.find("input:checkbox")[0]||s.find("input:radio")[0];n.checked=!0,i.checkbox&&i.multiple&&(this.find("thead :checkbox").get(0).checked=!this.find("tbody :checkbox:not(:checked)").length)}t.utils.forEach(this.dataMap,t.bind(function(t,s){t.id==e?t.checked=!0:i.multiple||(t.checked=!1),this.dataMap[s]=t},this)),i.showCheckTrBg?(i.multiple||s.siblings("tbody>tr").removeClass("checked_tr"),s.addClass("checked_tr")):s.removeClass("checked_tr")},this))},s.prototype.unselected=function(e){var i=this.options,s=e.split(",");i.isTree?i.checkbox?t.utils.forEach(s,t.bind(function(t){this._toggleCheck(t,"unselected")},this)):t.utils.forEach(s,t.bind(function(t){this._toggleBgClass(t,"unselected")},this)):t.utils.forEach(s,t.bind(function(e){var s=this.find("tr[data-id='"+e+"']");if(i.checkbox||i.radio){var n=s.find("input:checkbox")[0]||s.find("input:radio")[0];n.checked=!1,i.checkbox&&i.multiple&&(this.find("thead :checkbox").get(0).checked=!this.find("tbody :checkbox:not(:checked)").length)}t.utils.forEach(this.dataMap,t.bind(function(t,i){t.id==e&&(t.checked=!1),this.dataMap[i]=t},this)),s.removeClass("checked_tr")},this))},s.prototype.getNode=function(t){return t instanceof $&&(t=t.data("id")),t=t===this.root?t:this.model.getNode(t),t?t:null},s.prototype.refreshNode=function(t){return this.model.changed(),this},s.prototype.getTableNode=function(t){return t instanceof $&&(t=t.data("id")),void 0!=t?this.dataMap[void 0!=t.id?t.id:t]||null:null},s.prototype.reload=function(i){return this.options=i=t.utils.extend(this.options,i),this.model.drop(),e.prototype.reload.call(this,i),this},s.prototype._getId=function(e){return t.utils.uuid(e||10).toLowerCase()},s.prototype._adjustTable=function(){return $(document.getElementById(this.wStyleId)).remove(),$(document.getElementById("row"+this.hStyleId)).remove(),$(document.getElementById(this.hStyleId)).remove(),this._makeStyle(this._adjustWidth(),this.wStyleId)._makeStyle(this._adjustRowHeight(),"row"+this.hStyleId)._makeStyle(this._adjustHeight(),this.hStyleId)},s.prototype._adjustWidth=function(){var t=this.find(".ut-table-header-rule").children(".ut-col"),e=this.find(".ut-table-body-rule").children(".ut-col"),i=[];return t.each(function(t,s){s=$(s),i.push({className:s.data("id"),width:Math.max(s.outerWidth(),e.eq(t).outerWidth())+"px"})}),i.push({className:"ut-table-rule th,.ut-table-rule td",padding:"0",margin:"0"}),i},s.prototype._adjustHeight=function(){var t=this.options,e=this.getRootElement(),i=e.children(".ut-table-head"),s=e.children(".ut-table-foot"),n=e.find("."+this.headTable),o=e.height()-i.outerHeight()-s.outerHeight(),r=[];return r.push({className:t._tableID+">.ut-table-main",height:o+"px"}),r.push({className:this.headClass,height:n.outerHeight()+"px"}),r.push({className:this.bodyClass,height:o-n.outerHeight()+"px"}),r},s.prototype._adjustRowHeight=function(){var e=this.options.rowHeight,i=[];return t.utils.each([this.headTable,this.bodyTable],t.bind(function(t){this.find("."+t).children().children().each(function(t,s){t&&(--t,s=$(s),i.push({className:s.data("rowid"),height:Math.max(s.outerHeight(),e)+"px"}))})},this)),i},s.prototype._makeStyle=function(t,e){var i,s,n,o=["<style type='text/css' id='"+e+"'>"],r="!important;";for(n=0;n<t.length;n++){o.push("."+(i=t[n]).className+"{");for(s in i)"className"!==s&&o.push(s+":"+i[s]+r);o.push("}")}return this.wStyleId===e&&o.push("."+this.headTable+",."+this.bodyTable+"{width:100%!important;table-layout:fixed!important;}"),o.push("</style>"),this.find("."+this.uuid).append($(o.join(""))),this},s.prototype._findParentNodes=function(e){var i,s=this.options;i=this._getNodeElement(e);var n=i.data("pid");if(n){var o=this.find("tr.ut-table-tree-node[data-id='"+n+"']"),r=o.data("id"),a=this.find("tr.ut-table-tree-node[data-pid='"+r+"']"),l=a.length,d=0;t.utils.forEach(a.toArray(),t.bind(function(t,e){var s=$(t);i.data("id")!=s.data("id")&&(s.hasClass("checked_tr")?d++:null)},this)),s.checkbox?+l&&1==l?i.hasClass("ut-checked")?o.removeClass("ut-checked-some").addClass("ut-checked checked_tr"):o.removeClass("ut-checked-some ut-checked checked_tr"):+l&&+d&&d+1==l?i.hasClass("ut-checked")?o.removeClass("ut-checked-some").addClass("ut-checked checked_tr"):o.removeClass("ut-checked checked_tr").addClass("ut-checked-some"):d?o.removeClass("ut-checked").addClass("ut-checked-some"):i.hasClass("ut-checked")?o.removeClass("ut-checked checked_tr").addClass("ut-checked-some"):i.hasClass("ut-checked-some")?o.removeClass("ut-checked checked_tr").addClass("ut-checked-some"):o.removeClass("ut-checked-some ut-checked checked_tr"):+l&&1==l?i.hasClass("checked_tr")?o.addClass("checked_tr"):o.removeClass("checked_tr"):+l&&+d&&d+1==l&&i.hasClass("checked_tr")?o.addClass("checked_tr"):o.removeClass("checked_tr"),this._findParentNodes(r)}},s.prototype._findChildNodes=function(e){var i,s=this.options;i=this._getNodeElement(e);var e=i.data("id"),n=i.nextAll("tr.ut-table-tree-node[data-pid='"+e+"']");t.utils.forEach(n.toArray(),t.bind(function(t,e){var n=$(t),o=n.data("id");i.hasClass("checked_tr")?n.addClass("checked_tr"):n.removeClass("checked_tr"),s.checkbox&&(i.hasClass("ut-checked")?n.removeClass("ut-checked-some").addClass("ut-checked"):n.removeClass("ut-checked ut-checked-some")),this._findChildNodes(o)},this))},s.prototype._getNodeElement=function(t,e){var i;if(t===this.root)return this;if(t instanceof $&&t.length)i=t;else{if(!t)return $();t=void 0!=t.id?t.id:t,i=e instanceof $&&e.data("id")===t?e:this.find(".ut-table-tree-node[data-id='"+t+"']:first",e)}return i},s.prototype._toggleCheck=function(t,e){var i,s=this.options;i=this._getNodeElement(t),s.multiple&&(s.isCascade?("selected"==e?i.removeClass("ut-checked-some").addClass("ut-checked checked_tr"):"unselected"==e?i.removeClass("ut-checked-some ut-checked checked_tr"):i.hasClass("ut-checked")?i.removeClass("ut-checked-some ut-checked checked_tr"):i.removeClass("ut-checked-some").addClass("ut-checked checked_tr"),this._findParentNodes(t),this._findChildNodes(t)):"selected"==e?i.addClass("ut-checked checked_tr"):"unselected"==e?i.removeClass("ut-checked checked_tr"):i.hasClass("ut-checked")?i.removeClass("ut-checked checked_tr"):i.addClass("ut-checked checked_tr"))},s.prototype._toggleExpand=function(e){var i;i=this._getNodeElement(e),i.hasClass("ut-expanded")?i.removeClass("ut-expanded"):i.addClass("ut-expanded");var s=i.data("id"),n=this.find("tr.ut-table-tree-node[data-pid='"+s+"']");t.utils.forEach(n.toArray(),t.bind(function(t){var e=$(t),s=e.data("id");e.removeClass("ut-expanded"),i.hasClass("ut-expanded")?this.show(e):this.hide(e),this._expandChild(s)},this)),this._adjustTable()},s.prototype._expandChild=function(e){var i;i=this._getNodeElement(e),i.removeClass("ut-expanded");var s=i.data("id"),n=this.find("tr.ut-table-tree-node[data-pid='"+s+"']");t.utils.forEach(n.toArray(),t.bind(function(t){var e=$(t),i=e.data("id");this.hide(e),e.removeClass("ut-expanded"),this._expandChild(i)},this))},s.prototype._toggleBgClass=function(t,e){var i,s=this.options;i=this._getNodeElement(t),s.multiple||s.checkbox?s.isCascade?("selected"==e?i.removeClass("ut-checked-some").addClass("checked_tr ut-checked"):"unselected"==e?i.removeClass("ut-checked-some checked_tr ut-checked"):i.hasClass("checked_tr")?i.removeClass("ut-checked-some checked_tr ut-checked"):i.removeClass("ut-checked-some").addClass("checked_tr ut-checked"),this._findParentNodes(t),this._findChildNodes(t)):"selected"==e?i.addClass("checked_tr ut-checked"):"unselected"==e?i.removeClass("checked_tr ut-checked"):i.hasClass("checked_tr")?i.removeClass("checked_tr ut-checked"):i.addClass("checked_tr ut-checked"):(i.siblings().removeClass("checked_tr"),"selected"==e?i.addClass("checked_tr"):"unselected"==e?i.removeClass("checked_tr"):i.hasClass("checked_tr")?i.removeClass("checked_tr"):i.addClass("checked_tr"))},s.prototype._interlacedColor=function(){var e=this.find(".ut-table-tree-node:not(.ut-hidden)");t.utils.forEach(e.toArray(),t.bind(function(t,e){var i=$(t);i.removeClass("ut-table-tr-even ut-table-tr-odd").addClass(e%2===0?"ut-table-tr-even":"ut-table-tr-odd")},this))},s.template='<div class="ut-table-box {{uuid}} {{borderClass | setBorder}}"  style="{{style}}">  {{if toolbar}}  <div class="ut-table-head">  {{include toolbar}}  </div>  {{/if}}  <div class="ut-table-main">  <div class="ut-table-title {{headClass}}">  <table class="ut-table {{headTable}}" cellspacing="0" cellpadding="0">  {{include tplHead}}  </table>  </div>  <div class="ut-table-body {{bodyClass}} {{isTree | getNowrapClass}}">  <table class="ut-table {{bodyTable}}" cellspacing="0" cellpadding="0">  {{include tplBody}}  </table>  </div>  </div>  {{if pagination}}  <div class="ut-table-foot">  {{include pagination}}  </div>  {{/if}} </div>',s.tplHead='<thead> <tr class="ut-table-rule ut-table-header-rule">  {{if showRowIndex}}  <th data-id="ut-table-rule-seq" class="ut-table-rule-seq ut-col"></th>  {{/if}}  {{if checkbox && multiple && !isTree}}  <th data-id="ut-table-rule-check" class="ut-table-rule-check ut-col"></th>  {{else if radio && !multiple && !isTree}}  <th data-id="ut-table-rule-check" class="ut-table-rule-check ut-col"></th>  {{/if}}  {{for col in columns,index}}  <th data-id="{{col.clsClass}}" width="{{col.width}}" class="{{col.clsClass}} ut-col"></th>  {{/for}}  <th class="ut-table-rule-th"></th> </tr> <tr data-rowid="r{{bodyTable}}" class="r{{bodyTable}}">  {{if showRowIndex}}  <th>  <div class="ut-table-cell-seq">&nbsp;</div>  </th>  {{/if}}  {{if checkbox && multiple && !isTree}}  <th>  <div class="ut-table-cell-check"><input type="checkbox" {{uncheckedCount?\'\':\'checked\'}}/></div>  </th>  {{else if radio && !multiple && !isTree}}  <th>  <div class="ut-table-cell-check">&nbsp;</div>  </th>  {{/if}}  {{for col in columns}}  <th>  <div class="ut-table-cell">  <span>{{col.title}}</span>  {{if col.sort && !isTree}}  <span data-sort="{{col.sort}}" data-field="{{col.field}}" class="ut-table-sort"></span>  {{/if}}  </div>  </th>  {{/for}}  <th class="ut-table-rule-th"></th> </tr> </thead>',s.tplBody='<tbody> <tr class="ut-table-rule ut-table-body-rule">  {{if showRowIndex}}  <td data-id="ut-table-rule-seq" class="ut-table-rule-seq ut-col"></td>  {{/if}}  {{if checkbox && multiple && !isTree}}  <td data-id="ut-table-rule-check" class="ut-table-rule-check ut-col"></td>  {{else if radio && !multiple && !isTree}}  <td data-id="ut-table-rule-check" class="ut-table-rule-check ut-col"></td>  {{/if}}  {{for col in columns,index}}  <td data-id="{{col.clsClass}}" class="{{col.clsClass}} ut-col" width="{{col.width}}"></td>  {{/for}}  <td class="ut-table-rule-td"></td> </tr> {{for row in rows index}} {{include tplRow row,index,0 as level,expandLevel }} {{/for}} </tbody>',s.tplRow='<tr data-id="{{row.id}}" data-pid="{{row.pid}}" data-level="{{level}}" data-rowid="r{{row.id+index}}"  class="r{{row.id+index}} ut-table-tree-node {{expand | setHiddenClass :level,expandLevel}} {{row | getExpandClass :level,expand,expandLevel}} {{row | setLeafClass}}">  {{if showRowIndex}}  <td>  <div class="ut-table-cell-seq">{{index + 1}}</div>  </td>  {{/if}}  {{if checkbox && multiple && !isTree}}  <td>  <div class="ut-table-cell-check"><input type="checkbox" {{row.checked?\'checked\':\'\'}}/></div>  </td>  {{else if radio && !multiple && !isTree}}  <td>  <div class="ut-table-cell-check"><input type="radio" name="{{uuid}}-radio" {{row.checked?"checked":""}}/></div>  </td>  {{/if}}  {{for col in columns,colindex}}  {{if !isTree}}  <td>  <div class="ut-table-cell">{{#col | getColValue: row}}</div>  </td>  {{else}}  <td>  <div class="ut-table-cell">  {{if colindex<1}}  {{for level }}  <span class="ut-table-tree-indent" data-level="{{level}}"></span>  {{/for}}  <span class="ut-table-tree-swc"></span>  {{if multiple && checkbox}}  <span class="ut-table-tree-chk"></span>  {{/if}}  {{if row.ico}}  <img src="{{row.ico}}" width="18px" height="18px"/>  {{else}}  <span class="ut-table-tree-ico"></span>  {{/if}}  {{/if}}  <span>{{#col | getColValue: row}}</span>  </div>  </td>  {{/if}}  {{/for}}  <td class="ut-table-rule-td"></td> </tr> {{each row.children as child,index}} {{include tplRow child as row,index,(level+1) as level,expandLevel}} {{/each}}',s.tplPage='<div class="ut-tfoot">  {{include pagination}} </div>',s.initRenderDelay=50,s.filters={toLowerCase:function(t){return String(t).toLowerCase()},setHiddenClass:function(t,e,i){return t?i&&e>i?"ut-hidden":"":e?"ut-hidden":""},setLeafClass:function(t){var e=this.options;return e.isTree&&!t.children?"ut-table-tree-leaf":e.isTree&&!t.children.length?"ut-table-tree-leaf":""},getExpandClass:function(t,e,i,s){var n=this.options;if(n.isTree&&t.children&&t.children.length&&i)return s&&e>=s?"":"ut-expanded"},getColValue:function(e,i){return t.isFunction(e.render)?e.render(i[e.field],i):i[e.field]},setBorder:function(t){return t?"":"no-border"},getNowrapClass:function(t){return t?"ut-nowrap":""}},s.events={"click thead .ut-table-sort":function(t){var e=$(t.currentTarget),i=e.data("field"),s=e.data("sort");s=s&&"desc"==s?"asc":"desc",e.data("sort",s),"desc"==s?e.removeClass("ut-table-sort-pre").addClass("ut-table-sort-next"):"asc"==s&&e.removeClass("ut-table-sort-next").addClass("ut-table-sort-pre"),this.sortField=i,this.sortBy=s.toLowerCase(),this.model.sortBy(this.options,this.pagination,i,s)},"click thead input:checkbox":function(e){var i=this.options,s=e.currentTarget.checked;this.dataMap=t.utils.map(this.dataMap,function(t){return t.checked=!!s,t}),this.find("tbody input:checkbox").each(function(t,e){var n=$(e);e.checked=s,i.showCheckTrBg&&s?n.parents("tr").addClass("checked_tr"):n.parents("tr").removeClass("checked_tr")})},"'click dblclick contextmenu' .ut-table-body":function(e){var i=$(e.target),s=$(e.currentTarget),n=e.type,o=this.options,r=o.isTree,a=i.parents("tr:first"),l=a.find(".ut-table-cell"),d=a.data("id"),h=r?this.getNode(d):this.getTableNode(d);if(i.get(0)!=s.get(0)){if("contextmenu"===n)return!t.utils.some(this.emitHelper("onContextMenu",h,i.offset().left,i.offset().top),!1);if(r){var u=l.find(".ut-table-tree-swc").get(0);if(h){if(i.is(".ut-table-tree-chk"))this._toggleCheck(h);else{if("dblclick"===n||i.is(u)){if("dblclick"===n&&t.utils.some(this.emitHelper("onDblClick",h),!1))return;return void(a.hasClass("ut-table-tree-leaf")||(this._toggleExpand(h),this._interlacedColor()))}o.multiple?this._toggleBgClass(h):this._toggleBgClass(h)}this.emit("onClick",h)}}else if("dblclick"===n)this.emit("onDblClick",h);else{var c;o.checkbox||o.radio?(c=a.find("input:checkbox")[0]||a.find("input:radio")[0]||i.get(0),c.checked=i.get(0)===c?!!c.checked:!c.checked,o.checkbox&&o.multiple&&(this.find("thead :checkbox").get(0).checked=!this.find("tbody :checkbox:not(:checked)").length)):(c=i.get(0),c.checked=!a.hasClass("checked_tr")),t.utils.forEach(this.dataMap,t.bind(function(t,e){t.id==d?t.checked=c.checked:o.multiple||(t.checked=!1),this.dataMap[e]=t},this)),this.emit("onClick",h),o.showCheckTrBg&&c.checked?(o.multiple||a.siblings("tbody>tr").removeClass("checked_tr"),a.addClass("checked_tr")):a.removeClass("checked_tr")}}},"scroll .ut-table-body":function(t){var e=-t.currentTarget.scrollLeft;this._tableScrollLeft!==e&&(this.find("."+this.headTable)[0].style.left=(this._tableScrollLeft=e)+"px")}},s}(t.Component);t.Table=e;var i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.sortBy=function(e,i,s,n){var o={};"remote"==e.sortType.toLowerCase()?(o[e.sortBy]=n,
o[e.sortField]=s,i.remote&&t.utils.trim(e.url)&&(e.ajaxSetup=t.utils.deepExtend(e.ajaxSetup,t.utils.deepExtend(e.ajaxSetup,{data:i.getPagingState(!0)}),{data:o})),this.reload({url:e.url,ajaxSetup:e.ajaxSetup})):this.sort(s,n)},i.prototype.drop=function(){return this.data=[],this},i}(t.Store)}(utry||(utry={}));var utry;!function(t){var e=function(){function e(i){i=this.options=t.utils.extend({},e.DEFAULTS,i),i=this.options=t.utils.extend(i,{zIndex:parseInt(i.zIndex,10)||2013,handle:$(t.isObject(i.handle)?i.handle[0]:i.handle),element:$(t.isObject(i.element)?i.element[0]:i.element),axis:i.axis&&/\s*(x|y)?\s*\,?\s*(x|y)?\s*$/i.exec(i.axis.toString())?[RegExp.$1,RegExp.$2===RegExp.$1?"":RegExp.$2].join(""):null,grid:i.grid&&/\s*(-?\d+\.?\d+|-?\d)\s*(px|%|em)?\s*\,\s*(-?\d+\.?\d+|-?\d)\s*(px|%|em)?\s*$/i.exec(i.grid.toString())?[RegExp.$1+RegExp.$2,RegExp.$3+RegExp.$4]:null});var s=i.element.addClass("ui-draggable-element");if(t.isObject(s)){var n=this,o=document;i=this.options=t.utils.extend({uuid:t.utils.uuid(12),win:$(window),doc:$(o),mask:$("<div/>").css({top:0,left:0,width:1,height:1,opacity:.01,display:"none",position:"absolute",cursor:i.cursor||"move",zIndex:i.zIndex+1}).appendTo(o.body),helper:$("<div/>").css({display:"none",position:"absolute",cursor:i.cursor,zIndex:i.zIndex+99999997,backgroundColor:i.backgroundColor,opacity:i.ghost?parseFloat(i.opacity)||.4:.001}).addClass(i.helperCls||"ui-draggable-helper").appendTo(o.body)},i),t.isObject(i.handle)?i.trigger=i.handle.addClass("ui-draggable-handle").bind("mousedown",i.dragHandle=function(e){return e.button===(t.isIE8?1:0)?n.startDrag(e,i.element):void 0}):i.trigger=i.element.addClass("ui-draggable-handle").bind("mousedown",i.dragHandle=function(e){return e.button===(t.isIE8?1:0)?n.startDrag(e,this):void 0})}(i.oncreate||function(){}).call(this)}return e.prototype.startDrag=function(e,i){var s=this.options;if(!s.disabled&&1!==s.dragState){for(var n,o=this,s=this.options,r=[],a=0;a<i.length;a++)n=$(i[a]),this.resetBoundingRect(n),(s.onstart||t.voidFunc).call(n,e)!==!1&&r.push(n.css("zIndex",s.zIndex+99999996).addClass("ui-draggable-dragging"));r.length&&(s.handler=$(e.target),s._cursor=s.handle.css("cursor"),s.handle.css("cursor",s.cursor||"move"),s.doc.bind("mousemove",s.draggingHandle=function(t){return o.doDragging(t,r)}).bind("mouseup",s.stopHandle=function(t){return o.stopDrag(t,r)}).bind("dblclick",s.stopHandle).bind("selectstart",s.selectHandle=function(t){null!==t&&void 0!==t&&(t.stopPropagation?(t.stopPropagation(),t.preventDefault()):(t.cancelBubble=!0,t.returnValue=!1))}),"onlosecapture"in document.documentElement?s.handler.bind("losecapture",s.stopHandle):s.win.bind("blur",s.stopHandle),"setCapture"in document.documentElement&&e.target.setCapture(),s.sClientX=e.clientX,s.sClientY=e.clientY,s.dragState=1)}return!1},e.prototype.doDragging=function(e,i){var s,n,o,r,a,l=this.options,d=e.clientX-l.sClientX,h=e.clientY-l.sClientY;for(l.handler.css("cursor",l.cursor),a=0;s=i[a];a++)r=(n=s[0]["dragSettings"+l.uuid]).grid,n.stopLeft=/^x|x$/i.test(l.axis)?Math.max(n.limit.minX,Math.min(n.limit.maxX,(r[0]?Math.round(d/r[0])*r[0]:d)+n.startLeft)):n.startLeft,n.stopTop=/^y|y$/i.test(l.axis)?Math.max(n.limit.minY,Math.min(n.limit.maxY,(r[1]?Math.round(h/r[1])*r[1]:h)+n.startTop)):n.startTop,(l.ondrag||t.voidFunc).call(s,e,d,h,n.stopLeft,n.stopTop)!==!1&&((o=n.helper).css({left:o.positionCss.left+n.stopLeft-n.startLeft,top:o.positionCss.top+n.stopTop-n.startTop,display:"block"}),l.ghost||s.css({left:n.stopLeft,top:n.stopTop}));return l.mask.css({display:"block",width:l.win.width()+l.doc.scrollLeft(),height:l.win.height()+l.doc.scrollTop()}),!1},e.prototype.stopDrag=function(e,i){var s,n,o=this.options;o.dragState=0,o.doc.unbind("mousemove",o.draggingHandle).unbind("mouseup",o.stopHandle).unbind("dblclick",o.stopHandle).unbind("selectstart",o.selectHandle||t.voidFunc),"onlosecapture"in document.documentElement?o.handler.unbind("losecapture",o.stopHandle):o.win.unbind("blur",o.stopHandle),"setCapture"in document.documentElement&&o.handler[0].releaseCapture(),o.handle.css("cursor",o._cursor),o.mask.css("display","none");for(;s=(i||[]).shift();)s.removeClass("ui-draggable-dragging"),n=s[0]["dragSettings"+o.uuid],n.helper.remove(),(o.onstop||t.voidFunc).call(s,e,n.stopLeft,n.stopTop)!==!1&&s.css({left:n.stopLeft,top:n.stopTop}),s.css("zIndex",n.zIndex),s[0]["dragSettings"+o.uuid]=null;return!1},e.prototype.resetBoundingRect=function(e){var i,s,n,o,r,a,l,d,h,u=this.options,c=$(document.body),p={left:parseInt(c.css("borderLeftWidth"),10)||0,top:parseInt(c.css("borderTopWidth"),10)||0};return t.isObject(e=$(e))&&(l=e.css("position",n="static"===(s=e.css("position"))?"relative":s).parent(),i=(o="fixed"===n)?{left:e[0].offsetLeft,top:e[0].offsetTop}:"absolute"===n?l[0]===document.body?e.offset():e.position():{left:t.utils.stripUnits(e.css("left"),l.width())||0,top:t.utils.stripUnits(e.css("top"),l.height())||0},s=o?i:e.offset(),(h=e[0]["dragSettings"+u.uuid])&&h.helper.remove(),(d=this.createHelper().css({position:o?"fixed":"absolute",height:a=e.outerHeight(!0),width:r=e.outerWidth(!0),left:(s={left:s.left+(o?0:p.left),top:s.top+(o?0:p.top)}).left,top:s.top,display:"none"})).positionCss=s,"absolute"===n&&l[0]===document.body&&(i.left+=p.left,i.top+=p.top),e[0]["dragSettings"+u.uuid]={grid:[t.utils.stripUnits(u.grid[0],l.outerWidth(!0)),t.utils.stripUnits(u.grid[1],l.outerHeight(!0))],limit:this.calculateLimit(r,a,i,e,l,n),zIndex:h?h.zIndex:e.css("zIndex"),startLeft:i.left,stopLeft:i.left,startTop:i.top,stopTop:i.top,helper:d}),this},e.prototype.calculateLimit=function(e,i,s,n,o,r){var a,l,d=this.options,h="fixed"===r,u=1/0,c=1/0,p=-(1/0),f=-(1/0),m=1/0,g=1/0,v=-(1/0),y=-(1/0);if(d.inside){if("relative"===r){var b=n.offset(),x=o.offset(),w=o.parent(),C=w.width(),_=w.height();f=-(b.left-x.left-s.left-(parseInt(o.css("borderLeftWidth"),10)||0)+(t.utils.stripUnits(o.css("paddingLeft"),C)||0)+(t.utils.stripUnits(o.css("marginLeft"),C)||0)),y=-(b.top-x.top-s.top-(parseInt(o.css("borderTopWidth"),10)||0)+(t.utils.stripUnits(o.css("paddingTop"),_)||0)+(t.utils.stripUnits(o.css("marginTop"),_)||0))}c=f+o.width()-e,g=y+o.height()-i}return d.visible&&(p=a=h?0:d.doc.scrollLeft(),v=l=h?0:d.doc.scrollTop(),m=d.win.height()-i+l,u=d.win.width()-e+a),{minX:Math.max(f,p),minY:Math.max(y,v),maxX:Math.min(c,u),maxY:Math.min(g,m)}},e.prototype.createHelper=function(){var t=this.options;return $("<div/>").css({cursor:t.cursor,zIndex:t.zIndex+99999998,backgroundColor:t.backgroundColor,opacity:t.ghost?t.opacity:.04}).addClass(t.helperCls||"ui-draggable-helper").appendTo(document.body)},e.prototype.enable=function(){var t=this.options;return t.disabled=!!t.destroyed,this},e.prototype.disable=function(){return this.options.disabled=!0,this},e.prototype.destroy=function(){var t,e,i=this.options;return 1===i.dragState&&this.stopDrag(),i.destroyed=i.disabled=!0,i.element.removeClass("ui-draggable-element"),(i.trigger||this).removeClass("ui-draggable-handle").unbind("mousedown",i.dragHandle),(t=i.mask)&&t.remove(),(e=i.helper)&&e.remove(),this},e.DEFAULTS={element:null,handle:null,ghost:!0,cursor:"move",opacity:.4,backgroundColor:"#dfefff",helperCls:"",zIndex:2e3,inside:!1,visible:!0,axis:["x","y"],grid:[0,0],oncreate:function(){},onstart:function(){},ondrag:function(){},onstop:function(){}},e}();t.Draggable=e}(utry||(utry={}));var utry;!function(t){function e(e,i,s,n){var r={width:"250px",title:i?i:"提示!",modal:!0,html:"<div>"+e+"</div>",isFullShadow:!!n,resizable:!1,maximizable:!1,buttons:[{text:"确定",className:"ut-primary",click:function(){a.close()},keydown:function(t){13!=t.keyCode&&27!=t.keyCode||a.close()}}]};t.isFunction(s)&&(r=t.utils.extend(r,{onClose:s}));var a=new o(r)}function i(t,e,i,s,n){var r=new o({width:"350px",title:i?i:"提示!",modal:!0,html:"<div>"+t+"</div>",isFullShadow:!!n,resizable:!1,maximizable:!1,buttons:[{text:"确定",className:"ut-primary",click:function(){e(),r.close()}},{text:"取消",click:function(){r.close(),s&&s()}}]});return r}function s(e,i){for(var s=[],n=2;n<arguments.length;n++)s[n-2]=arguments[n];var r=t.utils.uuid(),a="<div>"+e+"</div><br/>";a+=s[0].isTextArea?'<textarea id="'+r+'" class="ut-textarea ut-box ut-large">'+s[0].defaultV+"</textarea>":'<input id="'+r+'" type = "text" class="utry-input ut-large" value="'+s[0].defaultV+'"/>';var l=new o({minWidth:"350px",title:s[0].title?s[0].title:"提示!",modal:!0,html:a,resizable:!1,isFullShadow:!!s[0].isFullShadow,maximizable:!1,buttons:[{text:"确定",className:"ut-primary",click:function(){var t=$("#"+r).val();l.close(),i(t)}},{text:"取消",click:function(){l.close()}}]})}var n=t.Panel,o=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(s){this.options=s=t.utils.extend({type:"window",draggable:!0,resizable:!0,minimizable:!1,maximizable:!1,collapsible:!1,expand:!0,closable:!0,visible:!0,minWidth:"100px",minHeight:"150px"},s),e.prototype.init.apply(this,arguments);var n=parseInt(i.zIndex.slice(-1)[0])||this.options.zIndex;n++,n<this.options.zIndex?(this.options.zIndex++,i.zIndex.push(this.options.zIndex)):(i.zIndex.push(n),this.options.zIndex=n),s.el="body",this.resizing=!1},i.prototype.ready=function(i){e.prototype.ready.apply(this,arguments);var s=this.find(".ut-window"),n=this.find(".ut-title:first"),o=n.find(".ut-panel-title");i.draggable&&(this.dragger=this.dragger||new t.Draggable({element:s,zIndex:this.options.zIndex+3,handle:o,visible:void 0==i.visible||!!i.visible,onstart:function(){if(this.resizing)return!1},oncreate:function(){o.css("cursor","default")}})),i.resizable&&i.expand&&(this.resizer=this.resizer||new t.Resizable({minWidth:i.minWidth,minHeight:i.minHeight,element:s,zIndex:this.options.zIndex+3,handles:"all",onstart:function(){this.resizing=!0},onstop:function(t,e,i){return this.find(".ut-main").css("height",i-n.outerHeight(!0)-this.find(".ut-foot:last").outerHeight(!0)-10+"px"),this.resizing=!1,!1},oncreate:function(){s.css("overflow","hidden")}})),this.unbind("click",".ut-panel-tool"),this.bind("click",".ut-panel-tool",t.bind(function(e){t.isIE?e.cancelBubble=!0:e.stopPropagation(),$(e.target).hasClass("ut-panel-tool-collapse")?this.collapse():$(e.target).hasClass("ut-panel-tool-expand")?this.expand():$(e.target).hasClass("ut-panel-tool-close")?this.close():$(e.target).hasClass("ut-panel-tool-min")?this.minimize():$(e.target).hasClass("ut-panel-tool-max")?(this.maxnimize(),i.resizable&&this.resizer.disable(),i.draggable&&this.dragger.disable()):$(e.target).hasClass("ut-panel-tool-restore")&&(this.restore(),i.resizable&&this.resizer.enable(),i.draggable&&this.dragger.enable())},this)),this.options.maximizable&&(this.unbind("dblclick",".ut-title"),this.bind("dblclick",".ut-title",t.bind(function(t){this.find(".ut-title:first>.ut-panel-tool>span.ut-panel-tool-max").length?(this.maxnimize(),i.resizable&&this.resizer.disable(),i.draggable&&this.dragger.disable()):(this.restore(),i.resizable&&this.resizer.enable(),i.draggable&&this.dragger.enable())},this)))},i.prototype.close=function(){var t=this.options,s=this.resizer,n=this.dragger;i.zIndex.pop(),e.prototype.close.call(this),t.resizable&&t.expand&&s.destroy(),t.draggable&&n.destroy()},i.zIndex=[],i}(n);t.Window=o,t.alert=e,t.confirm=i,t.prompt=s}(utry||(utry={}));var utry;!function(t){$(document).ajaxStart(function(){try{t.isFunction(t.loading)&&!t.get("loading","GlobalLoadingSpace")&&t.loading(!0)}catch(e){}}),$(document).ajaxError(function(e,i,s,n){try{if(!t.isEmpty(i.responseText)&&s.dataTypes&&s.dataTypes.length>0&&"json"==s.dataTypes[1]){var o,r=i.responseText;t.isFunction(t.loading)&&(t.isString(r)&&t.utils.startsWith(r,"error:",!1)&&(o=r.substr(6,r.length)),o=o?o:"服务器发生错误！！","abort"!==n?t.errormsg(o):t.loading(!1))}}catch(a){}}),$(document).ajaxSuccess(function(e,i,s){if(!t.isEmpty(i.responseText)&&s.dataTypes&&s.dataTypes.length>0&&"json"==s.dataTypes[1]){var n=JSON.parse(i.responseText);if(1==n.login||""==n.login)return t.postMessage(window.top,"openRelogin"),!1;t.isEmpty(n.utrymsg)||t.hasShadowMask(function(e){e?t.errormsg(n.utrymsg,5):t.alert(n.utrymsg)})}try{t.isFunction(t.loading)&&setTimeout(t.loading(!1),500)}catch(o){}})}(utry||(utry={}));